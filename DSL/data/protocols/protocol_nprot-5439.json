{
    "identity": "nprot-5439",
    "title": "Protocol for rapid unsupervised cryo-EM structure determination using cryoSPARC software",
    "content": [
        {
            "header": "Introduction",
            "content": "CryoSPARC \\(cryo-EM Single Particle Ab-initio Reconstruction and Classification) is a software package for processing cryo-EM single particle data. CryoSPARC includes GPU accelerated implementations of 1) stochastic gradient descent \\(SGD) for ab-initio 3-D structure determination of potentially heterogeneous samples and 2) branch and bound \\(BnB) refinement for extremely rapid high-resolution refinement of 3-D maps to near-atomic resolutions. CryoSPARC also includes a powerful but simple web-browser based graphical user interface that allows non-expert users with minimal training to manage increasingly large collections of cryo-EM image datasets, run, schedule and queue computational jobs, view computational results including figures as they are computed in real time by the algorithms, and allows multiple users to simultaneously use the same computational hardware remotely. \r\n\n\n\r\n\n\nComputational tasks in cryoSPARC have associated parameters, each with default values that work well on a wide range of input datasets. Parameters can be modified, and the final values used in an experiment are recorded by the software for simple reproducibility and inspection.\r\n\n\n\r\n\n\nCryoSPARC is developed jointly by Structura Biotechnology Inc. and the University of Toronto, Canada. Both academic licenses and commercial licenses are available through Structura Inc. at www.cryosparc.com.\r\n\n\n\r\n\n\nThe following protocol describes how to use cryoSPARC to perform ab-initio heterogeneous reconstruction and high-resolution refinement in minutes or hours on a single computer with a single GPU."
        },
        {
            "header": "Equipment",
            "content": "**Computer Hardware**\r\n\n\nA desktop workstation or rackmount server with:\r\n\n\n    + Quad-core or better Intel CPU\r\n\n\n    + 32GB+ CPU RAM\r\n\n\n    + NVIDIA GPU with Compute Capability 3.5+ and 8 GB+ GPU RAM\r\n\n\n    + 256GB+ SSD drive\r\n\n\n    + Linux OS \\(we recommend Ubuntu 16.04)\r\n\n\n    + NVIDIA Drivers and CUDA 6.5+\r\n\n\n\r\n\n\n**Data**\r\n\n\n    + One or more raw cryo-EM particle stacks in .mrc or .mrcs format\r\n\n\n    + One or more meta-data files in .star, .par, .txt or .emx formats, including CTF values for each particle \\(defocus, astigmatism, phase shift)\r\n\n\n    + Imaging parameters for the dataset, including accelerating voltage, amplitude contrast, spherical aberration, pixel size\r\n\n\n\r\n\n\n**Software**\r\n\n\nCryoSPARC version 0.2.36 or newer\r\n\n\n\\(Note that installing cryoSPARC will also automatically install all dependencies)"
        },
        {
            "header": "Procedure",
            "content": "Step 1) \r\n\n\nStart cryoSPARC on the GPU computer. \r\n\n\nAfter installation and configuration, the cryosparc command should be available in your PATH. Simply type the following at the command line \\(Figure 1):\r\n\n\n$ cryosparc start\r\n\n\nThis will begin the cryosparc host processes and provide you with a web address where cryoSPARC can be used. Typically it will be http://localhost:38000\r\n\n\n\r\n\n\nStep 2) \r\n\n\nOn the GPU computer or any other computer connected to the same local network as the GPU computer, use the Google Chrome browser to navigate to the web address from step 1).\r\n\n\nYou will be presented with the cryoSPARC main dashboard \\(Figure 2).\r\n\n\n\r\n\n\nStep 3) \r\n\n\nClick on the \u2018Datasets\u2019 button in the top navigation bar to arrive at the datasets page \\(Figure 3). From here, click on \u2018New Dataset\u2019 to create a new particle dataset in cryoSPARC \\(Figure 4). Click on the Configure tab on the left, and click the \u2018Add New File Set\u2019 button to begin adding a new set of particle stack and meta data files to cryoSPARC.\r\n\n\n\r\n\n\nStep 4)\r\n\n\nClick on the \u2018Browse Bulk Files\u2019 button to browse for a meta data \\(.star, .par, .txt, .emx) file for your dataset. Repeat for the particle stack if necessary \\(.star files contain paths to corresponding .mrcs files). Enter microscope parameters if necessary \\(.star files contain microscope parameters). \r\n\n\nClick on the Visualize tab on the left, and click Launch to have cryoSPARC load your data and display it to verify the integrity of the provided files and the correctness of microscope parameters \\(Figure 5).\r\n\n\n\r\n\n\nStep 5) \r\n\n\nClick on the Experiment button in the main navigation bar. This will take you to the experiment management page \\(Figure 6). Click \u2018New Experiment\u2019 to start a new experiment. In the New experiment page, select your dataset, then select the task you wish to perform \\(in this case Ab-Initio Heterogeneous Reconstruction). Then click on the parameters page to see default parameters of the experiment \\(Figure 7). In this case, you can set the number of classes you wish to reconstruct but for this tutorial we will leave it as 1 class.\r\n\n\n\r\n\n\nStep 6) \r\n\n\nClick the Launch tab on the left and select \u2018Enqueue\u2019. This will queue your experiment for running in the cryoSPARC scheduler. When the job begins to run, you will see results streaming in real time on the Launch page. This includes plots and result files that are generated \\(Figure 8). You can directly download result maps and plot data from the interface. In this case, the single class ab-initio reconstruction will yield a medium-resolution structure of the TRPA1 ion channel in approximately one hour. When the job is finished, you may view the final result.\r\n\n\n\r\n\n\nStep 7) \r\n\n\nTo refine a structure that has been reconstructed by ab-initio reconstruction, return to the experiments page, click \u2018New Experiment\u2019 and select your dataset. This time, select Heterogeneous Refinement as the task. In the job parameters, use the \u2018Browse previous results\u2019 button to select the output from the previous ab-initio experiment as the starting reference for high-speed refinement \\(Figure 9). In refinement experiments, every parameter has default values and none need to be changed, except if you wish to enforce symmetry during refinement. In this case we can enforce C4 symmetry.\r\n\n\n\r\n\n\nStep 8) \r\n\n\nOnce again, click on the Launch tab on the left for the refinement experiment, then click Enqueue. The job will begin to run and report results in real time. This refinement will take approximately one hour to reach 4.2A resolution \\(Figure 10). Results maps both sharpened and unsharpened, along with half-maps, masks, and FSC curves can be downloaded directly from the interface. The resulting structure can be viewed locally using UCSF Chimera \\(Figure 11)."
        }
    ],
    "attributes": {
        "acceptedTermsAndConditions": true,
        "allowDirectSubmit": true,
        "archivedVersions": [],
        "articleType": "Method Article",
        "associatedPublications": [
            {
                "doi": "10.1038/nmeth.4169",
                "date": "2017-02-08 16:25:33",
                "title": "cryoSPARC: algorithms for rapid unsupervised cryo-EM structure determination",
                "authors": [
                    "Ali Punjani",
                    "John L Rubinstein",
                    "David J Fleet",
                    "and Marcus A Brubaker"
                ],
                "journal": "Nature Methods",
                "logo": ""
            }
        ],
        "authors": [
            {
                "id": 14279,
                "identity": "a0dae838-516f-11e9-9e20-12b504df345a",
                "order_by": 0,
                "name": "Ali Punjani",
                "email": "alipunjani@cs.toronto.edu",
                "orcid": "",
                "institution": "Department of Computer Science, University of Toronto, Canada",
                "correspondingAuthor": true,
                "prefix": "",
                "firstName": "Ali",
                "middleName": "",
                "lastName": "Punjani",
                "suffix": ""
            },
            {
                "id": 14282,
                "identity": "a0daf120-516f-11e9-9e20-12b504df345a",
                "order_by": 0,
                "name": "Marcus Brubaker",
                "email": "mab@eecs.yorku.ca",
                "orcid": "",
                "institution": "Department of Electrical Engineering and Computer Science, York University, Toronto, Ontario, Canada",
                "correspondingAuthor": true,
                "prefix": "",
                "firstName": "Marcus",
                "middleName": "",
                "lastName": "Brubaker",
                "suffix": ""
            },
            {
                "id": 14280,
                "identity": "a0daec30-516f-11e9-9e20-12b504df345a",
                "order_by": 1,
                "name": "John Rubinstein",
                "email": "",
                "orcid": "",
                "institution": "Molecular Structure and Function Program, The Hospital for Sick Children Research Institute, Toronto, Canada; and Departments of Biochemistry and Medical Biophysics, The University of Toronto, Canada",
                "correspondingAuthor": false,
                "prefix": "",
                "firstName": "John",
                "middleName": "",
                "lastName": "Rubinstein",
                "suffix": ""
            },
            {
                "id": 14281,
                "identity": "a0daeedf-516f-11e9-9e20-12b504df345a",
                "order_by": 1,
                "name": "David Fleet",
                "email": "",
                "orcid": "",
                "institution": "Department of Computer Science, University of Toronto, Canada",
                "correspondingAuthor": false,
                "prefix": "",
                "firstName": "David",
                "middleName": "",
                "lastName": "Fleet",
                "suffix": ""
            }
        ],
        "badges": [],
        "createdAt": "2016-12-21 00:51:39",
        "currentVersionCode": 1,
        "declarations": "",
        "doi": "10.1038/protex.2017.009",
        "doiUrl": "https://doi.org/10.1038/protex.2017.009",
        "draftVersion": [],
        "editorialEvents": [],
        "editorialNote": "",
        "failedWorkflow": [],
        "files": [
            {
                "id": 2609591,
                "identity": "51f5d729-edb6-42c2-8fc8-3d07602dc351",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:51:02",
                "extension": "png",
                "order_by": 1,
                "title": "Figure 1",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 174594,
                "visible": true,
                "origin": "",
                "legend": "CryoSPARC start command",
                "description": "",
                "filename": "figure1.png",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/figure_1.png"
            },
            {
                "id": 2609592,
                "identity": "8cd49cfc-c90e-4abc-b876-a0b8720e828d",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:51:02",
                "extension": "png",
                "order_by": 2,
                "title": "Figure 2",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 478820,
                "visible": true,
                "origin": "",
                "legend": "CryoSPARC main dashboard   The dashboard indicates version number, changelog, update availability, current job processing status, utilization, and help and support links",
                "description": "",
                "filename": "figure2.png",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/figure_2.png"
            },
            {
                "id": 2609594,
                "identity": "88ba014b-794b-4bc2-a53e-1ec852152c17",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:51:02",
                "extension": "png",
                "order_by": 3,
                "title": "Figure 3",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 1302823,
                "visible": true,
                "origin": "",
                "legend": "Dataset management page   All datasets are shown along with a random selection of particle images from each. Click on a dataset to view its details.\r\n",
                "description": "",
                "filename": "figure3.png",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/figure_3.png"
            },
            {
                "id": 2609599,
                "identity": "13dba5bd-0a57-4ddd-99da-592f6caa4a3a",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:51:02",
                "extension": "png",
                "order_by": 4,
                "title": "Figure 4",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 346469,
                "visible": true,
                "origin": "",
                "legend": "New dataset page   File sets including particle stack and meta data file can be indicated, along with imaging microscope parameters.",
                "description": "",
                "filename": "figure4.png",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/figure_4.png"
            },
            {
                "id": 2609595,
                "identity": "a35b85ca-01af-425c-b7ea-0d973d11352c",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:51:02",
                "extension": "png",
                "order_by": 5,
                "title": "Figure 5",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 1120732,
                "visible": true,
                "origin": "",
                "legend": "Dataset visualization   Read the microscope parameters in the output to check that they are correct, and inspect the visualized particle images.",
                "description": "",
                "filename": "figure5.png",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/figure_5.png"
            },
            {
                "id": 2609596,
                "identity": "9b0219bb-f722-47a7-a005-235c2a114818",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:51:02",
                "extension": "png",
                "order_by": 6,
                "title": "Figure 6",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 341570,
                "visible": true,
                "origin": "",
                "legend": "Experiment management page   View, list, filter, sort experiments that you have created, and view their status. ",
                "description": "",
                "filename": "figure6.png",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/figure_6.png"
            },
            {
                "id": 2609597,
                "identity": "689125fa-75e2-4aaf-8636-488ac1ea726f",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:51:02",
                "extension": "png",
                "order_by": 7,
                "title": "Figure 7",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 441932,
                "visible": true,
                "origin": "",
                "legend": "Parameters set-up page for a new experiment   Each parameter has a default value and no modifications need to be made to achieve the reported results. Modified parameters are indicated in green, and parameters are grouped by section into basic and advanced parameters.\r\n",
                "description": "",
                "filename": "figure7.png",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/figure_7.png"
            },
            {
                "id": 2609598,
                "identity": "93d16692-9c99-41e9-809a-ed496d9d15e6",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:51:02",
                "extension": "png",
                "order_by": 8,
                "title": "Figure 8",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 902324,
                "visible": true,
                "origin": "",
                "legend": "Real time streaming results from cryoSPARC   Real time streaming results from cryoSPARC processing an ab-initio structure reconstruction job. Plots, text, and result files are all visible in the interface. ",
                "description": "",
                "filename": "figure8.png",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/figure_8.png"
            },
            {
                "id": 2609600,
                "identity": "79105ede-bebd-4e68-a747-e51dca03b72d",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:51:02",
                "extension": "png",
                "order_by": 9,
                "title": "Figure 9",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 525582,
                "visible": true,
                "origin": "",
                "legend": "Previous result browser   Browse previous results to select the starting map for a high-resolution refinement experiment.",
                "description": "",
                "filename": "figure9.png",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/figure_9.png"
            },
            {
                "id": 2609601,
                "identity": "8ab6c3f5-dbaa-4969-9a5d-3974d8b093ab",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:51:02",
                "extension": "png",
                "order_by": 10,
                "title": "Figure 10",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 2232945,
                "visible": true,
                "origin": "",
                "legend": "Refinement results   Results during a refinement experiment. Structures and FSC plots are generated in real time while computation progresses.",
                "description": "",
                "filename": "figure10.png",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/figure_10.png"
            },
            {
                "id": 2609602,
                "identity": "2c97ac50-2a15-418b-b289-e09e59b74484",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:51:02",
                "extension": "png",
                "order_by": 11,
                "title": "Figure 11",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 2508661,
                "visible": true,
                "origin": "",
                "legend": "CryoSPARC result visualized in UCSF Chimera.",
                "description": "",
                "filename": "figure11.png",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/figure_11.png"
            },
            {
                "id": 13465121,
                "identity": "5bfbd03f-4fd0-42e1-b3c7-2cf3c08ce841",
                "added_by": "auto",
                "created_at": "2021-09-16 20:45:45",
                "extension": "pdf",
                "order_by": 0,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "manuscript-pdf",
                "size": 3701688,
                "visible": true,
                "origin": "",
                "legend": "",
                "description": "",
                "filename": "manuscript.pdf",
                "url": "https://assets.researchsquare.com/files/nprot-5439/v1/c30aa74a-ba47-4d7d-93e0-624225fd1860.pdf"
            }
        ],
        "financialInterests": "All authors are engaged in a venture to commercially support cryoSPARC for industrial use.",
        "fulltextSource": "",
        "fullText": "",
        "funders": [],
        "hasOptedInToPreprint": true,
        "hasPassedJournalQc": "",
        "hideJournal": true,
        "highlight": "",
        "institution": "",
        "isAuthorSuppliedPdf": false,
        "isDeskRejected": "",
        "isHiddenFromSearch": false,
        "isInQc": false,
        "isInWorkflow": false,
        "journal": {
            "display": true,
            "email": "protocol.exchange@nature.com",
            "identity": "protocol-exchange",
            "isNatureJournal": false,
            "hasQc": false,
            "allowDirectSubmit": true,
            "externalIdentity": "",
            "sideBox": "",
            "submissionUrl": "https://protocolexchange.researchsquare.com/submission",
            "title": "Protocol Exchange",
            "twitterHandle": ""
        },
        "keywords": "electron cryomicroscopy, cryo-EM, 3-D reconstruction, protein structure",
        "license": {
            "name": "CC BY-NC 3.0",
            "url": "https://creativecommons.org/licenses/by-nc/3.0/"
        },
        "manuscriptAbstract": "Single particle electron cryomicroscopy \\(cryo-EM) is a powerful method for determining the structures of biological macromolecules. With automated microscopes, cryo-EM data can often be obtained in a few days. However, processing cryo-EM image data to reveal heterogeneity in the protein structure and to refine 3-D maps to high resolution frequently becomes a severe bottleneck, requiring expert intervention, prior structural knowledge, and weeks of calculations on expensive computer clusters. This protocol describes the steps required to use the cryoSPARC \\(cryo-EM single particle _ab initio_ reconstruction and classification) software package to reconstruct and refine high resolution cryo-EM maps without prior structural knowledge in hours or minutes on an inexpensive desktop computer.",
        "manuscriptTitle": "Protocol for rapid unsupervised cryo-EM structure determination using cryoSPARC software",
        "msid": "",
        "msnumber": "",
        "nonDraftVersions": [
            {
                "code": 1,
                "date": "2017-02-08 16:26:22",
                "doi": "10.1038/protex.2017.009",
                "editorialEvents": [
                    {
                        "type": "communityComments",
                        "content": 1
                    }
                ],
                "status": "published",
                "journal": {
                    "display": true,
                    "email": "info@researchsquare.com",
                    "identity": "researchsquare",
                    "isNatureJournal": false,
                    "hasQc": true,
                    "allowDirectSubmit": true,
                    "externalIdentity": "",
                    "sideBox": "",
                    "submissionUrl": "/submission",
                    "title": "Research Square",
                    "twitterHandle": "researchsquare"
                }
            }
        ],
        "origin": "",
        "ownerIdentity": "a0da8871-516f-11e9-9e20-12b504df345a",
        "owner": [],
        "postedDate": "February 8th, 2017",
        "published": true,
        "revision": "",
        "status": "posted",
        "subjectAreas": [
            {
                "id": 3756,
                "name": "Computational biology and bioinformatics"
            },
            {
                "id": 3757,
                "name": "Structural biology"
            }
        ],
        "tags": [],
        "versionOfRecord": [],
        "versionCreatedAt": "2017-02-08 16:26:22",
        "video": "",
        "vorDoi": "",
        "vorDoiUrl": "",
        "workflowStages": []
    }
}