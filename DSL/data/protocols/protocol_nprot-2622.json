{
    "identity": "nprot-2622",
    "title": "Easy-DHPSF open-source software for three-dimensional localization of single molecules with precision beyond the optical diffraction limit",
    "content": [
        {
            "header": "Introduction",
            "content": "Single-molecule \\(SM)-based super-resolution microscopy can resolve neighboring objects separated closer than the diffraction limit of _\u03bb_/\\(2 _NA_) \u2248 250&nbsp;nm<sup>1, 2</sup>, where _\u03bb_ is the wavelength of light and _NA_ is the numerical aperture of the microscope\u2019s objective lens. This is achieved through the fusion of several key ideas<sup>3</sup>: 1) dense labeling of the structures of interest with SMs, 2) active control of the emission states of these SMs such that only a sparse, non-overlapping subset is emitting at any given point in time, and 3) precise measurement of the position of each emitting SM. Dense labeling is required because these techniques sample the underlying structure and reconstruct it in a pointillist manner; in order to avoid aliasing, the labeling density must satisfy the Nyquist-Shannon criterion<sup>4, 5</sup>. Active control of SM emission states can be accomplished via a variety of mechanisms, as exemplified by the terms \\(fluorescence) Photoactivation Localization Microscopy \\[\\(f)PALM]<sup>6, 7</sup>, STochastic Optical Reconstruction Microscopy \\(STORM)<sup>8</sup>, fluorescent protein photocontrol/blinking<sup>9</sup> and Points Accumulation for Imaging in Nanoscale Topography \\(PAINT)<sup>10</sup>, but we commonly refer to the family of SM super-resolution methods by the mechanism-independent moniker Single-Molecule Active Control Microscopy \\(SMACM)<sup>2, 11</sup>.\r\n\n\n\r\n\n\nHere, we focus on the third aforementioned key idea, namely the precise measurement of SM positions via widefield imaging using the double-helix \\(DH) microscope<sup>12</sup>. The DH point spread function \\(DH-PSF) is an engineered rotating response added to a conventional widefield epifluorescence microscope that enables precise measurement of the three-dimensional \\(3D) position and orientation of SMs<sup>13, 14</sup>. Three-dimensional position determination works as follows. A SM near focus in a DH microscope appears as two spots on a detector. The positions of these two spots can be measured via fitting of the image to the sum of two Gaussian functions in a least-squares manner<sup>15</sup>, hereafter referred to as a double-Gaussian fit. The midpoint between these two spots yields the lateral \\(_x_, _y_) position of the SM, while the angle of the line connecting the two spots \\(relative to a fixed direction, such as the horizontal _x_ axis) yields the axial \\(_z_) position of the SM from a separate calibration measurement. Thus, the 3D position of multiple, non-overlapping SMs can be measured with a single snapshot; no mechanical or optical scanning is required. If a molecule moves in the axial direction, the midpoint of the two spots remains constant while the two spots revolve around one another, hence tracing out a double-helix in 3D space. Axial position estimation is usually calibrated by scanning a bright fluorescent particle, such as a fluorescent bead, in known axial steps and measuring the rotation of the DH-PSF \\(see \"Figure 3\":#f2).\r\n\n\n\r\n\n\nThe computational challenge in 3D SMACM with the DH microscope is to recognize the spot pairs that correspond to images of SMs accurately and precisely measure their locations to extract 3D position. Template matching is a process in which we try to find small, known patches _t_\\(_x_, _y_) in an image _s_\\(_x_, _y_) by selecting locations \\(_p_, _q_) that minimize the mean squared error quantity\r\n\n\n\\(1) <a href=\"#figures\" data-url=\"http://www.nature.com/protocolexchange/system/uploads/2494/original/Eqn001.gif?1361255509\">See figure in Figures section.</a>. \r\n\n\nTemplate matching may be recast as a very closely related problem, the maximization of the area correlation,\r\n\n\n\\(2) <a href=\"#figures\" data-url=\"http://www.nature.com/protocolexchange/system/uploads/2495/original/Eqn002.gif?1361255728\">See figure in Figures section.</a>, \r\n\n\nwhere * denotes the convolution operation. Using the Fourier transform, maxima of this convolution can be found extremely efficiently. Because of the predictability and repeatability of our signal \\(DH images of SMs), template matching is an excellent choice for the detection of the DH-PSF. Typical SM imaging datasets may be hampered by low signal, high background, optical aberrations, sample drift, or any combination of experimental non-idealities. We have found the strategy of template matching for SM identification and position measurement via least-squares fitting to a double-Gaussian function to be robust to these effects while still being computationally expedient and precise.\r\n\n\n\r\n\n\nOur DH template-matching algorithm uses several templates representing various rotated forms of the DH-PSF reflecting molecules at different _z_ positions. Since the DH-PSF is a complex shape that changes with wavelength and aberration, templates are taken from calibration movies measured at the same experimental conditions as the fluorescence data to be analyzed. Six templates are usually chosen such that the DH-PSF rotates ~30 degrees between each template \\(see \"Figure 5\":#f4). This represents a good balance between template accuracy and computational speed, since the computational time of template matching scales linearly with the number of templates used.\r\n\n\n\r\n\n\nTo identify SMs in a DH microscope image, 1) each template is phase correlated with the image, 2) the correlations are combined, and 3) peaks in the combined correlated image are validated to filter out extraneous matches. Phase correlation is carried out in the Fourier domain since this is usually faster than convolution in real space for large images<sup>16</sup>. Furthermore, phase correlation normalizes the input image and template image amplitudes in the Fourier domain, thereby minimizing the bias of template matching to bright regions of the image. The phase correlation image _r_<sub>k</sub> is computed from the input image _s_ and the _k_<sup>th</sup> template _t_<sub>k</sub> with the formula\r\n\n\n\\(3) <a href=\"#figures\" data-url=\"http://www.nature.com/protocolexchange/system/uploads/2497/original/Eqn003.gif?1361255987\">See figure in Figures section.</a>, \r\n\n\nwhere FT\\{} denotes the two-dimensional Fourier transform, FT<sup>-1</sup>\\{} denotes the two-dimensional inverse Fourier transform, and the prefilter _h_ is a Gaussian lowpass filter with a width _\u03c3_ \u2248 1.5&nbsp;pixels. Phase correlation emphasizes high frequency components in both the input image and the template<sup>16</sup>, and these spatial frequencies typically have a lower signal to noise ratio than lower frequencies in the image. The Gaussian lowpass filter _h_ emphasizes lower spatial frequencies present in both the input image and the template and thus leads to more reliable estimates.\r\n\n\n\r\n\n\nLocal maxima \\(i.e. peaks) above a user-defined threshold \\(calibrated in \"Procedure\":#procedure, step 2) are detected in each image _r_<sub>k</sub>, and the locations and magnitudes of each peak are stored in memory. The width of the Gaussian prefilter and the threshold values are usually chosen empirically to minimize false positive matches \\(matches to images that are not the DH-PSF) and false negative matches \\(failure to match to an image of the DH-PSF) simultaneously. In general, the optimal value of these parameters can be derived if the additive noise in the original image is modeled with a simple noise distribution. However, typical live-cell SM data is complex, and modeling the noise distribution in the test data is beyond the scope of this work.\r\n\n\n\r\n\n\nSince the peak threshold is usually set low enough to detect weak single molecules, extraneous matches occur for stronger fluorescent signals. If the candidate DH-PSF is bright enough, the template will match even if only one of the spots in the template overlaps with only one of the spots in the input. These \u201cghost\u201d matches are filtered out by enforcing a minimum distance between all of the template matches in a given frame of the input data. This minimum distance is chosen to be the typical diameter of the DH-PSF image \\(~1.2&nbsp;\u03bcm). If multiple template matches occur too close to one another, the strongest match is chosen, and the others are discarded. The template matches that satisfy this filter are validated template matches. These validated matches are then fit to the aforementioned double-Gaussian model of the DH-PSF \\(see \"Procedure\":#procedure, step 4).\r\n\n\n\r\n\n\nThe MATLAB optimization function lsqnonlin is used to fit each candidate SM image identified by the template-matching algorithm by minimizing the mean-square error between an eight-parameter double-Gaussian model of the DH-PSF _U_\\(_x_, _y_) and the raw SM image. This model is given by\r\n\n\n\\(4) <a href=\"#figures\" data-url=\"http://www.nature.com/protocolexchange/system/uploads/2496/original/Eqn004.gif?1361255828\">See figure in Figures section.</a>, \r\n\n\nwhere the four parameters used for each circularly-symmetric Gaussian function are amplitude \\(_A_<sub>1</sub> and _A_<sub>2</sub>), _x_-center location \\(_\u03bc_<sub>x1</sub> and _\u03bc_<sub>x2</sub>), _y_-center location \\(_\u03bc_<sub>y1</sub> and _\u03bc_<sub>y2</sub>), and width \\(_\u03c3_<sub>1</sub> and _\u03c3_<sub>2</sub>). While this double-Gaussian model is only an approximation of the true shape of the DH-PSF<sup>15</sup>, it represents a good compromise between fitting accuracy and computational complexity. These fits are then filtered to ensure that they match the data sufficiently accurately and produce reasonable reconstructions of the DH-PSF. This filtering step rejects a variety of unphysical situations as described below in \"Troubleshooting\":#troubleshooting \\(step 4). The precision of these localizations can be estimated from measuring the number of photons contained within each image of the DH-PSF<sup>13</sup>.\r\n\n\n\r\n\n\nSample drift can be corrected via imaging bright fluorescent beads that serve as fiduciary markers. These markers are tracked separately from the SMs throughout a fluorescence movie \\(see \"Procedure\":#procedure, step 3) to measure the drift. Their movements can then be subtracted from the three-dimensional localizations of SMs in order to remove thermal and mechanical motion artifacts from the super-resolution images.\r\n\n\n\r\n\n\nBelow, we demonstrate the \"open-source Easy-DHPSF software\":https://code.google.com/p/easy-dhpsf/ by analyzing a \"SM dataset of Alexa647-immunolabeled microtubules in BSC-1 cells\":https://code.google.com/p/easy-dhpsf/#Sample_single-molecule_DH-PSF_data <sup>17</sup>. We have included an easy-to-use \"graphical user interface \\(GUI)\":#f0 to streamline the processing steps and minimize user error. This code has been \"validated in several different imaging conditions\":#related-articles <sup>17-19</sup> and is provided free-of-charge under the New BSD License at \"https://code.google.com/p/easy-dhpsf/\":https://code.google.com/p/easy-dhpsf/. However, this code is \"provided 'as is' without guarantees of any kind\":http://opensource.org/licenses/BSD-3-Clause."
        },
        {
            "header": "Equipment",
            "content": "**Software**\r\n\n\nThe \"Easy-DHPSF package\":https://code.google.com/p/easy-dhpsf/ consists of \"MATLAB\":http://www.mathworks.com functions and subroutines and requires the image processing, optimization, statistics, and wavelet toolboxes. Easy-DHPSF has been tested on workstations running MATLAB 2011b and 2012b. There are no known issues with earlier versions of MATLAB, but some built-in functions \\(e.g. fft2, imread) may have reduced performance in earlier versions of MATLAB.\r\n\n\n \r\n\n\n**Imaging**\r\n\n\nTo create the double-helical PSF, it is necessary to use a spatial light modulator<sup>12, 13</sup> or a custom transmissive phase mask<sup>19, 20</sup>. The Easy-DHPSF code anticipates that raw SM images are detected with an electron-multiplying \\(EM) CCD. If no EM gain is used, the \u2018EM Gain\u2019 fields in the program may simply be set to 1. It is necessary to measure the conversion gain \\(camera analog-to-digital converter counts per incident photon) of the EMCCD<sup>21</sup> and size of the camera pixels in object space before running this software. The combination of the EM gain and the conversion gain is used to compute the total number of detected photons.\r\n\n\n\r\n\n\nImages should be acquired as .tif stacks readable by MATLAB\u2019s imread function. Fluorescent beads or other bright, stationary, long-lasting emitters must be available in order to calibrate the _z_ response of the DH-PSF; these may also be used to correct for drift if desired. A SM imaging dataset may be split over multiple sequential .tif files. \r\n\n\n\r\n\n\n**Data file considerations**\r\n\n\nEasy-DHPSF requires several .tif stacks \\(readable by MATLAB\u2019s imread function) to run. \r\n\n\n\r\n\n\nThe first is the raw data file\\(s) with SMs to be localized. If desired, the field of view may contain one or more fiducials to correct for stage drift, ideally located near the edge of the field of view in order to not overlap with the region containing single molecules to be localized.\r\n\n\n\r\n\n\nThe second image stack is a calibration scan. This should comprise a series of frames of a fiducial at different known _z_ positions generated using an axial nanopositioner in the microscope. The sequence of steps used to generate the scan is fed to the program in the form of a \u2018sequence log file\u2019, which should be an ASCII text file with a .dat extension and can be generated using the included \u2018writeCalDatFile.m\u2019 script. As shown in the example data, this scan should consist of approximately 50 steps sampling the entire _z_ range of the DH-PSF, with ~10 acquisitions at each step to improve the precision of the measurement and provide localization precision information at each position.\r\n\n\n\r\n\n\nThe last image stacks are \u2018dark offsets\u2019 for the calibration and the data files. The frames in the dark offset .tif stacks are averaged and subtracted before data processing to account for the offset and dark counts from the EMCCD. Acquire a series of a few dozen frames with the camera shutters closed, and use the same acquisition parameters \\(e.g. integration time, EM gain, shift speed) as those used for the calibration and data acquisition. If these parameters are the same between the calibration and raw data images, only one dark offset file is necessary.\r\n\n\n\r\n\n\nEasy-DHPSF works by processing these images with a series of modules that are run independently. Each of these saves its output to a separate directory, along with additional diagnostic figures. These modules and outputs are managed with a central GUI, which stores project data \\(e.g. detector information, file locations) as a MATLAB structure. Projects can be saved and loaded between sessions. Each module creates subfolders within the same folder as each raw .tif file that is processed, labeled with the name of the .tif file and the current time. For example, if it is noon on March 1, 2013, your calibration image is named \u2018Calibration 1.tif\u2019, and it is contained in C:\\YourDataFolder, then the figures and data from the calibration will be saved in \u2018C:\\YourDataFolder\\Calibration 1\\calibration 20130301 1200.\u2019 Ensure that you have read and write access to these folders."
        },
        {
            "header": "Procedure",
            "content": "**Step 0. Image acquisition and program setup**\r\n\n\nAcquire the raw data, calibration, and dark offset images described in \"Equipment\":#equipment, and generate a .dat sequence log file.\r\n\n\n\r\n\n\nAdd the folder containing all Easy-DHPSF .m files to the MATLAB path using File>Set Path, and set the current folder to the folder containing your data. To initialize the GUI, run easy_dhpsf.m. This window \\(see \"Figure 1\":#f0) controls all the modules needed to process the data.\r\n\n\n\r\n\n\nBefore running any of the modules, set the conversion gain and pixel size of the detector \\(in object/sample space) using the fields at the top of the main window. These parameters should be the same for all .tif files within a project. Setting the pixel size incorrectly may cause artifacts in the recognition and localization algorithms. Changing these parameters after processing the data does not retroactively change the calculated results; use caution\\!\n**Figure 1. The Easy-DHPSF command window: \\(left) before running any modules and \\(right) after localizing single molecules.**\r\n\n\n\r\n\n\n**Step 1. DH-PSF Calibration**\r\n\n\nThe first module calibrates the relationship between the angle of the two lobes of the double helix and the axial position of single fiducial emitters, usually fluorescent beads. It also generates template images of the DH-PSF which are used for template matching later in the program.\r\n\n\n1.1: Click the \u2018run\u2019 button in the \u2018Calibrate DHPSF\u2019 panel.\r\n\n\n1.2: Set the EM gain used during the acquisition of the calibration images, and open the calibration images file, the dark offset image file matching the calibration, and the sequence log file for the calibration. The program will prompt for these data via dialog boxes.\r\n\n\n1.3: Select a region of interest \\(ROI) containing at least one bright fluorescent object by adjusting the box and double-clicking inside it \\(see \"Figure 2\":#f1). Even though the calibration bead may be isolated \\(bright object toward lower-left of excitation spot in \"Figure 2\":#f1), it is helpful to select an entire widefield excitation region so that the background fluorescence can be estimated accurately.\r\n\n\n1.4: Select fluorescent objects by clicking in the center of each DH-PSF. Each frame of raw data, as well as the accompanying double Gaussian fit, is displayed as it is processed \\(see \"Figure 3\":#f2). Note that by mistake you might select a bright single molecule instead of a bead, but you will be able to detect and ignore this in subsequent steps.\r\n\n\n1.5: After processing, an output of calibration information will be generated \\(see \"Figure 4\":#f3). Inspect this for each bead to ensure that the angle vs. _z_ position curve is roughly linear, and that the variation of angle measurements in each step is not unreasonably high \\(error bars in upper-left plot). Additional information from the calibration, such as the observed shift in _x_ and _y_ position with axial position, may be useful when aligning phase masks.\r\n\n\n1.6: Select the most reliable calibration bead in the Easy-DHPSF main window using the drop-down menu. The calibration information and templates generated from this bead will be used in all later processing steps.\n**Figure 2. Choose region of interest for calibrating the DH-PSF.**\n**Figure 3. A single raw movie frame being analyzed by the DH-PSF calibration module.** Left: raw data after dark offset subtraction. Right: the reconstructed image of two beads in the raw data that were selected for fitting.\n**Figure 4. DH-PSF calibration statistics.** For a good calibration standard, the calibration curve \\(upper-left) should be roughly linear, the _xy_ position \\(upper-right) should deviate less than \u00b150\u00a0nm, and the localization precision \\(lower-left, lower-middle) in _x_, _y_, and _z_ should be \u226415\u00a0nm over the course of the scan.\r\n\n\n\r\n\n\n**Step 2. Single-Molecule Detection Calibration**\r\n\n\nIn this module, the templates generated from the calibration subroutine are used to generate a large array of matches to the raw image data. This step serves to assess what value of phase correlation is typical for a good match to a single molecule. After this step, the user will define a threshold for each template such that only DH-PSF images of reasonable quality will be analyzed with the double-Gaussian fitting algorithm.\r\n\n\n2.1: Click the \u2018run\u2019 button in the \u2018Calibrate SM identification\u2019 panel.\r\n\n\n2.2: Set the EM gain and select the templates to be used. By default, templates are chosen by the program such that the angle of the line connecting the two lobes is given by \\{-60\u00b0, -30\u00b0, 0\u00b0, 30\u00b0, 60\u00b0, 90\u00b0}, and this selection should generally be appropriate \\(see \"Figure 5\":#f4).\r\n\n\n2.3: Select a region containing the single molecules of interest. This exact ROI will be used for the single-molecule fitting module and ideally should not contain fluorescent objects that are much \\(\u226510\u00d7) brighter than the SMs you wish to analyze. Template matches are indicated as circles drawn over the raw data, and stronger matches are drawn as larger circles \\(see \"Figure 6\":#f5).\r\n\n\n2.4: After the template-matching module is complete, open the \u2019threshold \\[DateAndTime]\u2019 folder. This contains a selection of .png files that represent potential template matches. The filenames describe which template matched the data and the value of the phase correlation for the match \\(e.g. \u2018template 3 threshold 272.png\u2019).\r\n\n\n2.5: Select appropriate thresholds for each template, and enter these into the \u2018threshold\u2019 field in the GUI \\(see \"Figure 1\":#f0). These thresholds should be chosen such that the two lobes of the DH-PSF are faintly visible and that there is a low rate of false matches for higher correlation values, as in \"Figure 7\":#f6. You should not be concerned if there are a few incorrect matches, say to one lobe of the DH-PSF from a very bright molecule, because these will be rejected by the subsequent double-Gaussian fit module.\n**Figure 5. Typical DH-PSF templates.** Each template is chosen from the aforementioned calibration scan, where the rotation of the double helix between templates is evenly spaced at ~30\u00b0.\n**Figure 6. A single raw movie frame being analyzed by the SM-detection calibration module.** Left: phase correlation of the raw image with the DH templates. Right: raw data with template matches indicated by colored circles. Larger circles indicate stronger matches, and will be saved with a higher threshold value.\n**Figure 7. Potential DH-PSF SMs identified by template matching.** The image with an appropriate threshold is highlighted. Note that while thresholds 88, 92, 94, 102, 106, and 107 represent poor matches to the DH-PSF, the other matches for correlation values \u226584 are satisfactory.\r\n\n\n\r\n\n\n**Step 3. Fiducial Tracking \\(Optional)**\r\n\n\nThis module tracks the movement of one or more fluorescent beads or other stationary markers. Stage drift during a SM experiment can be thus be removed by subtracting the movement of the fiduciary marker from the SM localizations.\r\n\n\n3.1: Click the \u2018run\u2019 button in the \u2018Track fiduciaries\u2019 panel.\r\n\n\n3.2: Select a region of interest containing at least one bright fiducial by adjusting the box and double-clicking inside it. \r\n\n\n3.3: Select one or more fiducials by clicking in the center of each DH-PSF.\r\n\n\n3.4: After fitting the fiducials, select whether or not to apply the averaged correction to the output data by clicking the \u2018use fiducials\u2019 checkbox. This may be changed at any time before outputting the data.\r\n\n\n\r\n\n\n**Step 4. Single-Molecule Localization**\r\n\n\nUsing the results of the previous processing steps, this module identifies single molecules that score above the template matching threshold identified in step 2.5, then fits them using nonlinear least squares minimization to a double-Gaussian function.\r\n\n\n4.1: Click the \u2018run\u2019 button in the \u2018Localize DHPSF SMs\u2019 panel.\r\n\n\n4.2: Choose the frames from the raw data to process: by default, the entire image stack is processed.\r\n\n\n4.3: Whenever starting a new experiment, monitor this process as it proceeds to ensure that the threshold used includes the single molecules visible in the raw data, and to ensure that the fits are performed successfully. Only matches that score above the thresholds are fit, and good fits are plotted in the frame-by-frame reconstruction \\(see \"Figure 8\":#f7). Here the definition of a good double-Gaussian fit is a fit that meets several straightforward criteria, hard-coded into the module. The tests performed to define a good fit are listed below under \"Troubleshooting\":#troubleshooting \\(step 4).\n**Figure 8. A single raw movie frame being analyzed by the SM-fitting module.** Left: phase correlation of the raw image with the DH templates. Center: raw data with template matches indicated by circles. Right: the image reconstructed from good double-Gaussian fits.\r\n\n\n\r\n\n\n**Step 5. Viewing/Exporting the Processed Data**\r\n\n\nEasy-DHPSF gives three options for output of the processed data after all modules have been run, which are discussed in greater detail in the \"Anticipated Results\":#anticipated_results.\r\n\n\n5.1: Click \u2018Export to csv\u2019 to generate a list of localizations in .csv format for direct manipulation. The columns of this file are labeled. Note that this listed _z_ position does NOT correct for index of refraction mismatch between the sample and the objective\\! The user should supply that correction to the data before producing final reconstructions. \r\n\n\n5.2: Click \u20183D scatterplot\u2019 to generate a scatterplot of localizations at a particular ROI. Set the index of refraction for the immersion lens and the sample to apply a simple correction for index mismatch; by default, oil immersion and an aqueous sample are assumed. \r\n\n\n5.3: Click \u20182D histogram\u2019 to generate a histogram of localizations with median _z_ position for each bin coded by color. As with the scatterplot, this module will correct for index mismatch."
        },
        {
            "header": "Timing",
            "content": "_Benchmarked on a 3 GHz Intel Core 2 Duo workstation running 64-bit Windows 7 Professional with 8&nbsp;GB of RAM_\r\n\n\n\r\n\n\n**Step 1. DH-PSF Calibration**\r\n\n\n2 min \\(2 beads, 256\u00d7256 pixels \u00d7 500 frames \\[50 z-steps, 10 acquisitions per step])\r\n\n\n\r\n\n\n**Step 2. Single-Molecule Detection Calibration**\r\n\n\n36 min \\(128\u00d7128 pixels \u00d7 20,000 frames)\r\n\n\n\r\n\n\n**Step 3. Fiducial Tracking**\r\n\n\n13 min \\(1 bead, 64\u00d764 pixels \u00d7 9,000 frames)\r\n\n\n\r\n\n\n**Step 4. Single-Molecule Localization**\r\n\n\n75 min \\(100,000 molecules in 128\u00d7128 pixels \u00d7 20,000 frames)"
        },
        {
            "header": "Troubleshooting",
            "content": "**General troubleshooting**\r\n\n\nIf the phase mask used to generate the DH-PSF is grossly misaligned, then the fitting may not be feasible. Problems with the alignment should be noticeable in the output from the calibration module.\r\n\n\n \r\n\n\nIf the processed data are moved after saving a project file, the GUI will not be able to locate it. Please avoid moving processed data once it is created. Otherwise, manually edit the file paths saved in the project .MAT file to restore operation.\r\n\n\n\r\n\n\nIf the user does not have read and write access to the directory where the raw datafiles reside, file access errors will occur. Move the raw data to a folder for which you have read and write access.\r\n\n\n\r\n\n\n**Step 2. Single-Molecule Detection Calibration**\r\n\n\nIf the ROI chosen for the template calibration is not circularly periodic \\(i.e., the edges of the ROI do not have approximately the same signal level from left to right, top to bottom), it is possible that erroneous template matches will appear. If this occurs, change the ROI such that its edges are approximately continuous.\r\n\n\n\r\n\n\n**Step 4. Single-Molecule Localization**\r\n\n\nIf the DH-PSF fitting algorithm has a high rate of false negatives \\(not fitting clearly visible images of the DH-PSF present in the raw data), there are several possible causes:\r\n\n\n\r\n\n\nFirst, if the threshold has been set too high, then good PSFs identified by the template-matching algorithm may be thrown out and never fit. If this occurs, the central panel of the fitting module \\(see \"Figure 8\":#f7) will not show circles around DH-PSFs. To fix this, lower the thresholds.\r\n\n\n\r\n\n\nIf the localization fails during the double-Gaussian fitting step, it is likely that the DH-PSF has failed one or more filtering criteria. These are flagged, and can be viewed by hitting the \u2018debug\u2019 button after the fitting step is complete. Doing so generates a .csv file containing all data for good and bad fits, as well as a diagnostic showing how many fits failed, and why. This will indicate possible reasons for the errors in fitting. For example, if the pixel size is set improperly, many bounds used in assuring that the fits are valid will be distorted. This might lead to many localizations being flagged as having values of _\u03c3_ for the double-Gaussian fit that are out of bounds. The possible flags are:\r\n\n\n \u2022 -1007: Error in the linear least squares fit too high\r\n\n\n \u2022 -1006: Ratio of the amplitudes of the two Gaussian lobes too high\r\n\n\n \u2022 -1005: Distance between DH-PSF lobes out of bounds\r\n\n\n \u2022 -1004: Ratio of _\u03c3_ values out of bounds\r\n\n\n \u2022 -1003: Absolute _\u03c3_ values out of bounds\r\n\n\n \u2022 -1002: One or more peaks in the fit too far away from template match\r\n\n\n \u2022 -1001: Amplitude of one or more of the peaks <0\r\n\n\n \u2022 -1000: Initial guess of location outside of selected ROI"
        },
        {
            "header": "Anticipated Results",
            "content": "Upon successful fitting of the SM data, the user may use the \u2018Output DHPSF SM localizations\u2019 panel to export the SM 3D positions for further post-processing or visualization of the data. Clicking on the \u2018Export to csv\u2019 button will prompt the user for a filename and then subsequently save the valid 3D localizations to a comma-separated text file. Note that these localizations have not been corrected for focal shift resulting from imaging into mismatched media.\r\n\n\n\r\n\n\nThe program can also plot the 3D localizations as solid circles in a 3D scatterplot; note that this type of plot is quick to render but conveys localization density poorly when localizations are dense, and the validity of the use of a crude scatterplot for publication is the responsibility of the user. Clicking the \u20183D scatterplot' button will first prompt the user to verify settings used to plot the SM data. For example, the immersion lens index of refraction and sample media index of refraction can be entered to correct the SMs\u2019 _z_ positions for focal shift due to imaging into mismatched media \\(note that this correction of <a href=\"#figures\" data-url=\"http://www.nature.com/protocolexchange/system/uploads/2498/original/Eqn005_inline_.gif?1361256531\">See figure in Figures section.</a> is an approximation). Furthermore, the user can specify if they want the scatter points to be color-coded in time \\(useful for discerning sample drift, for example). The user then selects a region of interest \\(ROI) to plot in 3D. Once displayed, the 3D scatterplot can be manipulated using the zoom, pan, and rotate tools in the figure toolbar.\r\n\n\n\r\n\n\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/2491/original/figure_9.png?1361254943\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/2491/display/figure_9.png?1361254943\" > </a>  \r\n\n\n**Figure 9. Select region of interest for 3D scatterplot.**\r\n\n\n\r\n\n\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/2492/original/figure_10.png?1361254969\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/2492/display/figure_10.png?1361254969\" > </a>  \r\n\n\n**Figure 10. Sample 3D scatterplot of a section of microtubules.**\r\n\n\n\r\n\n\nFor continuous extended structures, the \u20182D histogram' function also available. Again, the validity of the use of any particular reconstruction for publication is the responsibility of the user. This function subdivides the ROI into a series of square 2D _xy_ bins of a user-specified size. It then calculates the number and median _z_ position of the localizations within each bin. Similar to the scatterplot function, clicking on the \u20182D histogram' button also prompts the user for histogram plotting parameters and an ROI. Then two plots appear, one with the median _z_ position color-coded for each bin \\(no localization number/density information) and the other with both z position color-coded for each bin and number of localizations proportional to the brightness of each bin.\r\n\n\n\r\n\n\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/2493/original/figure_11.png?1361254992\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/2493/display/figure_11.png?1361254992\" > </a>  \r\n\n\n**Figure 11. Sample histograms of labeled microtubules conveying 3D localization information.** Left: Localization bins color-coded by median z position. Right: Localization bins color-coded by both number of localizations and median z position to convey density information."
        },
        {
            "header": "References",
            "content": "1. Hell, S. W. Microscopy and its focal switch. _Nat. Methods_ **6**, 24-32 \\(2009). \r\n  2. Moerner, W. E. Microscopy beyond the diffraction limit using actively controlled single molecules. _J. Microsc._ **246**, 213-220 \\(2012). \r\n  3. Thompson, M. A., Lew, M. D. & Moerner, W. E. Extending Microscopic Resolution with Single-Molecule Imaging and Active Control. _Annu. Rev. Biophys._ **41**, 321-342 \\(2012). \r\n  4. Nyquist, H. Certain Topics in Telegraph Transmission Theory. _Trans. AIEE_ **47**, 617-644 \\(1928). \r\n  5. Shannon, C. E. Communication in the Presence of Noise. _Proc. IRE_ **37**, 10-21 \\(1949). \r\n  6. Hess, S. T., Girirajan, T. P. K. & Mason, M. D. Ultra-high resolution imaging by fluorescence photoactivation localization microscopy. _Biophys. J._ **91**, 4258-4272 \\(2006). \r\n  7. Betzig, E. et al. Imaging Intracellular Fluorescent Proteins at Nanometer Resolution. _Science_ **313**, 1642-1645 \\(2006). \r\n  8. Rust, M. J., Bates, M. & Zhuang, X. Sub-diffraction-limit imaging by stochastic optical reconstruction microscopy \\(STORM). _Nat. Methods_ **3**, 793-796 \\(2006). \r\n  9. Biteen, J. S. et al. Super-resolution imaging in live Caulobacter crescentus cells using photoswitchable EYFP. _Nat. Methods_ **5**, 947-949 \\(2008). \r\n  10. Sharonov, A. & Hochstrasser, R. M. Wide-field subdiffraction imaging by accumulated binding of diffusing probes. _Proc. Natl. Acad. Sci. USA_ **103**, 18911-18916 \\(2006). \r\n  11. Biteen, J. S., Thompson, M. A., Tselentis, N. K., Shapiro, L. & Moerner, W. E. Superresolution Imaging in Live Caulobacter crescentus Cells Using Photoswitchable Enhanced Yellow Fluorescent Protein. _Proc. SPIE_ **7185**, 71850I \\(2009). \r\n  12. Pavani, S. R. P. et al. Three-dimensional, single-molecule fluorescence imaging beyond the diffraction limit by using a double-helix point spread function. _Proc. Natl. Acad. Sci. USA_ **106**, 2995-2999 \\(2009). \r\n  13. Thompson, M. A., Lew, M. D., Badieirostami, M. & Moerner, W. E. Localizing and Tracking Single Nanoscale Emitters in Three Dimensions with High Spatiotemporal Resolution Using a Double-Helix Point Spread Function. _Nano Lett._ **10**, 211-218 \\(2010). \r\n  14. Backlund, M. P. et al. Simultaneous, accurate measurement of the 3D position and orientation of single molecules. _Proc. Natl. Acad. Sci. USA_ **109**, 19087-19092 \\(2012). \r\n  15. Lew, M. D., Thompson, M. A., Badieirostami, M. & Moerner, W. E. In vivo three-dimensional superresolution fluorescence tracking using a double-helix point spread function. _Proc. SPIE_ **7571**, 75710Z \\(2010). \r\n  16. Brunelli, R. in _Template matching techniques in computer vision: theory and practice_ \\(Wiley, Chichester, West Sussex, U.K., 2009). \r\n  17. Lee, H. D., Sahl, S. J., Lew, M. D. & Moerner, W. E. The double-helix microscope super-resolves extended biological structures by localizing single blinking molecules in three dimensions with nanoscale precision. _App. Phys. Lett._ **100**, 153701 \\(2012). \r\n  18. Lew, M. D. et al. Three-dimensional superresolution colocalization of intracellular protein superstructures and the cell surface in live Caulobacter crescentus. _Proc. Natl. Acad. Sci. USA_ **108**, E1102-E1110 \\(2011). \r\n  19. Gahlmann, A. et al. Quantitative multicolor subdiffraction imaging of bacterial protein ultrastructures in 3D. _Nano Lett._ \\(2013). \r\n  20. Grover, G., Quirin, S., Fiedler, C. & Piestun, R. Photon efficient double-helix PSF microscopy with application to 3D photo-activation localization imaging. _Biomed Opt Expr_ **2**, 3010-3020 \\(2011). \r\n  21. \"http://www.mirametrics.com/tech_note_ccdgain.htm\":http://www.mirametrics.com/tech_note_ccdgain.htm."
        },
        {
            "header": "Acknowledgements",
            "content": "We thank and recognize everyone who has contributed to writing, debugging, and generally improving this code over the years: Andreas Gahlmann, Mikael P. Backlund, Steven F. Lee, Steffen J. Sahl, Alex Chang, and Scott S. Hsieh. We also acknowledge R. Piestun for providing the DH-PSF phase mask design. This work was supported by a National Science Foundation Graduate Research Fellowship and 3Com Corporation Stanford Graduate Fellowship \\(to M.D.L.) and a National Institute of General Medical Sciences Grant R01GM085437 \\(to W.E.M.)."
        }
    ],
    "attributes": {
        "acceptedTermsAndConditions": true,
        "allowDirectSubmit": true,
        "archivedVersions": [],
        "articleType": "Method Article",
        "associatedPublications": [
            {
                "doi": "10.1073/pnas.1114444108",
                "date": "2013-02-18 20:00:00",
                "title": "PNAS Plus: Three-dimensional superresolution colocalization of intracellular protein superstructures and the cell surface in live Caulobacter crescentus",
                "authors": [
                    "M. D. Lew",
                    "S. F. Lee",
                    "J. L. Ptacin",
                    "M. K. Lee",
                    "R. J. Twieg",
                    "L. Shapiro",
                    "and W. E. Moerner"
                ],
                "journal": "Proceedings Of The National Academy Of Sciences",
                "logo": ""
            },
            {
                "doi": "10.1063/1.3700446",
                "date": "2013-02-18 19:54:50",
                "title": "The double-helix microscope super-resolves extended biological structures by localizing single blinking molecules in three dimensions with nanoscale precision",
                "authors": [
                    "Hsiao-lu D. Lee",
                    "Steffen J. Sahl",
                    "Matthew D. Lew",
                    "and W. E. Moerner"
                ],
                "journal": "Applied Physics Letters",
                "logo": ""
            },
            {
                "doi": "10.1021/nl304071h",
                "date": "2013-02-18 20:00:38",
                "title": "Quantitative multicolor subdiffraction imaging of bacterial protein ultrastructures in 3D",
                "authors": [
                    "Andreas Gahlmann",
                    "Jerod Louis Ptacin",
                    "Ginni Grover",
                    "Sean Quirin",
                    "Alexander R.S. von Diezmann",
                    "Marissa K. Lee",
                    "Mikael Paul Backlund",
                    "Lucy Shapiro",
                    "Rafael Piestun",
                    "and W.E. Moerner"
                ],
                "journal": "Nano Letters",
                "logo": ""
            }
        ],
        "authors": [
            {
                "id": 12406,
                "identity": "9ff3e1f5-516f-11e9-9e20-12b504df345a",
                "order_by": 0,
                "name": "W. E. Moerner",
                "email": "wmoerner@stanford.edu",
                "orcid": "",
                "institution": "Moerner Laboratory, Department of Chemistry, Stanford University",
                "correspondingAuthor": true,
                "prefix": "",
                "firstName": "W.",
                "middleName": "E.",
                "lastName": "Moerner",
                "suffix": ""
            },
            {
                "id": 12404,
                "identity": "9ff3dcdd-516f-11e9-9e20-12b504df345a",
                "order_by": 1,
                "name": "Matthew D. Lew*",
                "email": "",
                "orcid": "",
                "institution": "Moerner Laboratory, Department of Chemistry, Stanford University",
                "correspondingAuthor": false,
                "prefix": "",
                "firstName": "Matthew",
                "middleName": "D.",
                "lastName": "Lew*",
                "suffix": ""
            },
            {
                "id": 12405,
                "identity": "9ff3e00f-516f-11e9-9e20-12b504df345a",
                "order_by": 1,
                "name": "Alexander R. S. von Diezmann*",
                "email": "",
                "orcid": "",
                "institution": "Moerner Laboratory, Department of Chemistry, Stanford University",
                "correspondingAuthor": false,
                "prefix": "",
                "firstName": "Alexander",
                "middleName": "R. S.",
                "lastName": "von Diezmann*",
                "suffix": ""
            }
        ],
        "badges": [],
        "createdAt": "2013-02-23 22:10:03",
        "currentVersionCode": 1,
        "declarations": "",
        "doi": "10.1038/protex.2013.026",
        "doiUrl": "https://doi.org/10.1038/protex.2013.026",
        "draftVersion": [],
        "editorialEvents": [],
        "editorialNote": "",
        "failedWorkflow": [],
        "files": [
            {
                "id": 2608668,
                "identity": "e5a725b7-77eb-42e7-9d01-9513e7b8f626",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:23",
                "extension": "png",
                "order_by": 1,
                "title": "Figure 1",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 29395,
                "visible": true,
                "origin": "",
                "legend": "The Easy-DHPSF command window (left) before running any modules and (right) after localizing single molecules.",
                "description": "",
                "filename": "figure1.png",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_1.png"
            },
            {
                "id": 2608669,
                "identity": "c9546ab9-9dd2-4bfa-914e-2705ce1a4b47",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:23",
                "extension": "png",
                "order_by": 2,
                "title": "Figure 2",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 17973,
                "visible": true,
                "origin": "",
                "legend": "Choose region of interest for calibrating the DH-PSF.",
                "description": "",
                "filename": "figure2.png",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_2.png"
            },
            {
                "id": 2608672,
                "identity": "df8830d6-0012-4dad-bde3-850905b2499f",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:23",
                "extension": "png",
                "order_by": 3,
                "title": "Figure 3",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 47385,
                "visible": true,
                "origin": "",
                "legend": "A single raw movie frame being analyzed by the DH-PSF calibration module.   Left: raw data after dark offset subtraction. Right: the reconstructed image of two beads in the raw data that were selected for fitting.",
                "description": "",
                "filename": "figure3.png",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_3.png"
            },
            {
                "id": 2608673,
                "identity": "52eff259-5d90-4edf-b057-a4d352a8741a",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:23",
                "extension": "png",
                "order_by": 4,
                "title": "Figure 4",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 18714,
                "visible": true,
                "origin": "",
                "legend": "DH-PSF calibration statistics.   For a good calibration standard, the calibration curve (upper-left) should be roughly linear, the _xy_ position (upper-right) should deviate less than \u00b150&nbsp;nm, and the localization precision (lower-left, lower-middle) in _x_, _y_, and _z_ should be \u226415&nbsp;nm over the course of the scan.",
                "description": "",
                "filename": "figure4.png",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_4.png"
            },
            {
                "id": 2608679,
                "identity": "616038f4-1903-4564-ae3b-a9067e439003",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:24",
                "extension": "png",
                "order_by": 5,
                "title": "Figure 5",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 9564,
                "visible": true,
                "origin": "",
                "legend": "Typical DH-PSF templates.   Each template is chosen from the aforementioned calibration scan, where the rotation of the double helix between templates is evenly spaced at ~30\u00b0.",
                "description": "",
                "filename": "figure5.png",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_5.png"
            },
            {
                "id": 2608674,
                "identity": "9c6d69f8-f4e7-4bde-b472-8767815c61de",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:23",
                "extension": "png",
                "order_by": 6,
                "title": "Figure 6",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 66533,
                "visible": true,
                "origin": "",
                "legend": "A single raw movie frame being analyzed by the SM-detection calibration module.   Left: the 2D Fourier transform of the image. Right: raw data with template matches indicated by colored circles. Larger circles indicate stronger matches, and will be saved with a higher threshold value.",
                "description": "",
                "filename": "figure6.png",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_6.png"
            },
            {
                "id": 2608675,
                "identity": "0fdde65a-5757-4849-b2e3-4ce7490afe9c",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:23",
                "extension": "png",
                "order_by": 7,
                "title": "Figure 7",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 50927,
                "visible": true,
                "origin": "",
                "legend": "Potential DH-PSF SMs identified by template matching.   The image with an appropriate threshold is highlighted. Note that while thresholds 88, 92, 94, 102, 106, and 107 represent poor matches to the DH-PSF, the other matches for correlation values \u226584 are satisfactory.",
                "description": "",
                "filename": "figure7.png",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_7.png"
            },
            {
                "id": 2608677,
                "identity": "9bf4731f-9769-4701-b95d-66db07530ed5",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:24",
                "extension": "png",
                "order_by": 8,
                "title": "Figure 8",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 60536,
                "visible": true,
                "origin": "",
                "legend": "A single raw movie frame being analyzed by the SM-fitting module.   Left: phase correlation of the raw data with the DH templates. Center: raw data with template matches indicated by circles. Right: the image reconstructed from good double-Gaussian fits.",
                "description": "",
                "filename": "figure8.png",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_8.png"
            },
            {
                "id": 2608676,
                "identity": "25823ea1-8c36-4ce2-9ca9-bce834d80b9c",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:24",
                "extension": "png",
                "order_by": 9,
                "title": "Figure 9",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 37523,
                "visible": true,
                "origin": "",
                "legend": "Select region of interest for 3D scatterplot.",
                "description": "",
                "filename": "figure9.png",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_9.png"
            },
            {
                "id": 2608678,
                "identity": "9d273725-d062-4097-8ade-dcd55c934650",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:24",
                "extension": "png",
                "order_by": 10,
                "title": "Figure 10",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 40657,
                "visible": true,
                "origin": "",
                "legend": "Sample 3D scatterplot of a section of microtubules.",
                "description": "",
                "filename": "figure10.png",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_10.png"
            },
            {
                "id": 2608687,
                "identity": "fbc7dab4-4f88-4140-843e-fc06f108f2ed",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:24",
                "extension": "png",
                "order_by": 11,
                "title": "Figure 11",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 238638,
                "visible": true,
                "origin": "",
                "legend": "Sample histograms of labeled microtubules conveying 3D localization information.   Left: Localization bins color-coded by median z position. Right: Localization bins color-coded by both number of localizations and median z position to convey density information.",
                "description": "",
                "filename": "figure11.png",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_11.png"
            },
            {
                "id": 2608680,
                "identity": "c01c0eef-9ac0-4741-bb1a-171462d89e89",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:24",
                "extension": "gif",
                "order_by": 12,
                "title": "Figure 12",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 1951,
                "visible": true,
                "origin": "",
                "legend": "Equation 1   Template matching is a process in which we try to find small, known patches _t_(_x_, _y_) in an image _s_(_x_, _y_) by selecting locations (_p_, _q_) that minimize the mean squared error quantity _E_(_p_, _q_).",
                "description": "",
                "filename": "figure12.gif",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_12.gif"
            },
            {
                "id": 2608681,
                "identity": "3353068b-777a-4458-996b-3d00e8171afb",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:24",
                "extension": "gif",
                "order_by": 13,
                "title": "Figure 13",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 1288,
                "visible": true,
                "origin": "",
                "legend": "Equation 2   Template matching may be recast as a very closely related problem, the maximization of the area correlation _r_(_p_, _q_), where * denotes the convolution operation.",
                "description": "",
                "filename": "figure13.gif",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_13.gif"
            },
            {
                "id": 2608682,
                "identity": "eeab9720-c6b1-40d6-9ed0-8fc0a90e060c",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:24",
                "extension": "gif",
                "order_by": 14,
                "title": "Figure 14",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 3600,
                "visible": true,
                "origin": "",
                "legend": "Equation 4   An eight-parameter double-Gaussian model of the DH-PSF _U_(_x_, _y_).   The four parameters used for each circularly-symmetric Gaussian function are amplitude (_A_~1~ and _A_~2~), _x_-center location (_\u03bc_~x1~ and _\u03bc_~x2~), _y_-center location (_\u03bc_~y1~ and _\u03bc_~y2~), and width (_\u03c3_~1~ and _\u03c3_~2~).",
                "description": "",
                "filename": "figure14.gif",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_14.gif"
            },
            {
                "id": 2608683,
                "identity": "e4af3991-a64e-4d33-b0f6-2d8ad4c233b4",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:24",
                "extension": "gif",
                "order_by": 15,
                "title": "Figure 15",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 2428,
                "visible": true,
                "origin": "",
                "legend": "Equation 3   The phase correlation image _r_~k~ is computed from the input image _s_ and template _t_~k~.   FT{} denotes the two-dimensional Fourier transform, FT^-1^{} denotes the two-dimensional inverse Fourier transform, and the prefilter _h_ is a Gaussian lowpass filter with a width _\u03c3_ \u2248 1.5&nbsp;pixels.",
                "description": "",
                "filename": "figure15.gif",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_15.gif"
            },
            {
                "id": 2608684,
                "identity": "d2c397ef-e12b-406c-a43b-687bf94621bd",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:24",
                "extension": "gif",
                "order_by": 16,
                "title": "Figure 16",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 1329,
                "visible": true,
                "origin": "",
                "legend": "Equation 5 (inline)   Simple correction for focal shift due to imaging into mismatched media.   Note that this correction is an approximation.",
                "description": "",
                "filename": "figure16.gif",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/figure_16.gif"
            },
            {
                "id": 13464606,
                "identity": "6d0e4cd2-a77a-4e2b-b7ba-413ba0a7603b",
                "added_by": "auto",
                "created_at": "2021-09-16 20:44:01",
                "extension": "pdf",
                "order_by": 0,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "manuscript-pdf",
                "size": 2384279,
                "visible": true,
                "origin": "",
                "legend": "",
                "description": "",
                "filename": "manuscript.pdf",
                "url": "https://assets.researchsquare.com/files/nprot-2622/v1/02d67201-c841-491f-9894-6b5a04e704bd.pdf"
            }
        ],
        "financialInterests": "The authors declare no competing financial interests.\r\n\n\n\r\n\n\n*These authors contributed equally to this work.",
        "fulltextSource": "",
        "fullText": "",
        "funders": [],
        "hasOptedInToPreprint": true,
        "hasPassedJournalQc": "",
        "hideJournal": true,
        "highlight": "",
        "institution": "",
        "isAuthorSuppliedPdf": false,
        "isDeskRejected": "",
        "isHiddenFromSearch": false,
        "isInQc": false,
        "isInWorkflow": false,
        "journal": {
            "display": true,
            "email": "protocol.exchange@nature.com",
            "identity": "protocol-exchange",
            "isNatureJournal": false,
            "hasQc": false,
            "allowDirectSubmit": true,
            "externalIdentity": "",
            "sideBox": "",
            "submissionUrl": "https://protocolexchange.researchsquare.com/submission",
            "title": "Protocol Exchange",
            "twitterHandle": ""
        },
        "keywords": "Super-resolution, superresolution, localization microscopy, single molecule, fluorescence, PALM, STORM, fPALM, SMACM, double helix, DHPSF, three-dimensional imaging, 3D, template matching, image correlation, nonlinear least-squares, wavelet, MATLAB, graphical user interface, GUI, open source",
        "license": {
            "name": "CC BY-NC 3.0",
            "url": "https://creativecommons.org/licenses/by-nc/3.0/"
        },
        "manuscriptAbstract": "Automated processing of double-helix \\(DH) microscope images of single molecules \\(SMs) streamlines the protocol required to obtain super-resolved three-dimensional \\(3D) reconstructions of ultrastructures in biological samples by single-molecule active control microscopy. Here, we present a \"suite of MATLAB subroutines\":https://code.google.com/p/easy-dhpsf/, bundled with an easy-to-use \"graphical user interface \\(GUI)\":#f0, that facilitates 3D localization of single emitters \\(e.g. SMs, fluorescent beads, or quantum dots) with precisions of tens of nanometers in multi-frame movies acquired using a wide-field DH epifluorescence microscope. The algorithmic approach is based upon template matching for SM recognition and least-squares fitting for 3D position measurement, both of which are computationally expedient and precise. Overlapping images of SMs are ignored, and the precision of least-squares fitting is not as high as maximum likelihood-based methods. However, once calibrated, the algorithm can fit 15-30 molecules per second on a 3 GHz Intel Core 2 Duo workstation, thereby producing a 3D super-resolution reconstruction of 100,000 molecules over a 20\u00d720\u00d72 \u03bcm field of view \\(processing 128\u00d7128 pixels \u00d7 20000 frames) in \"75 min\":#time_taken.",
        "manuscriptTitle": "Easy-DHPSF open-source software for three-dimensional localization of single molecules with precision beyond the optical diffraction limit",
        "msid": "",
        "msnumber": "",
        "nonDraftVersions": [
            {
                "code": 1,
                "date": "2013-02-25 14:13:54",
                "doi": "10.1038/protex.2013.026",
                "editorialEvents": [
                    {
                        "type": "communityComments",
                        "content": 0
                    }
                ],
                "status": "published",
                "journal": {
                    "display": true,
                    "email": "info@researchsquare.com",
                    "identity": "researchsquare",
                    "isNatureJournal": false,
                    "hasQc": true,
                    "allowDirectSubmit": true,
                    "externalIdentity": "",
                    "sideBox": "",
                    "submissionUrl": "/submission",
                    "title": "Research Square",
                    "twitterHandle": "researchsquare"
                }
            }
        ],
        "origin": "",
        "ownerIdentity": "9ff35fc4-516f-11e9-9e20-12b504df345a",
        "owner": [],
        "postedDate": "February 25th, 2013",
        "published": true,
        "revision": "",
        "status": "posted",
        "subjectAreas": [
            {
                "id": 2902,
                "name": "Cell biology"
            },
            {
                "id": 2904,
                "name": "Nanoscience and technology"
            },
            {
                "id": 2905,
                "name": "Biological techniques"
            }
        ],
        "tags": [],
        "versionOfRecord": [],
        "versionCreatedAt": "2013-02-25 14:13:54",
        "video": "",
        "vorDoi": "",
        "vorDoiUrl": "",
        "workflowStages": []
    }
}