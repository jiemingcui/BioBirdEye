{
    "identity": "pex-1052",
    "title": "<p>A protocol for reconstructing the dynamics of real-world systems from observational data: Application for establishing a digital proxy of a bioreactor (DIYBOT)</p>",
    "content": [
        {
            "header": "Introduction",
            "content": "<p><strong>Introduction: </strong>With the advent of increasing connectivity, use of real time sensor data to inform biosystem management is a concept that is evolving toward development of digital twins<sup>1</sup>. One of the first steps towards a digital twin in the water reuse industry is the development of a digital proxy using real time sensor data combined with cross-sectional data. Observed time series records from real time sensors provide an essential evidentiary portal to understanding the systematic behavior of real-world environmental systems, which are complex, open (ever changing), and beyond anyone's capacity to model closely. Phenomenological models are used for determining ordinary differential equations which govern biosystem behavior, and are then combined with other models describing form and function to establish a digital proxy of a bioreactor (DIYBOT). McLamore et al <sup>1</sup> recently established the DIYBOT platform for development of smart water treatment systems as a first step toward development of a digital twin.</p><p>This protocol outlines Nonlinear Time Series Analysis (NLTS) as a collection of methods designed to empirically reconstruct and model the dynamics of bioreactors from the observational data that they generate, and is modified from previous versions in Huffaker and Fearne (2019)<sup>2</sup> and Huffaker et al. (2017)<sup>3</sup>. &nbsp;Reconstruction is possible because even a single observed variable in an interdependent dynamic system encodes the history of its interactions with co-variates.&nbsp;The famous naturalist John Muir expressed this succinctly: \u201cWhen we try to pick something up by itself, we find it hitched to everything else in the universe.\u201d<sup>4</sup> &nbsp;Empirically-reconstructed dynamics can be used to diagnose whether volatility in observational data is generated by a self-correcting dynamic system responding to exogenous shocks, or an endogenously unstable system that is not self-correcting.&nbsp;This distinction\u2014pivotal in managing and regulating real-world dynamic systems\u2014is imperceptible to casual inspection, and to empirical approaches presuming stochastic forcing<sup>2</sup>.&nbsp;Reconstructed dynamics also can be used to detect and quantify causal interactions among system variables, which helps to guide subsequent formulation of mechanistic models corresponding to reality. &nbsp;The seminal book on NLTS is Kantz and Schreiber (1997)<sup>5</sup>, and a more practical guide targeted to practitioners is Huffaker, Bittelli, and Rosa (2017)<sup>6</sup>.&nbsp;</p><p><strong>Overview of the procedure</strong></p><p>A sequence of NLTS methods is used to reconstruct deterministic system dynamics from observed output without prior knowledge of model equations. We present a brief synopsis of the methods outlined in <strong>Fig. 1</strong>, which include detection, reconstruction, and modeling of bioreactor dynamics.</p><p><strong>(A)</strong> <strong>Signal Processing</strong>:&nbsp;We begin with signal processing to prepare the record for NLTS diagnostics.&nbsp;We compute the <em>Fourier Spectrum</em> to determine whether there are recurrent oscillations in the observational data, and to ascertain the sampling interval required to adequately sample dominant oscillations.&nbsp;For example, there might be computational advantages to working with substantially fewer observations if hourly averages taken from 15-minute sampling intervals adequately capture dominant diurnal cycles in a record.&nbsp;We continue with <em>Singular Spectrum Analysis</em> (SSA)<sup>1</sup> signal processing to separate the signal in the data (structured variation composed of trend and oscillatory components) from the noise (unstructured random variation).&nbsp;SSA also gives us a measure of signal strength as the fraction of the total variation that the signal accounts for in the observational record.</p><p><strong>(B)</strong> <strong>Phase Space Reconstruction</strong>:&nbsp;We next apply <em>Time-Delay Embedding</em><sup><em>7</em></sup> to empirically reconstruct the phase space dynamics of the real-world system(s) that generated strong output signals. &nbsp;Phase space<em> </em>is the graphical portrayal of deterministic system dynamics.&nbsp;Phase space coordinates are provided by the system variables and their time-delayed copies, and each multidimensional point records the levels (states) of system variables at a point in time<sup>8</sup>.&nbsp;Phase space trajectories connecting these points depict the co-evolution of system variables from given initial states.&nbsp;If system dynamics are \u2018dissipative\u2019, these trajectories are bounded within a low-dimensional subset of phase space, and forever evolve along an \u2018attractor\u2019 in this subspace\u2014a geometric structure with noticeable regularity<sup>2</sup>.&nbsp;NLTS generates plots of phase space attractors, and applies concepts from multidimensional geometry to analyze attractor characteristics.&nbsp;<em>Surrogate data</em> <em>testing</em><sup>9,10</sup> tests the null hypothesis (H<sub>0</sub>) that apparent geometric regularity in a reconstructed shadow attractor is most likely generated by linear-stochastic dynamics as opposed to nonlinear deterministic dynamics. A significance level set at 95% generates &nbsp;surrogates for a one-sided test of predictive skill. Popular test statistics include nonlinear prediction<sup>11</sup> and permutation entropy<sup>12</sup>.&nbsp;&nbsp;With nonlinear prediction, we run an upper-tailed test that rejects H<sub>0</sub> if an empirical attractor predicts more skillfully in-sample than attractors reconstructed from randomized surrogate data.&nbsp;Using rank-order statistics, H<sub>0</sub> is rejected if prediction skill (as measured by Nash-Suttlciffe Model Efficiency) for an empirical attractor is among the <em>k</em> largest NSE values measured for the ensemble of attractors reconstructed from the surrogates.&nbsp;With permutation entropy, we run a lower tailed test that rejects H<sub>0</sub> if permutation entropy for an empirical attractor is among the <em>k</em> smallest NSE values measured for the ensemble of attractors reconstructed from the surrogates<sup>3</sup>.&nbsp;</p><p><strong>(C) Empirical Causality Detection</strong>:&nbsp;<em>Convergent Cross Mapping</em><sup><em>13</em></sup> (CCM) uses reconstructed &nbsp;attractors to map out a network of pairwise interactions in multivariate records.&nbsp;&nbsp;In short, CCM tests whether covariates reconstruct the dynamics of the same real-world system\u2014if so, then they are causally interactive.&nbsp;In particular, Y is found to drive X if an attractor reconstructed from lagged copies of X can be used to skillfully predict values of Y with nonlinear prediction methods.&nbsp;An attractor skillfully cross predicts another variable when the Pearson correlation coefficient converges to a high value as the number (library) of points on the attractor used to cross predict increases<sup>2</sup>.&nbsp;To distinguish causal interaction from synchronized behavior, cross mappings run at backward and forward delays must perform best at non-positive delays<sup>11</sup>.</p><p><br></p><p><strong>(D) Phenomenological Modeling</strong>: &nbsp;<em>Phenomenological modelling</em><sup><em>6,14</em></sup> extracts models of ordinary differential equations (ODE) from interacting output signals that mathematically reproduce real-world attractors empirically reconstructed directly from the signals. These models can be used to extrapolate system dynamics beyond the empirically reconstructed attractor, and quantify interactions detected with CCM by computing numerical partial derivatives measuring the marginal response of a response variable to an incremental change in a driving variable.&nbsp;The variables in these models are the time-delay coordinates from the corresponding reconstructed attractors. &nbsp;The time derivative of each variable is approximated by taking a 4<sup>th</sup> order centered finite difference.&nbsp;Each ODE is specified as a polynomial whose order is selected so that the solution of the ODE system faithfully reproduces the empirically-reconstructed attractor.&nbsp;Since the ODE system is linear in the parameters, parameters can be estimated with a variety of linear regression techniques.</p><p>The protocol in <strong>Fig. 1</strong> was applied in McLamore et al. (2020)<sup>1</sup> to develop a digital proxy of bioreactor (DIYBOT) for wastewater treatment. DIYBOT was used in McLamore et al. (2020)<sup>1</sup> to investigate whether bioreactor dynamics self-corrected in response to contamination spikes of increasing degrees; and consequently, the extent to which corrective human-in-the-loop management might be required.</p>"
        },
        {
            "header": "Reagents",
            "content": ""
        },
        {
            "header": "Equipment",
            "content": ""
        },
        {
            "header": "Procedure",
            "content": "Demonstration of protocol\nContinuous sensor data (pH and DO) were collected at 15-minute intervals for a 60-day period. During the first 40 days of operation, the bioreactor transitioned toward steady state operation (less than 5% deviation in treatment) characterized by dampened oscillatory behavior.\u00a0Starting on day 40, a pulse of 1.0 mg/L AgNP was added, and then at subsequent 30-day intervals two more pulses incremented by 1.0 mg/L were added (1.0 mg/L on day 40; 2.0 mg/L on day 70; 3.0 mg/L on day 100). Throughout this period the reactor was operating continuously.\u00a0The protocol below describes the computational packages and steps required to repeat the analysis, and the approach can be used for any system with the appropriate amount of data. Time series data were stored each week (and backed up on an external hard drive) for subsequent processing vai the protocol below. Excel files with representative data from the experiments (pH and DO data after three pulse additions of nanoparticles) can be found in the supplemental section of this protocol.\nComputational packages:\nThe steps in the protocol were run with\nR\n3.6.1 and the following packages:\nforecast v8.12\n(Fourier spectrum)\n15\n,\nRssa 0.13-1\n(singular spectrum analysis)\n16\n;\ntseriesChaos 0.1-13\n(phase space reconstruction and surrogate data analysis)\n17\n;\nfractal 2.0-1\n(compute AAFT surrogates)\n18\n;\nmultispatialCCM\n19\n(convergent cross mapping); and Code 9.8 (phenomenological modeling) detailed in Huffaker, Bitelli, and Rosa\n6\n, and available at\nhttp://www.dista.unibo.it/~bittelli/\n.\nStep 1:\nSignal processing of the three AgNP pulses for the O\n2\nand pH records as described in McLamore et al. (2020)\n1\n.\nCritical Step:\nSee troubleshooting section for a summary of the failure of signal processing to detect strong signals in sensor data.\nA.\nFourier Frequency Spectrum\nThe raw data and results of Fourier analysis are shown in\nFig. 2\n.\nFig 2A\nshows the raw O\n2\ndata (15 min time scale) and\nFig 2B\nshows the raw pH data (60 sec timescale) for three consecutive pulse additions of AgNP (see Excel file in supplemental section for sample data). Fourier spectra (\nFig 2C-D\n) are developed using the\nforecast v8.12\npackage and plotted (the spectrum is generated by the R package). As demonstrated by the peaks in\nFig 2C-D\n, the three-pulse series for both O\n2\nand pH each display a dominant cycle length of 200 (15-minute blocks) = 50 hours. This 50-hour dominant cycle length was easily identifiable in the plots.\nB.\nSingular Spectrum Analysis\nSingular Spectrum Analysis (SSA) involves analysis of waveform(s), and then determination of the strength of the signals.\u00a0To prepare for SSA, each sensor time series is standardized by removing the mean and dividing by the standard deviation.\nThe standardized data (black curves) and isolated signals (red curves) resulting from SSA are plotted in\nFig. 3\n. Each time course refers to a AgNP concentration following the convention in\nFig 2\n. The dominant 50-hour cycle can be adequately captured by resampling the data in 2-hour blocks (i.e., averaging every eight 15-minute blocks).\u00a0Benefits of this reduction include working with substantially fewer observations, and reducing noise by averaging higher-frequency volatility.\nFig 3\nshows the records replotted on a 2-hour time scale, where damped oscillations are apparent for both O\n2\nand pH.\nCritical Step\n: Rerun the Fourier Spectrum on the resampled 2-hour blocks to ensure that it reproduces the dominant 50-hour oscillation in 25 two-hour blocks.\nCritical Step\n: When the raw data (black curves in Fig 3) are plotted with the isolated signals (red curves in Fig 3), the plots will be aligned if there is no noise in the system; that is, if the signal accounts for all of the variation in the sensor record.\u00a0Since we expect measurements to have some noise (i.e., unstructured variation), we do not expect the curves to be coincident.\nCritical Step\n: Some signals contain only one dominant oscillation (see for example\nTable 1\nand\nFig 3\n). For example, pulse 1 for the O\n2\nsensor data contained one 50-hour dominant oscillation (signal strength of 0.82 in\nTable 1\nand also black/red curves in\nFig 3A\n). Some signals are composed of multiple oscillations, for example, pulse 2 for the O\n2\nsensor data contained three oscillations (signal strengths in\nTable 1\nand also black/red/blue curves in\nFig 3C\n).\nThe package\nRssa 0.13-1\nis used for singular spectrum analysis.\nTable 1\nreports strength of these signals and constituent oscillations.\u00a0We note that: (1) Signal strengths are relatively strong in explaining over half the total variation in the corresponding records (with the exception of pH Pulse 3); (2) Strengths are stronger for the O\n2\nrecord than the pH record; (3) Strengths tend to decrease as AgNP contamination increases from pulse 1 to 3; and (4) As expected from the Fourier Spectra, 50-hour cycles account for most of signal strength.\nCritical Step\n: Determination of whether signal strengths classify as \u201cstrong\u201d is done on a case-by-case basis, and requires some expert judgement. In this case, signal strengths were strong in explaining over half the total variation in the corresponding records, as noted above. Care must be taken to establish a benchmark for making the evaluation of signal strengths when conducting singular spectrum analysis. This is similar to the interpretation of regression coefficients in linear plots, where users make judgements on what is a \u201cgood\u201d R\n2\n.\nStep 2:\nPhase Space Reconstruction\nTime delay embedding and surrogate testing were carried out using the package\ntseriesChaos 0.1-13\n;\nfractal 2.0-1\nwas used to compute AAFT surrogates.\nA.\nTime-Delay Embedding\nEmpirical attractors reconstructed from O\n2\nand pH signals for the three AgNP pulse series are shown in the\nFig. 4A\n. These attractors exhibit geometric regularity in the form of three-dimensional spiral-sink dynamics for each AgNP addition using coordinates of: (1) real-time (current) values of dissolved oxygen, denoted as O\n2\n(t); (2) dissolved oxygen values with a delay of five two-hour blocks, denoted as O\n2\n(t+5); and (3) current values of pH, denoted as pH(t).\nB.\nSurrogate Data Testing\nThe results of testing the null hypothesis that apparent geometric regularity shown in the empirical attractors was most likely generated by a mimicking linear stochastic process are found in\nTable 2\n.\u00a0We see that all O\n2\nAgNP pulse series\u2019 pass surrogate tests for: (1) predictive skill since NSE values taken from empirical attractors (first column) are among the\nk\nlargest values taken from surrogate attractors (the\nk\nlargest values rest above the NSE values reported in the second column); and (2) permutation entropy since values taken from empirical attractors (third column) are among the\nk\nsmallest values taken from surrogate attractors (the\nk\nsmallest values rest below the those reported in the fourth column).\u00a0The surrogate results for the pH signals are more inconclusive.\u00a0Two of AgNP pulse series (1 and 3) fail the prediction test; while all three border-line pass the entropy test.\nCritical Step\n: Compare empirical attractor characteristics to corresponding surrogate attractor characteristics. Test the null hypothesis that there is no significant difference in the measured characteristics. If null hypothesis is valid, apparent regularity in the empirical attractor is most likely due to linear stochastic dynamics and not deterministic non-linear dynamics.\nCritical Step\n: Summary tables of surrogate data testing should be prepared for rapid analysis of predictive skill and permutation entropy tests. See for example summary\nTable 2\nand also Overview section B.\nStep 3:\nConvergent Cross Mapping (CCM)\nConvergent cross mapping was run with package\nmultispatialCCM\n19\n.\nCCM results indicate that causal interactions between O\n2\nand pH shift with increased pulses of AgNP contamination (\nFig. 4B\n).\u00a0\u00a0In this example dataset we see that pH remains a relatively strong driver of O\n2\nfor all concentrations of AgNP contamination, since CCM curves converge to correlation coefficients close to one (black curves).\u00a0In the other direction, O\n2\nbecomes an increasingly weak driver of pH as injected contamination increases (from left to right in the figure), and by AgNP pulse 3 the interaction is indistinguishable from non-causal synchronized behavior, since cross mappings run at backward and forward delays peak at a positive level (\nFig. 4C\n, right-most plot).\nCritical Step\n: If CCM curves converge to correlation coefficients close to 1.0, this indicates that the process X is a strong driver of Y.\nCritical Step\n: The convergence level for the CCM curve is used to infer the relative strength of the causal interaction.\nCritical Step\n: When conducting extended CCM, non-zero positive peak values (i.e., greater than one) indicate that the interaction noted in CCM is indistinguishable from non-causal synchronized behavior.\nThese shifting interactions are summarized in the causal diagram shown in\nFig. 5\n. In this simple example the causal maps are intuitive since there is only two variables and three test conditions, but in more complex data sets the use of causal maps is a highly useful visualization tool for understanding interactions between more than 3 nodes with multiple interactions.\nCritical step:\nCausal diagrams are generated in external software based on exported output from package\nmultispatialCCM\n19\n.\nStep 4:\nPhenomenological Modeling\nCode 9.8\n6\nwas used for phenomenological modeling. The phenomenological digital proxies extracted from the O\n2\nand pH signals are shown in\nFig. 6A\nfor each AgNP pulse, along with stability information (equilibria and eigenvalues) in\nFig. 6B\n.\u00a0This indicates that the models successfully reproduce the spiral-sink dynamics characterizing empirically-reconstructed bioreactor dynamics.\u00a0Another indication of success is that the attractors reconstructed from solutions of the phenomenological models bear striking visual resemblance to the empirical attractors (\nFig. 6C\n). \u00a0Finally, maximum Lyapunov Exponents computed from the empirical and phenomenological attractors were similar as described in McLamore et al\n1\n.\nCritical Step\n: Eigenvalues can be used to determine if the digital proxy successfully reproduces the empirically reconstructed spiral-sink dynamics as described in Huffaker, Bitelli, and Rosa\n6\n, and available at\nhttp://www.dista.unibo.it/~bittelli/\n. In the case of the example data set shown here, this is the case since the computed eigenvalues are a triplet of a negative real eigenvalue and a complex conjugate pair with negative real parts (as in\nFig 6\n).\nCritical Step\n: To confirm reproduction of time series dynamics, compute the maximum Lyapunov Exponents from the empirical and phenomenological attractors as described in McLamore et al\n1\n.\nA.\nCausality Quantification\nWe used numerical partial derivatives computed from the phenomenological models\u2014measuring the marginal response of a response variable to an incremental change in a driving variable\u2014to quantify the interactions detected with CCM (\nFig. 7\n).\u00a0We observe that when AgNP concentrations are at or below 2.0 mg/L, pH (the system driver) has a negative marginal impact on O\n2\n(black curves in\nFig. 7A-B\n), while O\n2\n(as the driver) has a positive marginal impact on the pH (red curves in\nFig. 7A-B\n). However, the impact of pH on O\n2\ndecays to zero as time progresses. When AgNP concentration is 3.0 mg/L, pH has a detrimental impact on O\n2\nand this relationship decays with time (\nFig. 7C\n).\nCritical Step\n: If the curve of X driver on Y output is positive, this indicates a positive marginal impact. Negative values indicate a negative marginal impact.\nCritical Step\n: If the curve decays to zero (as in this case for some of the curves), this indicates that over time the impact decays (i.e., is non-persistent)."
        },
        {
            "header": "Troubleshooting",
            "content": "<p><strong>Troubleshooting</strong></p><p>NLTS methods can fall short of successfully formulating a digital proxy of system output for several reasons including: (1) Signal processing may detect signals that are too weak to model (i.e., signals that account for only a small portion of total variance in the sensor data); (2) Sensor data may be insufficiently informative to reconstruct the real-world attractor, for example, data might only sample transitory dynamics heading toward the attractor; or (3) A low-dimensional nonlinear attractor may not exist. However, we do not know any of this until we have tested the output data for it<sup>2</sup>. When NLTS fails to detect strong signals, or diagnose dimension-reducing nonlinear real-world dynamics in sensor signals, then underlying dynamics may well be high dimensional and the information-extraction problem cannot be shrunk to a low-dimensional digital proxy without losing essential dynamic information. In these events, machine learning techniques may offer a better alternative. Details beyond the protocol here maybe found in Huffaker, Bittelli, and Rosa (2017)<sup>6</sup>.&nbsp;Troubleshooting tips are summarized in <strong>Table 3</strong>.</p>"
        },
        {
            "header": "Time Taken",
            "content": ""
        },
        {
            "header": "Anticipated Results",
            "content": ""
        },
        {
            "header": "Tables",
            "content": "Due to technical limitations, Tables 1-3 can be found in the Supplementary files section."
        },
        {
            "header": "References",
            "content": "<p><strong>References</strong></p><p>\t</p><p>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;McLamore, E.<em> et al.</em> Digital proxy of a bio-reactor (DIYBOT) combines sensor data and data analysis to improve greywater treatment and wastewater management systems. <em>Nat. Sci. Rep. </em><strong>(accepted, DOI: 10.1038/s41598-020-64789-5)</strong> (2020).</p><p>2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Huffaker, R. &amp; Fearne, A. Reconstructing systematic persistent impacts of promotional marketing with empirical nonlinear dynamics. <em>PLOS ONE</em> <strong>14</strong>, e0221167 (<a href=\"https://doi.org/0221110.0221371/journal.pone.0022167\" rel=\"noopener noreferrer\" target=\"_blank\">https://doi.org/0221110.0221371/journal.pone.0022167</a>) (2019).</p><p>3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Huffaker, R., Canavari, M. &amp; Munoz-Carpena, R. Distinguishing between endogenous and exogenous price volatility in food security assessment: An empirical nonlinear dynamics approach. <em>Agricultural Systems</em> <strong>160</strong>, 98-109 (2018).</p><p>4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Muir, J. <em>My First Summer in the Sierra</em>.&nbsp;(Houghton Mifflin, 1911).</p><p>5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Kantz, H. &amp; Schreiber, T. <em>Nonlinear Time Series Anaysis</em>.&nbsp;(Cambridge University Press, 1997).</p><p>6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Huffaker, R., Bittelli, M. &amp; Rosa, R. <em>Nonlinear Time Series Analysis with R</em>.&nbsp;(Oxford University Press, 2017).</p><p>7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Takens, F. in <em>Dynamical Systems and Turbulence </em>(ed D. Rand, Young, L. )&nbsp;366-381 (Springer, 1980).</p><p>8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Deyle, E. &amp; Sugihara, G. Generalized Theorems for Nonlinear State Space Reconstruction. <em>PLoS One</em> <strong>6</strong>, 1-8 (2011).</p><p>9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Theiler, J., Eubank, S., Longtin, A., Galdrikian, B. &amp; Farmer, J. Testing for nonlinearity in time series: The method of surrogate data. <em>Physica D</em> <strong>58</strong>, 77-94 (1992).</p><p>10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Schreiber, T. &amp; Schmitz, A. Surrogate time series. <em>Physica D</em> <strong>142</strong>, 346-382 (2000).</p><p>11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Kaplan, D. &amp; Glass, L. <em>Understanding Nonlinear Dynamics</em>.&nbsp;(Springer, 1995).</p><p>12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Brandt, C. &amp; Pompe, B. Permutation entropy: a natural complexity measure for time series. <em>Phys. Rev. Lett.</em> <strong>88</strong>, 174102 (2012).</p><p>13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sugihara, G.<em> et al.</em> Detecting causality in complex ecosystems. <em>Science</em> <strong>338</strong>, 496-500 (2012).</p><p>14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Brunton, S., Proctor, J. &amp; Kurtz, J. Discovering governing equations from data by sparse identification of nonlinear dynamic systems. <em>PNAS</em> <strong>113</strong>, 3932-3937 (2016).</p><p>15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hyndman, R. Forecasting functions for time series and linear models. <em>Retrieved from </em><a href=\"https://cran.r-project.org/package=forecast\" rel=\"noopener noreferrer\" target=\"_blank\"><em>https://cran.r-project.org/package=forecast</em></a> (2020).</p><p>16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Golyandina, N. &amp; Korobeynikov, A. Basic singular spectrum analysis and forecasting with R. <em>Computational Statistics and Data Analysis</em> <strong>71</strong>, 934-954 (2014).</p><p>17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Di Narzo, A. &amp; Di Narzo, F. tseriesChaos: analysis of nonlinear time series. <em>Retrieved from </em><a href=\"https://cran.r-project.org/package=tseriesChaos\" rel=\"noopener noreferrer\" target=\"_blank\"><em>https://cran.r-project.org/package=tseriesChaos</em></a> (2013).</p><p>18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constantine, W. &amp; Percival, D. fractal: Fractal time series modeling and analysis. <em>Retrieved from </em><a href=\"https://cran.r-project.org/package=fractal\" rel=\"noopener noreferrer\" target=\"_blank\"><em>https://cran.r-project.org/package=fractal</em></a><em>.</em> (2014).</p><p>19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Clark, A. multispatialCCM: multispatial convergent cross mapping. <em>Retrieved from </em><a href=\"https://cran.r-project.org/package=multispatialCCM\" rel=\"noopener noreferrer\" target=\"_blank\"><em>https://cran.r-project.org/package=multispatialCCM</em></a> (2014).</p><p>\t</p>"
        },
        {
            "header": "Acknowledgements",
            "content": "<p><strong>Acknowledgements</strong></p><p>This project was supported by Agriculture and Food Research Initiative Competitive Grant no. 2018-67016-27578 awarded as a Center of Excellence from the USDA National Institute of Food and Agriculture.</p>"
        }
    ],
    "attributes": {
        "acceptedTermsAndConditions": true,
        "allowDirectSubmit": true,
        "archivedVersions": [],
        "articleType": "Method Article",
        "associatedPublications": [
            {
                "doi": "10.1038/s41598-020-64789-5",
                "date": "2020-05-15 10:05:00",
                "title": "Digital Proxy of a Bio-Reactor (DIYBOT) combines sensor data and data analytics to improve greywater treatment and wastewater management systems",
                "authors": [
                    "Eric S. McLamore",
                    "Ray Huffaker",
                    "Matthew Shupler",
                    "Katelyn Ward",
                    "Shoumen Palit Austin Datta",
                    "M. Katherine Banks",
                    "Giorgio Casaburi",
                    "Joany Babilonia",
                    "Jamie S. Foster"
                ],
                "journal": "Scientific Reports",
                "logo": ""
            }
        ],
        "authors": [
            {
                "id": 878039,
                "identity": "36cfccc5-135b-4d84-9d84-ca8720d757d0",
                "order_by": 0,
                "name": "Ray Huffaker",
                "email": "",
                "orcid": "",
                "institution": "University of Florida, Agricultural & Biological Engineering",
                "correspondingAuthor": false,
                "prefix": "",
                "firstName": "Ray",
                "middleName": "",
                "lastName": "Huffaker",
                "suffix": ""
            },
            {
                "id": 878040,
                "identity": "0d1210f9-cfc8-41f4-93a5-dcf161c37ce1",
                "order_by": 1,
                "name": "Eric S. McLamore",
                "email": "emclamor@ufl.edu",
                "orcid": "https://orcid.org/0000-0002-1662-7372",
                "institution": "University of Florida, Agricultural & Biological Engineering",
                "correspondingAuthor": true,
                "prefix": "",
                "firstName": "Eric",
                "middleName": "S.",
                "lastName": "McLamore",
                "suffix": ""
            }
        ],
        "badges": [],
        "createdAt": "2020-07-16 20:55:44",
        "currentVersionCode": 1,
        "declarations": "",
        "doi": "10.21203/rs.3.pex-1052/v1",
        "doiUrl": "https://doi.org/10.21203/rs.3.pex-1052/v1",
        "draftVersion": [],
        "editorialEvents": [],
        "editorialNote": "",
        "failedWorkflow": [],
        "files": [
            {
                "id": 2626614,
                "identity": "d0a3e0bf-f9cd-48a9-94dd-37303b0e8d87",
                "added_by": "1b7c5ebc-7a22-4d40-8437-652c923e6447",
                "created_at": "2020-09-25 21:02:59",
                "extension": "png",
                "order_by": 1,
                "title": "Figure 1",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 80329,
                "visible": true,
                "origin": "",
                "legend": "Protocol for NLTS. Each step is described in the protocol. Details beyond the protocol here may be found in Huffaker, Bittelli, and Rosa (2017).  ",
                "description": "",
                "filename": "figure1.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/figure_1.png"
            },
            {
                "id": 2428450,
                "identity": "edef4574-216b-4857-aad1-c5f951097f78",
                "added_by": "auto",
                "created_at": "2020-09-16 08:52:31",
                "extension": "png",
                "order_by": 1,
                "title": "Figure 1",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 80329,
                "visible": true,
                "origin": "",
                "legend": "Protocol for NLTS. Each step is described in the protocol. Details beyond the protocol here may be found in Huffaker, Bittelli, and Rosa (2017).  ",
                "description": "",
                "filename": "Figure1.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/Figure1.png"
            },
            {
                "id": 2626625,
                "identity": "e8d45493-91a5-47e7-951d-a7f4bbea917c",
                "added_by": "1b7c5ebc-7a22-4d40-8437-652c923e6447",
                "created_at": "2020-09-25 21:02:59",
                "extension": "png",
                "order_by": 2,
                "title": "Figure 2",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 282877,
                "visible": true,
                "origin": "",
                "legend": "Fourier Spectrum. (A) O2 record on a 15-minute time scale. (B) pH record on a minute (60 seconds) time scale.  (C) Fourier spectra of the 3 AgNP pulse series for O2 record.  (D) Fourier spectra of the AgNP pulse series indicate a 50-hour dominant length cycle.",
                "description": "",
                "filename": "figure2.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/figure_2.png"
            },
            {
                "id": 2428451,
                "identity": "ea2f765d-ae82-4045-94f4-e5a4cbf77cb6",
                "added_by": "auto",
                "created_at": "2020-09-16 08:52:31",
                "extension": "png",
                "order_by": 2,
                "title": "Figure 2",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 282877,
                "visible": true,
                "origin": "",
                "legend": "Fourier Spectrum. (A) O2 record on a 15-minute time scale. (B) pH record on a minute (60 seconds) time scale.  (C) Fourier spectra of the 3 AgNP pulse series for O2 record.  (D) Fourier spectra of the AgNP pulse series indicate a 50-hour dominant length cycle.",
                "description": "",
                "filename": "Figure2.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/Figure2.png"
            },
            {
                "id": 2626615,
                "identity": "cfe7ad34-37f0-4b34-b675-7a64b10b3b1d",
                "added_by": "1b7c5ebc-7a22-4d40-8437-652c923e6447",
                "created_at": "2020-09-25 21:02:59",
                "extension": "png",
                "order_by": 3,
                "title": "Figure 3",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 193375,
                "visible": true,
                "origin": "",
                "legend": "Processed real time O2 and pH sensor data using singular spectrum analysis from McLamore et al. (2020)1. Standardized measured data are shown in black traces for both O2 (left side) and pH (right side), processed signals are shown in red. Time course analysis for A) 1.0 mg/L AgNP, B) 2.0 mg/L AgNP, and C) 3.0 mg/L AgNP.",
                "description": "",
                "filename": "figure3.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/figure_3.png"
            },
            {
                "id": 2428452,
                "identity": "380f8e8c-64c3-4321-8c43-4e6bb8711212",
                "added_by": "auto",
                "created_at": "2020-09-16 08:52:32",
                "extension": "png",
                "order_by": 3,
                "title": "Figure 3",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 193375,
                "visible": true,
                "origin": "",
                "legend": "Processed real time O2 and pH sensor data using singular spectrum analysis from McLamore et al. (2020)1. Standardized measured data are shown in black traces for both O2 (left side) and pH (right side), processed signals are shown in red. Time course analysis for A) 1.0 mg/L AgNP, B) 2.0 mg/L AgNP, and C) 3.0 mg/L AgNP.",
                "description": "",
                "filename": "Figure3.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/Figure3.png"
            },
            {
                "id": 2626622,
                "identity": "02dba1ae-2560-4b62-8093-c5f6f4078df9",
                "added_by": "1b7c5ebc-7a22-4d40-8437-652c923e6447",
                "created_at": "2020-09-25 21:02:59",
                "extension": "png",
                "order_by": 4,
                "title": "Figure 4",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 185432,
                "visible": true,
                "origin": "",
                "legend": "Phase space dynamics of O2 and pH time series data for determining causal interactions at varying AgNP concentration. A) Convergent cross mapping (CCM) to determine if reconstructed attractors indicate interactions between O2 and pH. B) Extended CCM used to rule out false positives of causal interaction.",
                "description": "",
                "filename": "figure4.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/figure_4.png"
            },
            {
                "id": 2428453,
                "identity": "80f3ff2d-7703-4166-b723-e6031902cebd",
                "added_by": "auto",
                "created_at": "2020-09-16 08:52:32",
                "extension": "png",
                "order_by": 4,
                "title": "Figure 4",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 185432,
                "visible": true,
                "origin": "",
                "legend": "Phase space dynamics of O2 and pH time series data for determining causal interactions at varying AgNP concentration. A) Convergent cross mapping (CCM) to determine if reconstructed attractors indicate interactions between O2 and pH. B) Extended CCM used to rule out false positives of causal interaction.",
                "description": "",
                "filename": "FIgure4.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/FIgure4.png"
            },
            {
                "id": 2626617,
                "identity": "d0febf6f-956d-4d6d-9fb7-25360ac326a3",
                "added_by": "1b7c5ebc-7a22-4d40-8437-652c923e6447",
                "created_at": "2020-09-25 21:02:59",
                "extension": "png",
                "order_by": 5,
                "title": "Figure 5",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 37902,
                "visible": true,
                "origin": "",
                "legend": "Causal Interaction Diagrams produced from Convergent Cross Mapping (CCM)",
                "description": "",
                "filename": "figure5.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/figure_5.png"
            },
            {
                "id": 2428454,
                "identity": "50e78626-790d-4b63-a8e6-3eb1003e2636",
                "added_by": "auto",
                "created_at": "2020-09-16 08:52:32",
                "extension": "png",
                "order_by": 5,
                "title": "Figure 5",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 37902,
                "visible": true,
                "origin": "",
                "legend": "Causal Interaction Diagrams produced from Convergent Cross Mapping (CCM)",
                "description": "",
                "filename": "Figure5.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/Figure5.png"
            },
            {
                "id": 2626618,
                "identity": "4fdfa049-352a-4d67-88cb-e9ad215303de",
                "added_by": "1b7c5ebc-7a22-4d40-8437-652c923e6447",
                "created_at": "2020-09-25 21:02:59",
                "extension": "png",
                "order_by": 6,
                "title": "Figure 6",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 183924,
                "visible": true,
                "origin": "",
                "legend": "Phenomenological models and eigenvalues with oridinary differential equations for each pulse of AgNP.",
                "description": "",
                "filename": "figure6.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/figure_6.png"
            },
            {
                "id": 2428455,
                "identity": "14101259-05fe-480b-90a9-1debdad37446",
                "added_by": "auto",
                "created_at": "2020-09-16 08:52:32",
                "extension": "png",
                "order_by": 6,
                "title": "Figure 6",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 183924,
                "visible": true,
                "origin": "",
                "legend": "Phenomenological models and eigenvalues with oridinary differential equations for each pulse of AgNP.",
                "description": "",
                "filename": "Figure6.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/Figure6.png"
            },
            {
                "id": 2626616,
                "identity": "34272551-798f-41e5-872b-4c04b13ade5d",
                "added_by": "1b7c5ebc-7a22-4d40-8437-652c923e6447",
                "created_at": "2020-09-25 21:02:59",
                "extension": "png",
                "order_by": 7,
                "title": "Figure 7",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 166309,
                "visible": true,
                "origin": "",
                "legend": "Quantifying the causal interactions of phenomenological modeling with CCM at concentrations of A) 1.0 AgNP mg/L, B) 2.0 AgNP mg/L, and C) A) 3.0 AgNP mg/L.",
                "description": "",
                "filename": "figure7.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/figure_7.png"
            },
            {
                "id": 2428456,
                "identity": "2dd5b929-fe87-4ab5-9441-3452c86643d9",
                "added_by": "auto",
                "created_at": "2020-09-16 08:52:32",
                "extension": "png",
                "order_by": 7,
                "title": "Figure 7",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 166309,
                "visible": true,
                "origin": "",
                "legend": "Quantifying the causal interactions of phenomenological modeling with CCM at concentrations of A) 1.0 AgNP mg/L, B) 2.0 AgNP mg/L, and C) A) 3.0 AgNP mg/L.",
                "description": "",
                "filename": "Figure7.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/Figure7.png"
            },
            {
                "id": 13593695,
                "identity": "ccbc6000-70f9-47f4-9c4a-e8558da61549",
                "added_by": "auto",
                "created_at": "2021-09-17 05:17:13",
                "extension": "pdf",
                "order_by": 0,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "manuscript-pdf",
                "size": 2223447,
                "visible": true,
                "origin": "",
                "legend": "",
                "description": "",
                "filename": "manuscript.pdf",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/16b75288-efb1-42eb-8f0b-49d9ba023bed.pdf"
            },
            {
                "id": 2626621,
                "identity": "91fe6385-7f0c-43c4-ab74-e72152c0976b",
                "added_by": "1b7c5ebc-7a22-4d40-8437-652c923e6447",
                "created_at": "2020-09-25 21:02:59",
                "extension": "png",
                "order_by": 1,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "supplement",
                "size": 46460,
                "visible": true,
                "origin": "",
                "legend": "Singular Spectrum Analysis.",
                "description": "",
                "filename": "supplement1.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/supplement_1.png"
            },
            {
                "id": 2428457,
                "identity": "5210a0f7-0624-4ffb-bef3-9e9237b73a7a",
                "added_by": "auto",
                "created_at": "2020-09-16 08:52:32",
                "extension": "png",
                "order_by": 1,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "supplement",
                "size": 46460,
                "visible": true,
                "origin": "",
                "legend": "Singular Spectrum Analysis.",
                "description": "",
                "filename": "Table1.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/Table1.png"
            },
            {
                "id": 2626620,
                "identity": "d5aa4221-45b0-4ef9-bf76-0510caf14429",
                "added_by": "1b7c5ebc-7a22-4d40-8437-652c923e6447",
                "created_at": "2020-09-25 21:02:59",
                "extension": "png",
                "order_by": 2,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "supplement",
                "size": 45818,
                "visible": true,
                "origin": "",
                "legend": "Surrogate Data Testing.",
                "description": "",
                "filename": "supplement2.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/supplement_2.png"
            },
            {
                "id": 2428458,
                "identity": "c9bc73fe-0721-42b4-9a20-025b0886fafa",
                "added_by": "auto",
                "created_at": "2020-09-16 08:52:33",
                "extension": "png",
                "order_by": 2,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "supplement",
                "size": 45818,
                "visible": true,
                "origin": "",
                "legend": "Surrogate Data Testing.",
                "description": "",
                "filename": "Table2.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/Table2.png"
            },
            {
                "id": 2626619,
                "identity": "55e6d01d-6480-4d04-a4e2-e74846c56387",
                "added_by": "1b7c5ebc-7a22-4d40-8437-652c923e6447",
                "created_at": "2020-09-25 21:02:59",
                "extension": "png",
                "order_by": 3,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "supplement",
                "size": 87170,
                "visible": true,
                "origin": "",
                "legend": "Troubleshooting common problems related to the protocol for establishment of a digital proxy based on sensor data.",
                "description": "",
                "filename": "supplement3.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/supplement_3.png"
            },
            {
                "id": 2428459,
                "identity": "3289c9ab-dd14-45e4-90ec-eb9a15182bd5",
                "added_by": "auto",
                "created_at": "2020-09-16 08:52:33",
                "extension": "png",
                "order_by": 3,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "supplement",
                "size": 87170,
                "visible": true,
                "origin": "",
                "legend": "Troubleshooting common problems related to the protocol for establishment of a digital proxy based on sensor data.",
                "description": "",
                "filename": "Table3.png",
                "url": "https://assets.researchsquare.com/files/pex-1052/v1/Table3.png"
            }
        ],
        "financialInterests": "",
        "fulltextSource": "",
        "fullText": "",
        "funders": [],
        "hasOptedInToPreprint": true,
        "hasPassedJournalQc": "",
        "hideJournal": true,
        "highlight": "",
        "institution": "",
        "isAuthorSuppliedPdf": false,
        "isDeskRejected": "",
        "isHiddenFromSearch": false,
        "isInQc": false,
        "isInWorkflow": false,
        "journal": {
            "display": true,
            "email": "protocol.exchange@nature.com",
            "identity": "protocol-exchange",
            "isNatureJournal": false,
            "hasQc": false,
            "allowDirectSubmit": true,
            "externalIdentity": "",
            "sideBox": "",
            "submissionUrl": "https://protocolexchange.researchsquare.com/submission",
            "title": "Protocol Exchange",
            "twitterHandle": ""
        },
        "keywords": "digital proxy, bioreactor, Nonlinear Time Series Analysis, signal processing, phase space reconstruction, surrogate data testing, convergent cross mapping, phenomenological modeling",
        "license": {
            "name": "CC BY 4.0",
            "url": "https://creativecommons.org/licenses/by/4.0/"
        },
        "manuscriptAbstract": "<p>This protocol sets out a broadly-applicable framework for empirically reconstructing the dynamics of biosystems from observational data, modeling reconstructed dynamics phenomenologically with systems of ordinary differential equations extracted from the data, and detecting and quantifying causal interactions among system components.&nbsp;The protocol draws from well-established procedures in Nonlinear Time Series Analysis (NLTS) that can be run with existing R packages.&nbsp;The protocol was applied in McLamore et al. (2020)<sup>1</sup> to develop a phenomenological digital proxy of a bioreactor (DIYBOT) from real-time sensor data.&nbsp;DIYBOT was used to investigate whether bioreactor dynamics self-corrected in response to contamination spikes of increasing degrees; and consequently, the extent to which corrective human-in-the-loop management might be required.</p>",
        "manuscriptTitle": "A protocol for reconstructing the dynamics of real-world systems from observational data: Application for establishing a digital proxy of a bioreactor (DIYBOT)",
        "msid": "",
        "msnumber": "",
        "nonDraftVersions": [
            {
                "code": 1,
                "date": "2020-09-16 08:49:50",
                "doi": "10.21203/rs.3.pex-1052/v1",
                "editorialEvents": [
                    {
                        "type": "communityComments",
                        "content": 0
                    }
                ],
                "status": "published",
                "journal": {
                    "display": true,
                    "email": "info@researchsquare.com",
                    "identity": "researchsquare",
                    "isNatureJournal": false,
                    "hasQc": true,
                    "allowDirectSubmit": true,
                    "externalIdentity": "",
                    "sideBox": "",
                    "submissionUrl": "/submission",
                    "title": "Research Square",
                    "twitterHandle": "researchsquare"
                }
            }
        ],
        "origin": "",
        "ownerIdentity": "1b7c5ebc-7a22-4d40-8437-652c923e6447",
        "owner": [],
        "postedDate": "September 16th, 2020",
        "published": true,
        "revision": "",
        "status": "posted",
        "subjectAreas": [
            {
                "id": 523013,
                "name": "Biotechnology"
            },
            {
                "id": 523014,
                "name": "Computational biology and bioinformatics"
            },
            {
                "id": 523015,
                "name": "Chemical biology"
            },
            {
                "id": 523016,
                "name": "Environmental sciences"
            },
            {
                "id": 523017,
                "name": "Complex networks"
            },
            {
                "id": 523018,
                "name": "Information theory and computation"
            },
            {
                "id": 523019,
                "name": "Engineering"
            }
        ],
        "tags": [],
        "versionOfRecord": [],
        "versionCreatedAt": "2020-09-16 08:49:50",
        "video": "",
        "vorDoi": "",
        "vorDoiUrl": "",
        "workflowStages": []
    }
}