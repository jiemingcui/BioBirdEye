{
    "identity": "nprot-4347",
    "title": "A protocol for LC-MS metabolomic data processing using chemometric tools",
    "content": [
        {
            "header": "Introduction",
            "content": "Metabolomics is a field that aims at the study of the abundance and/or structural characterization of a large range of metabolites of organisms that have suffered unknown alterations due to exposure to environmental stressors. \r\n\n\nSeveral analytical methods have been developed to perform metabolomic studies. Among them, mass spectrometry methods, coupled to chromatographic techniques have evolved into a novel and powerful technology due to their ability for multiparallel analysis of low molecular weight compounds in biological systems. Regarding chromatographic techniques, liquid chromatography \\(LC) is nowadays preferred to gas chromatography \\(GC), since the latter is restricted to volatile compounds, often requiring chemical derivatisation. \r\n\n\nData sets obtained with LC-MS technology contain large amount of information. Therefore, data processing is necessary to detect variations among omic profiles. However, one of the first steps required previous to data processing is the reduction of the dimensions of the original data sets, _i.e._, data compression. Recently, a novel data compression method has been introduced in the _centWave_ algorithm of _XCMS_ software<sup>1</sup>. This method is based on the concept of considering analytes as a region of data points with a high density ranked by a specific \u201cdata void\u201d, first presented by Stolt et al.<sup>2</sup>. These regions where analytes are found are called _regions_ _of_ _interest_ \\(_ROI_). This data compression method appears as a better alternative to the classical binning procedure<sup>1</sup> since no loss of spectral accuracy is derived from a ROI search whereas a loss of resolution occurs after binning, which performs a compression in the _m/z_-mode dimension. \r\n\n\nSeveral feature detection packages for omic LC-MS data have been developed in the last years \\(_e.g._, _MarkerLynx_ \\(_Waters_), _MetAlign_<sup>3</sup>, _XCMS_<sup>4</sup> and _Mzmine_<sup>5</sup>). However, a powerful alternative to these packages is the use of chemometric tools<sup>6</sup>,<sup>7</sup>. In fact, Multivariate Curve Resolution-Alternating Least Squares \\(MCR-ALS)<sup>8</sup> methods can properly resolve the profiling problem in omic data sets without the necessity of previous chromatographic alignment or shaping, which are required in most of the existent feature detection packages and represent the highest source of error. \r\n\n\nIn the present study we provide a detailed protocol and MATLAB functions \\(see \"Supplementary MATLAB functions\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=3adcd456c13cef5c017b66269651912c) for LC-MS omic data analysis \\(including data conversion, import, pre-processing \\(_i.e._, data compression) and processing steps). The distinct data analysis steps together with a brief description of the functions hereby used are provided in the **PROCEDURE** section. \r\n\n\n\r\n\n\n**Target** **audience** **and** **level** **of** **expertise** **needed** **to** **implement** **the** **protocol**\r\n\n\nThe present protocol targets scientists who are using LC-MS techniques in metabolomic studies and want to analyze their own data but are not specialized in data analysis tools \\(including chemometric tools). In addition, this protocol is also valid for scientists using other mass spectrometry techniques such as CE-MS or mass spectrometry imaging. The required minimum skill level of users is low: only a basic understanding of what kind of information an LC-MS chromatogram provides is necessary. However, skilled chemometricians will also take advantage of the streamlined workflow.\r\n\n\n\r\n\n\n**Experimental** **Design**\r\n\n\n**Biological** **samples**\r\n\n\nThe selected samples for the illustration of the different steps of the protocol were the extracted lipids of a human placental choriocarcinoma \\(JEG-3) cell line, obtained from American Type Culture Collection \\(ATCC HTB-36), after exposure to tributyltin \\(TBT) or to the carrier solvent \\(DMSO) in the case of vehicle controls. Data from lipids of exposed and non-exposed culture cells were acquired using an Acquity UHPLC system \\(Waters, USA) connected to a Time of Flight \\(LCT Premier XE) detector under positive electrospray ionization \\(ESI \\(+)). \r\n\n\nHowever, the protocol described in the present study is versatile and well suited to different kinds of chromatographic \\(_e.g._, UHPLC, HPLC) coupled to mass spectrometric \\(_e.g._, TOF, Orbitrap) data of diverse target molecules \\(_e.g._, metabolites \\(including lipids)) coming from a big range of sample types."
        },
        {
            "header": "Equipment",
            "content": "**Hardware**\r\n\n\n\u2022 Standard-equipped PC or Mac with minimum system requirements to run the software \\(see below) and enough free disk space for saving the results. For optimal viewing of MCR-ALS interface, a screen resolution of 1,920 x 1,200 is recommended. Low-resolution screens can result in cropping of text. MCR-ALS results as text are displayed in the MATLAB Command window, in case they are cropped in low-resolution screens \\(**Table 1**).\r\n\n\n\r\n\n\n**Software** \r\n\n\n\u2022 For data analysis and visualization: MATLAB R2013b \\(The MathWorks Inc., Natick, MA, USA) or newer versions are recommended. However, older versions are also valid.\r\n\n\n\u2022 Statistics Toolbox<sup>TM</sup> for MATLAB and Bioinformatics Toolbox<sup>TM</sup> are required. \r\n\n\n\u2022 Vendor software: Specific vendor software \\(_e.g._, _Waters_/ _Micromass_ _MassLynx_<sup>TM</sup>, _Thermo_ _Fischer_ _Scientific_ _Xcalibur_) are required for initial conversion of raw data formats into open data formats. Otherwise, the external program _ProteoWizard_ can also be employed. However, the data provided by the authors for testing the protocol \\(see \"Supplementary Data\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=d5e1de55b1d9b83b1668fc81e151e2ea) have already been converted and do not require the use of any of these software.\r\n\n\n\u2022 For the TIMING section in the protocol, the following MATLAB version has been used: version 8.2.0 \\(R2013b), Win \\(64 bit). \r\n\n\n\r\n\n\n**Data** **files** **and** **MATLAB** **functions** \r\n\n\n\u2022 **Input** **data**. The following input data files were used in the **ANTICIPATED** **RESULTS** section of the present protocol \\(and are available as \"Supplementary Data\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=d5e1de55b1d9b83b1668fc81e151e2ea): _Control1.mat_, _Control2.mat_, _Control3.mat_, _TBT1.mat_, _TBT2.mat_ and _TBT3.mat_. All of them are MATLAB files obtained after conversion of their initial vendor formats \\(_Waters_) into open data formats \\(_i.e._, _netCDF_ _formats_) using _Databridge_ interface and further import using Bioinformatics Toolbox<sup>TM</sup>. Each file contains three variables in MATLAB workspace: vector _time_, containing information of all retention times, variable _mzCDFStruct_, containing information of the sample and the cell structure _peaks_, cell array providing information of m/z values and corresponding MS intensities measured by the mass spectrometer at each of the scans. Control samples including _Control1.mat_, _Control2.mat_ and _Control3.mat_ \\(1, 2 and 3 indicate replicate number) correspond to LC-MS data of extracted lipids of human placental choriocarcinoma cells \\(JEG-3) 24-h exposed to DMSO. TBT samples including _TBT1.mat_, _TBT2.mat_ and _TBT3.mat_ \\(again 1, 2 and 3 are indicators of the number of replicates), correspond to LC-MS data of extracted lipids of JEG-3 cells 24-h exposed to TBT. **All** **these** **data** **can** **be** **used** **for** **testing** **the** **protocol** **and** **as** **formatting** **guides** **for** **own** **data**.\r\n\n\n\u2022 **MATLAB** **functions**. The following MATLAB functions are provided as \"Supplementary MATLAB functions\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=3adcd456c13cef5c017b66269651912c to test the protocol whether with the provided data or with user\u2019s own data: _ROIpeaks.mat_, _ROIplot.mat_, _MSroiaug.mat_ and _plotprofilestable.mat_. \r\n\n\n\r\n\n\n**\\!** **CAUTION** Folder and file names must contain standard alphanumeric characters only \\(_e.g._, unaccented Latin letters, numbers and underscore). No special characters are allowed. Do not use capitals; only use small letters for file extensions \\(_e.g._, jpg and not .JPG, .txt and not .TXT, .mat and not .MAT and so on), as MATLAB is case-sensitive."
        },
        {
            "header": "Procedure",
            "content": "**PROCEDURE**\r\n\n\n\u2206 **CRITICAL** Many of the steps are prefaced by the term \u201coptional\u201d. This means that technically future steps are not dependent on these having been performed. However, they can provide additional information, or they can alter the outcome of the analysis. \r\n\n\n\r\n\n\n_\\[_**_Steps_** **_from_** **_1_** **_to_** **_13_** **_are_** **_necessary_** **_to_** **_import_** **_data_** **_into_** **_MATLAB_** **_environment_**. **_For_** **_data_** **_already_** **_in_** **_MATLAB_** **_format_** **_including_** \"Supplementary Data\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=d5e1de55b1d9b83b1668fc81e151e2ea **_move_** **_directly_** **_to_** **_Step_** **_14_**_]_\r\n\n\n\r\n\n\n==**== **Data** **conversion** **steps* \r\n\n\nThe following data conversion procedures are described for the distinct LC-MS vendors. In all cases, an external software called _ProteoWizard_ can be used for data conversion \\(**option A**). On the other hand, specific vendor softwares can also be used with the same purpose. In this protocol we show two examples of data conversion using the specific vendor softwares of _Waters_ and _Thermo_ _Fisher_ Corporations \\(**options** **B** and **C**).\r\n\n\n\r\n\n\n\\(**A**) **Waters** **/** **Thermo** **Fisher** **/** **Agilent** **/** **AB** **Sciex** **/** **Bruker** **vendors** **\\(****using** **ProteoWizard** **software****)** \r\n\n\n**1|** Install _Proteowizard_ software as described in the web \\(**proteowizard.sourceforge.net**).\r\n\n\n**2|** Go to MSConvert options, as shown in **Figure** **1**.\r\n\n\n**3|** Click \u00b4Browse\u00b4 and select the source folder of the raw data files \\(.d) to convert. Multiple files can be selected at once, to be converted in batch mode.\r\n\n\n**4|** Click the button \u00b4Add\u00b4.\r\n\n\n**5|** Select the output directory.\r\n\n\n**6|** Select the output format \\(_mzXML_ or _txt_).\r\n\n\n**7|** Click \u00b4Start\u00b4 to begin file conversion. \r\n\n\n \r\n\n\n\\(**B**) **Waters** **Corporation** **\\(****using** **MassLynx** **software****)** \r\n\n\n**1|** Open the _Databridge_ interface of the _MassLynx_ file converter as shown in **Figure 2**.\r\n\n\n**2|** Click \u00b4Select\u00b4 and browse the raw data files \\(.raw) to convert by searching on the directory where it is stored. \r\n\n\n**3|** Click \u00b4Options\u00b4 and specify the source of the raw files \\(_MassLynx_) and the target output format which must be _netCDF_ for _cdf_ files or _ASCII_ for _txt_ files.\r\n\n\n**4|** Indicate the output directory where the new file will be stored and indicate the filename. Although the filename is already prefilled with the same name of the raw data file, it can be changed.\r\n\n\n**5|** Click \u00b4Convert\u00b4 to begin file conversion. A new box will appear indicating the % of completeness of the data conversion process.\r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n\r\n\n\n\\(**C**) **Thermo** **Fisher** **vendor** **\\(****using** **Xcalibur** **software****)** \r\n\n\n**1|** Go to \u00b4Tools > File Converter\u00b4as shown in **Figure 3**.\r\n\n\n**2|** Specify the source data type.\r\n\n\n**3|** Click \u00b4Browse\u00b4 and select the source folder of the raw data files \\(.raw) to convert.  \r\n\n\n**4|** Select the desired files to convert. Multiple files can be selected at once, and all files are selected automatically by clicking on the button \u2018Select All\u2019.\r\n\n\n**5|** Click the button \u00b4Add Job\\(s)\u00b4.\r\n\n\n**6|** Select the destination path and data type, _ANDI_ _Files_ for _cdf_ format or _Text_ _Files_ for the _txt_ format.\r\n\n\n**7|** Click \u00b4Convert\u00b4 to begin file conversion.\r\n\n\n\r\n\n\n==**== **Starting** **and** **Data** **import** **steps** **using** **Bioinformatics** **Toolbox*\nTM\n**8|** Start MATLAB.\r\n\n\n**9|** Navigate to the folder containing converted data files in _cdf_ or _mzXML_ formats, using the \u00b4Current Folder\u00b4 panel in MATLAB. \r\n\n\n**10|** Run the function _InfoStruct_= _mzcdfinfo_ \\(_File_) or _InfoStruct_= _mzxmlinfo_ \\(_File_) in the \u2018Command Window\u2019 panel in MATLAB. _InfoStruct_ variable will appear in the workspace.\r\n\n\n_mzcdfinfo_ and _mzxmlinfo_ functions extract the information of the _netCDF_ or _mzXML_ files, respectively, returning a MATLAB structure, named _InfoStruct_. \r\n\n\n**11|** \\(Optional) Before going forward with the remaining procedure, have a look at the _InfoStruct_ variable generated.\r\n\n\n_InfoStruct_ variable contains the following fields: Filename \\(name of the file), FileTimeStamp \\(date time stamp of the file), FileSize \\(size of the file in bytes), NumberOfScans \\(number of scans in the file), StartTime \\(run start time), EndTime \\(run end time), TimeUnits \\(units for time), GlobalMassMin \\(minimum m/z value in all scans), GlobalMassMax \\(maximum m/z value in all scans), GlobalIntensityMin \\(minimum intensity value in all scans), GlobalIntensityMax \\(maximum intensity value in all scans) and ExperimentType \\(indicates if data is raw or centroided).\r\n\n\n**12|** Run the function _mzCDFStruct_= _mzcdfread_ \\(_File_) or _mzXMLStruct_= _mzxmlread_ \\(_File_) in the \u00b4Command Window\u00b4 panel in MATLAB. _mzCDFStruct_ or _mzXMLStruct_ variables will appear in the workspace.\r\n\n\n_mzcdfread_ and _mzxmlread_ functions read MS data from the _netCDF_ or _mzXML_ files and give as an output argument a MATLAB structure \\(_i.e._, _mzCDFStruct_ or _mzXMLStruct_) containing information of the LC-MS data.\r\n\n\n**13|** Run the function \\[_Peaks_, _Time_]= mzcdf2peaks \\(_mzCDFStruct_) or \\[_Peaks_, _Time_]= mzxml2peaks \\(_mzXMLStruct_) in the \u2018Command Window\u2019 panel in MATLAB. A cell array named _peaks_ and a vector named _time_ will appear in MATLAB workspace.\r\n\n\nThese functions extract peak information from the MATLAB structures _mzCDFStruct_ or _mzXMLStruct_ created by _mzcdfread_ or _mzxmlread_ functions, respectively. The cell array named _peaks_ contains mass/charge \\(m/z) and ion intensity values at each of the scans and the vector _time_ gives information of the retention times associated with the LC-MS data set. \r\n\n\n\u2206 **CRITICAL** **STEP** LC-MS data must be in _netCDF_ or _mzXML_ formats for their import. No other formats are accepted. Other file types need to be re-formatted \\(go back to **Step** **1**) to match the input file requirements of Bioinformatics Toolbox\nTM\ndata import tools.\r\n\n\n\r\n\n\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \r\n\n\n_\\[_ _The_ **_following_** **_steps_** **_can_** **_be_** **_directly_** **_applied_** **_to_** **_the_** \"Supplementary Data\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=d5e1de55b1d9b83b1668fc81e151e2ea **_provided_** **_with_** **_the_** **_present_** **_study_**. **_If_** **_used_** **_with_** **_new_** **_data_**, **_it_** **_must_** **_be_** **_imported_** **_to_** **_MATLAB_** **_obeying_** **_the_** **_steps_** **_previously_** **_explained_** \\(**_Steps_** **_1_** **_to_** **_13_**). **_However_**, **_for_** **_a_** **_better_** **_understanding_** **_of_** **_the_** **_protocol_** **_the_** **_authors_** **_recommend_** **_to_** **_perform_** **_a_** **_first_** **_trial_** **_of_** **_ROI_** **_functions_** **_on_** **_the_** **_prepared_** \"Supplementary Data\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=d5e1de55b1d9b83b1668fc81e151e2ea _]_\r\n\n\n\r\n\n\n==**== **Data** **compression** **steps** **using** **ROI** **search* \r\n\n\n**14|** Download the ROI package provided as \"Supplementary MATLAB functions\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=3adcd456c13cef5c017b66269651912c \\(containing _ROIpeaks_, _ROIplot_, _MSroiaug_ and _plotprofilestable_ functions) and save it in a folder.\r\n\n\n**15|** Go to \u00b4Set path\u00b4 panel and add this folder to MATLAB search path.  \r\n\n\n**16|** Run the _ROIpeaks_ function  \\[_mzroi_, _MSroi_, _roicell_]= _ROIpeaks_ \\(_peaks_, _snthresh_, _mzerror_, _minroi_, _nrows_, _time_) in the \u00b4Command Window\u00b4 panel in MATLAB to search ROIs in the first sample. \r\n\n\n_ROIpeaks_ function allows building an MS data matrix from variable _peaks_ by selecting only the regions of interest. The implementation of this function requires the input of two variables containing information of the sample, _peaks_ and _time_, together with the following parameters: _snthresh_ \\(chromatographic signal-to-noise threshold, commonly between 0.1-1% maximum MS intensity, used to filter significative MS intensities), _mzerror_ \\(admissible mass deviation, typically set to a generous multiple of the mass accuracy of the mass spectrometer, _e.g._, 0.05 Da/e), _minroi_ \\(minimum number of retention times to be considered in a ROI, normally between 5 and 12 seconds in UHPLC systems and between 20 and 50 seconds in HPLC systems) and _nrows_ \\(number of cells/rows/spectra of the variable _peaks_ desired to be processed). The output parameters of _ROIpeaks_ function are _MSroi_ \\(newly arranged matrix of dimensions \\(_num.of.scans_ \\(m) x _nROI_), containing the MS spectra of every scan in its rows, and the chromatograms of every ROI in its columns), _mzroi_ \\(vector containing final m/z values of all ROIs, calculated as the mean of all m/z classified within the same ROI), and _roicell_ \\(cell array \\{nROI x 5}, containing nROI x 5 cells, providing information of m/z values \\(1), retention times \\(2), intensities \\(3), scan numbers \\(4) and mean m/z values of ROIs \\(5)).\r\n\n\nWhen the process is finished a message indicating final number of ROIs and elapsed time will be displayed on the \u2018Command Window\u2019 screen. Variables _MSroi_, _mzroi_ and _roicell_ will appear in the workspace and two plots, one displaying _MSroi_ respect to time and the other displaying the sum of _MSroi_ respect to _mzroi_ values will be automatically generated \\(see **Figure** **4** and \"Supplementary Results 1\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=42939f3699604260e6cb0eac82b3a69a). \r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n **17|** Run the function _ROIplot_ \\(_roicell_\\(_n_)) in the \u2018Command Window\u2019.\r\n\n\n_ROIplot_ function allows the evaluation of the ROI previously obtained, to avoid having multiple or halving peaks. The input variable of this function is the previously obtained _roicell_ and the graphical output representations correspond to the chromatographic shapes of the obtained ROIs as well as the distribution of the distinct m/z values defining the same ROI \\(see **Figure** **5**, where these plots are shown for a particular ROI). In this function, _n_ specifies the particular ROI for which the results are shown. If no _n_ is specified, results will be shown for all ROI values. \r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n\u2206 **CRITICAL** **STEP** Selecting the correct values for parameters _snthresh_, _mzerror_ and _minroi_ determines the outcome of the ROI search. Different values of parameters should be tested to see whether the elution profiles of the obtained ROI are meaningful or not. In the case of uncertainties, consult a mass spectrometry expert to avoid misinterpretation of the results.\r\n\n\n**18|** Modify the values of input parameters, if necessary, and repeat the ROI search described in **Step** **16** using the new values. Repeat this step the number of times required to obtain ROIs that fit original MS data.\r\n\n\n**19|** \\(Optional) Change the name of the output variables in the workspace by right-clicking on them and selecting \u00b4rename\u00b4 in the opening context-sensitive menu, to a name which makes reference to the sample group and number of replicate \\(_i.e._, _MSroiC1_ indicating that this variable corresponds to compressed data of the first replicate of a control sample). \r\n\n\n**20|** \\(Optional) Save all the variables generated in the workspace, using \u2018Save workspace\u2019 button. Suggestions for filename and folder are prefilled in the opening save dialog boxes, but they can be changed. It is highly recommendable to select a name indicating the sample and the type of ROI information that it contains \\(_e.g._, _ROIC1_, indicating that the .mat file provides information of individual ROI search of Control 1 sample).\r\n\n\n\u2206 **CRITICAL** **STEP** Only alphanumeric filenames \\(_i.e._, only unaccented Latin letters and numbers and underscore are allowed; special characters are not accepted). It is also important to have filenames that are representative for the sample. \r\n\n\n**21|** \\(Optional) Save also the generated plots using their respective \u00b4File/Save as\u2026\u00b4 buttons, located above of each plot. A save dialog opens, with prefilled values for filename, format and location, which can be changed.\r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n**22|** Close figure windows individually.\r\n\n\n\\! **CAUTION** Unsaved plots cannot be recovered after closing their respective windows.\r\n\n\n**23|** Type \u00b4clear all\u00b4at the MATLAB Command Window prompt to clear the MATLAB workspace and memory from all variables.\r\n\n\n\\! **CAUTION** Unsaved data cannot be recovered after this step.\r\n\n\n**24|** Type \u00b4clc\u00b4 at the MATLAB Command Window prompt to clear the Command Window.\r\n\n\n**25|** For data conversion and import of a new sample return to **Step** **1**. For data compression of a new sample return to **Step** **16**. \r\n\n\n\r\n\n\n==**== **Steps** **to** **generate** **augmented** **data** **matrices* \r\n\n\n**26|** Navigate to the folder containing the .mat files generated in the ROI search of individual data matrices \\(**Step 16**), using the \u00b4Current Folder\u00b4 panel in MATLAB.\r\n\n\n\u2206 **CRITICAL** **STEP** Search of ROI among samples and generation of augmented data matrices is only possible when previous ROI search of individual data matrices has been performed.\r\n\n\n**27|** Double-click on two .mat files of two distinct samples \\(_e.g._, _ROIC1.mat_ and _ROIC2.mat_) to load them into MATLAB workspace. The loaded .mat files contain the variables _MSroiC1_, _MSroiC2_, _mzroiC1_, _mzroiC2_, _Time1_ and _Time2_ \\(see \"Supplementary Results 1\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=806edb3f3ace424a596e773bcdd5c734) necessary for the ROI search among the two samples.\r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n**28|** Run the command \\[_Msroiaug_, _mzroiaug_, _timeaug_]= _Msroiaug_ \\(_MsroiC1_, _MsroiC2_, _mzroiC1_, _mzroiC2_, _mzerror_, _thresh_, _TimeC1_, _TimeC2_) in the \u00b4Command Window\u00b4 panel in MATLAB. A pairwise search of ROI among samples Control 1 and Control 2 is being performed, evaluating common and uncommon ROI values and finally considering both of them. At the end of this search, three new variables are generated in the workspace: _MSroiaug_, _mzroiaug_ and _timeaug_ and the same plots described in **Step** **16** are again generated \\(see \"Supplementary Results 2\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=806edb3f3ace424a596e773bcdd5c734). In this search, the parameter _mzerror_ is used to define the admissible mass difference between two _mzroi_ values to be considered the same \\(\u00b1 _mzerror_/2).\r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n**\\!** **CAUTION** The two input _MSroi_ matrices must have the same rt-mode dimensions to enable the search.     \r\n\n\n**29|** \\(Optional) Change the name of the output variables in the workspace by right-clicking on them and selecting \u00b4rename\u00b4 in the opening context-sensitive menu, to a name which makes reference to the sample group and number of replicate \\(_e.g._, _MSroiaugC1C2_ indicating that the ROI search has been conducted among Control 1 and Control 2 samples). \r\n\n\n**30|** \\(Optional) Save all the variables generated in the workspace, using \u2018Save workspace\u2019 button. Suggestions for filename and folder are prefilled in the opening save dialog boxes, but they can be changed. It is highly recommendable to select a name indicating the sample and the type of ROI information that it contains \\(_e.g._, _ROIC1C2.mat_ , indicating that the .mat file contains information of ROI search among Control 1 and Control 2 samples).\r\n\n\n**31|** \\(Optional) Save also the generated plots using their respective \u00b4File/Save as\u2026\u00b4 buttons, located above of each plot. A save dialog opens, with prefilled values for filename, format and location, which can be changed.\r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n**32|** Close figure windows individually.\r\n\n\n**\\!** **CAUTION** Unsaved plots cannot be recovered after closing their respective windows.\r\n\n\n**33|** \\(Optional) Remove all variables containing information of ROI search of individual data matrices in the workspace \\(_e.g._, _MsroiC1_ , _MsroiC2_ and so on) by right-clicking on the file and selecting \u00b4delete\u00b4 in the open context-sensitive menu.\r\n\n\n**34|** Load the .mat file containing information of the individual ROI search of a third sample classified as a control \\(_e.g._, _ROIC3.mat_) by double-clicking on it.\r\n\n\n**35|** Run the command \\[_Msroiaug_, _mzroiaug_, _timeaug_]= _MSroiaug_ \\( _MSroiaugC1C2_, _MSroiC3_, _mzroiaugC1C2_, _mzroiC3_, _mzerror_, _thresh_, _timeaugC1C2_, _timeC3_)\u00b4 in the \u00b4Command Window\u00b4 panel in MATLAB. A pairwise search of ROI among the previous generated _MSroiaugC1C2_ matrix and the new _MSroiC3_ matrix is being performed. At the end of this search, three new variables are generated in the workspace: _MSroiaug_ , _mzroiaug_ and _timeaug_  and the same plots described in **Step** **16** are again generated but for the augmented case \\(see **Figure** **6a**). \r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n**36|** \\(Optional) Change the name of the output variables in the workspace by right-clicking on them and selecting \u00b4rename\u00b4 in the opening context-sensitive menu, to a name which makes reference to the sample group and number of replicate \\(_e.g._, _MSroiaugC1C2C3_ indicating ROI search has been conducted among Control 1, Control 2 and Control 3 samples). \r\n\n\n**37|** \\(Optional) Save all the variables generated in the workspace, using \u2018Save workspace\u2019 button. Suggestions for filename and folder are prefilled in the opening save dialog boxes, but they can be changed. It is highly recommendable to select a name indicating the sample and the type of ROI information that it contains \\(_e.g._, _ROIC1C2C3.mat_, indicating that the .mat file contains information of ROI search among Control 1, Control 2 and Control 3 samples).\r\n\n\n**38|** \\(Optional) Save also the generated plots using their respective \u00b4File/Save as\u2026\u00b4 buttons, located above of each plot. A save dialog opens, with prefilled values for filename, format and location, which can be changed.\r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n**39|** Close figure windows individually.\r\n\n\n**\\!** **CAUTION** Unsaved plots cannot be recovered after closing their respective windows.\r\n\n\n**40|** Type \u00b4clear all\u00b4at the MATLAB Command Window prompt to clear the MATLAB workspace and memory from all variables.\r\n\n\n**\\!** **CAUTION** Unsaved data cannot be recovered after this step.\r\n\n\n**41|** Type \u00b4clc\u00b4 at the MATLAB Command Window prompt to clear the Command Window.\r\n\n\n**42|** Repeat **Steps** **26** to **41** to find ROI values among other samples classified as another group \\(_e.g._, samples _TBT1_ , _TBT2_ and _TBT3_ ) to obtain information of common and uncommon ROI of the three stressed samples \\(_e.g._, _ROIT1T2T3_). The plots obtained will be analogue to the ones represented in **Figure** **6** but for the TBT-exposed samples in this case.\r\n\n\n**43|** Repeat **Steps** **33** to **39** with ROI values obtained independently for controls and stressed samples \\(_e.g._, _ROIC1C2C3_ and _ROIT1T2T3_) to find ROI values among the two groups of samples. Final obtained _MSroiaug_ matrix \\(_MSroiaugC1C2C3T1T2T3_) is the column-wise compressed data matrix ready for the MCR-ALS analysis. The graphical outputs of the ROI search among the six samples are represented in **Figure** **6b**.\r\n\n\n**44|** Clear all variables individually in the workspace, by right-clicking on the file and selecting \u00b4delete\u00b4 in the open context-sensitive menu, except final _MSroiaugC1C2C3T1T2T3_ matrix and vectors _timeaugC1C2C3T1T2T3_ and _mzroiaugC1C2C3T1T2T3_, which should be saved.\r\n\n\n\r\n\n\n==**== **Data** **analysis** **steps** **for** **MCR-ALS** **method* \r\n\n\n**45|** Download the freely available \"MCR-ALS GUI 2.0\":http://www.mcrals.info and save it in a folder. In this web page information of MCR-ALS code, related tutorials and data sets for practicing can be found.\r\n\n\n**\\!** **CAUTION** Although distinct programs can be downloaded from this webpage \\(MCR-ALS GUI 2.0, MCR-ALS Toolbox 1.0, MCR-ALS command line, MCR-ALS GUI and MCR-Bands), the newest version \\(MCR-ALS GUI 2.0) is the one used in this protocol. \r\n\n\n**\\!** **CAUTION** For requirements regarding software description together with information of new features and applications of the latest version, please refer to another study\n9\n. \r\n\n\n**46|** Go to \u00b4Set path\u00b4 panel and add this folder to MATLAB search path.  \r\n\n\n**47|** Type \u00b4mcr_main\u00b4 at the MATLAB Command Window prompt to call the necessary auxiliary routines for the MCR-ALS analysis. The main window of MCR-ALS Toolbox is launched immediately \\(see **Figure** **7**).\r\n\n\n**48|** Select the data for MCR-ALS analysis by clicking on the \u00b4Select a data matrix\u00b4 drop-down button \\(_e.g._, _MSroiaugC1C2C3T1T2T3_ , provided in the \"Supplementary Results 2\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=806edb3f3ace424a596e773bcdd5c734). A new variable named \u00b4mcr_str\u00b4 is generated in the workspace.\r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n**49|** Select the number of components of the initial estimation by clicking one of these buttons: \u00b4Manual\u00b4 or \u00b4SVD\u00b4. \u00b4Manual\u00b4 button is used when prior knowledge about the correct number of components is available and \u00b4SVD\u00b4 button is used when this estimate is performed considering the number of largest singular values obtained by the Singular Value Decomposition algorithm. In this case, the more appropriate option is the initial estimation through \u00b4SVD\u00b4.\r\n\n\n**50|** Click in \u00b4SVD\u00b4 button and select the number of components following one of these two options. The first is to use the drop-down menu of Eigenvalues, listed in ascending order of component number \\(lower Eigenvalue for higher component number). The text box below automatically updates to show the selected number of components in red. The second option is to type the number of components into the text box with the same name and hit enter. The drop-down menu above automatically updates to show the corresponding singular value. \r\n\n\n**\\!** **CAUTION** When having data matrices with one of the dimensions large \\(\u02c3 10000 elements), calculation of only few singular values is recommended to avoid computer memory problems. \r\n\n\n\\(Optional) For a proper choice of the number of components you can zoom in the \u00b4EigenValues\u00b4 Representation and inspect when the rate of the decline between two consecutive values is much lower than for the previous pair of smaller eigenvalues. \r\n\n\nAfter selecting the number of components, the \u00b4EigenValues\u00b4 representation remains unchanged but the \u00b4EigenVectors\u00b4 representation automatically shows the selected number of components for each of the individual matrices conforming the column-wise augmented data matrix \\(in this example case, the number of matrices is 6). \r\n\n\n\u2206 **CRITICAL** **STEP** Selecting the correct number of components finally determines the outcome of the analysis. Distinct numbers of components should be tested and the results should be evaluated to see which gives the best result in terms of data fitting and chemistry and biology.\r\n\n\n**\\!** **CAUTION** In an MCR-ALS analysis, adding a new component is not an additive process. In other words, it does not leave the original components intact, but it recalculates all components \\(see INTRODUCTION). \r\n\n\n**51|** \\(Optional) Copy the box showing the number of components selected in the initial estimation by clicking the button \u00b4Copy\u00b4.\r\n\n\n**52|** Click \u00b4OK\u00b4 button to return to the main screen of MCR-ALS program.\r\n\n\n**53|** Start the initial estimation of one of the two factor matrices \\(**C** for concentrations or **S**\nT\nfor spectra) by selecting one of these three options: \u00b4Manual\u00b4, if they are already available, \u00b4Pure\u00b4 for determining initial estimates either of **C** or **S**\nT\nby means of a purest variable detection method, or \u201cEFA\u201d by means of Evolving Factor Analysis\n10\n, only suitable for the case of analyzing evolving processes. In this example, pure estimates will be used, which is calculated using a purest variable selection method \\(like in the SIMPLISMA method\n11\n).\r\n\n\n**54|** Click in \u00b4Pure\u00b4 button and select the direction of the variable selection \\(either concentrations or spectra) by using the drop-down menu of the \u00b4Pure variable detection method\u00b4 box. \r\n\n\n**55|** \\(Optional) Change the noise allowed \\(in percentage) for the calculation of initial estimates in the text box labeled \u00b4Noise allowed \\(%)\u00b4 and hit enter. Although the default value of 1% is generally safe, different values can be tested and their effect evaluated in the \u00b4Pure Spectra Estimation \\(Initial Values)\u00b4 plot. In this example, 10% of noise will be used to avoid selection of noisy variables.\r\n\n\n**56|** Click \u00b4Do\u00b4 button and examine the obtained \u00b4Purest variables\u00b4 representation to see whether chromatographic/spectra profiles are reasonable or not \\(_e.g._, whether they contain only noise or they are very similar to each other \\(can indicate that too many components were selected), whether they show every band in the spectra with equal weight \\(can indicate too few components selected), or whether they contain artifacts \\(can indicate improper pre-processing)).\r\n\n\nThe list of purest variables is immediately shown in a box emplaced in the left.\r\n\n\n\u2206 **CRITICAL** **STEP** It is important to see whether the pure spectral estimates are meaningful or not, as this can help in selecting the correct number of components. If the addition of a new component \\(**Step** **50**) does not result in a significantly different new spectral estimate, it is likely that the new component is not required and will not be well resolved.\r\n\n\n**57|** Click \u00b4OK\u00b4 button to return to the main screen of MCR-ALS program.\r\n\n\n**58|** Initiate the optimization process by clicking \u00b4Continue\u00b4 button, at the bottom of the main interface box. A summary screen in which the top plots represent the row and column profiles of the experimental data, the middle plots show the initial estimate and the **C** and **S**\nT\nprofiles obtained by a least-squares step and the bottom plots represent the score and loading plots obtained by PCA of the analyzed data matrix **D** with the previously selected number of components will appear \\(see **Figure** **8**). \r\n\n\n**59|** Modify the number of matrices simultaneously analyzed by writing the number in a text box above the plots. In this example, this number is \u201c6\u201d.\r\n\n\n**\\!** **CAUTION** The default value for the number of matrices is \u201c1\u201d since default conditions are established for a single data matrix analysis.\r\n\n\n**60|** Click \u00b4Continue\u00b4 button to proceed with the definition of the data set.\r\n\n\n**61|** In the \u00b4Definition of the data set\u00b4 window, define the type of multiset data structure by selecting the correct option in the drop-down menu: column-wise augmented data matrix \\(**C** direction), row-wise augmented data matrix \\(**S** direction) or column- and row-wise augmented data matrix \\(**C** **&** **S** directions). In this example, the \u00b4column-wise augmented data matrix\u00b4 is selected, with 6 submatrices all having the same number of rows \\(see **Figure** **9**).\r\n\n\n**62|** Click \u00b4OK\u00b4 button to proceed with the selection of constraints for ALS optimization. \r\n\n\nIn this new version of the interface, there are two differentiated screens for the choice of constraints, one for  the profiles linked to the row mode \\(_i.e._ concentration profiles, **C** matrix) and another for the profiles related to the column mode \\(_e.g._., spectral profiles, **S**\nT\nmatrix).\r\n\n\n**63|** In the \u00b4Constraints: row mode \\(concentrations and multiple experiments)\u00b4 window indicate whether the same constraints will be applied to all **C** submatrices or not \\(see **Figure** **10a**). \r\n\n\nAt the top of the screen, a panel regarding the multiset data structure is presented. It contains the total number of **C** submatrices included in the augmented data set, an option to apply the same constraints to all **C** submatrices, or the possibility to change the constraints according to the different **C** submatrices. Finally, at the right corner, the possibility to apply the constraint of correspondence among species by selecting which components are present in every considered **C** submatrix is offered. In this case, the same constraints will be applied to all **C** submatrices.\r\n\n\n**\\!** **CAUTION** In the selection of row constraints for augmented data matrices is not allowed the possibility to deal with multiple and different constraints for every analyzed **C** submatrix.\r\n\n\n**64|** Select the constraints among the four common options \\(non-negativity, unimodality, closure and equality constraints) and more advanced constraints \\(such as correlation or kinetic hard-modeling). In the present example, only non-negativity constraints are applied when selecting the option \u00b4forced to zero\u00b4 in the drop-down menu. \r\n\n\n\u2206 **CRITICAL** **STEP** The implementation of non-negativity constraints through the \u00b4forced to zero\u00b4 option is recommended to speed up the calculation.\r\n\n\n**65|** Click \u00b4Continue\u00b4 button to proceed with the selection of constraints of **S**\nT\nmatrix.\r\n\n\n**66|** In the \u00b4Constraints: column mode \\(spectra and single technique)\u00b4 window select the constraints for **S**\nT\nmatrix among the four common options: non-negativity, unimodality, closure and equality constraints \\(see **Figure** **10b**). In this example, non-negativity constraints through \u00b4forced to zero\u00b4 option are implemented.\r\n\n\n**67|** Click \u00b4Continue\u00b4 button.\r\n\n\n**\\!** **CAUTION** When no closure is selected \\(_e.g._, no mass balance in concentrations) constraints, a new window appears to offer the possibility of normalizing the resolved spectra profiles \\(_e.g._, normalizing them to have equal height, total sum norm or Euclidean norm) prior to starting ALS optimization. This is recommended to avoid scale instabilities during the evolution of the ALS optimization and it fixes the possible intensity ambiguities. In this example, \u00b4spectra equal height\u00b4 was selected.\r\n\n\n**68|** Select general optimization parameters \\(_e.g._, the number of iterations or convergence criterion) and the name of output variables in the \u00b4Parameters/Output of ALS optimization\u00b4 screen \\(see **Figure** **11**). In this case, a total of 50 iterations are selected \\(default value) and the convergence criterion is set to 1%. \r\n\n\n**69|** Select the box to enable the graphical output of the results and click \u00b4Continue\u00b4 button. Suggestions for a variable name for concentrations and spectra matrices resulting from MCR-ALS analysis are _copt_ and _sopt_, respectively.\r\n\n\n**70|** Evaluate the results shown in \u00b4ALS optimization\u00b4 screen including information about the convergence, lack of fit and explained variance \\(see **Figure** **12**). \r\n\n\n**71|** \\(Optional) Click \u00b4Information\u00b4 button to obtain more detailed information about the evolution of the ALS optimization \\(_e.g._, plots of explained variance, lack of fit, logarithm of the sum of squares residuals and evolution of concentration/spectra profiles). \r\n\n\n**72|** \\(Optional) Save all the variables generated in the workspace \\(see \"Supplementary Results 3\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=806edb3f3ace424a596e773bcdd5c734), using \u2018Save Workspace\u2019 button. Suggestions for filename and folder are prefilled in the opening save dialog boxes, but they can be changed. \r\n\n\n**73|** \\(Optional) Save also the generated plots using their respective \u00b4File/Save as\u2026\u00b4 buttons, located above of each plot. A save dialog opens, with prefilled values for filename, format and location, which can be changed.\r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n**74|** Close figure windows individually.\r\n\n\n**\\!** **CAUTION** Unsaved plots cannot be recovered after closing their respective windows.\r\n\n\n**75|** Clear all MATLAB variables in the workspace, by right-clicking on the file and selecting \u00b4delete\u00b4 in the open context-sensitive menu, except from variables _MSroiaugC1C2C3T1T2T3_ , _timeaugC1C2C3T1T2T3_ , _copt_ , _sopt_ and vector _mzroiaugC1C2C3T1T2T3_ .\r\n\n\n**\\!** **CAUTION** Unsaved data cannot be recovered after this step.\r\n\n\n**76|** \\(Optional) Rename those variables using shorter names \\(_e.g._, _x_ , _time_ ,  _c_ ,  _s_  and  _mz_  instead of  _MSroiaugC1C2C3T1T2T3_ ,  _timeaugC1C2C3T1T2T3_ , _copt_ ,  _sopt_ and vector _mzroiaugC1C2C3T1T2T3_, respectively).\r\n\n\n**77|** Type \u00b4clc\u00b4 at the MATLAB Command Window prompt to clear the Command Window.\r\n\n\n\r\n\n\n==**== **Steps** **to** **evaluate** **concentration** **and** **spectral** **profiles** **of** **MCR-ALS** **components* \r\n\n\n**78|** Create two new variables in the workspace named as _nexp_ and _ncontrol_ containing information about the number of experiments and the number of controls of the data sets \\(in this case, _nexp_=6 and _ncontrol_=3) by typing _nexp_=6 and _ncontrol_=3 in the \u00b4Command Window\u00b4 prompt.\r\n\n\n**79|** Run the command \\[_area_, _height_, _table_, _table2_]=  _plotprofilestable_ \\(_x_, _c_, _s_, _time_, _mz_, _nexp_, _ncontrol_) in the \u00b4Command Window\u00b4 panel in MATLAB. Two graphical outputs will be obtained for the first component. In addition, the results of the corresponding statistical evaluation will appear in the MATLAB Command Window followed by the message: \u201cselect forward backward plot 1/0\u201d. In order to proceed with the evaluation of next MCR-ALS component introduce \u201c1\u201d in the Command Window, otherwise write \u201c0\u201d.\r\n\n\n**\\!** **CAUTION** If Step 76 was skipped, the input variable names of this function must be changed to those used to define the corresponding MATLAB variables.\r\n\n\n**80|** \\(Optional) Save the two generated figures, resulting from the analysis of the first component \\(see **Figures** **13a** and **13b**), using their respective \u00b4File/Save as\u2026\u00b4 buttons, located above of each plot. A save dialog opens, with prefilled values for filename, format and location, which can be changed.\r\n\n\n**?** **TROUBLESHOOTING**\r\n\n\n**81|** Close figure windows individually.\r\n\n\n**\\!** **CAUTION** Unsaved plots cannot be recovered after closing their respective windows.\r\n\n\n**82|** \\(Optional) Copy the information provided in the \u00b4Command Window\u00b4 panel \\(_lof_, _fit_, _Rsquare_, etc) and paste it in another document to further save it \\(see **Figure** **13c**). \r\n\n\n**83|** Click to any button to obtain the same plots and results for the next component.\r\n\n\n**84|** Repeat **Steps** **80** to **83** until the last component.\r\n\n\n**85|** Once obtained the results for all components click once more any key of the computer keyboard. Statistic results when considering all components simultaneously will be presented in the \u00b4Command Window\u00b4 panel \\(see **Figure** **13d**).\r\n\n\n**86|** \\(Optional) Copy the information provided in the \u00b4Command Window\u00b4 panel \\(_lof_, _fit_, _Rsquare_) and paste it in another document to further save it. \r\n\n\n**87|** Click again any key to obtain in the workspace the two tables containing statistical information \\(Table and Table2).\r\n\n\n**88|** Click \u00b4Save workspace\u00b4 button of the upper panel of MATLAB to save all variables contained in the Workspace. Suggestions for filename and folder are prefilled in the opening save dialog boxes, but they can be changed. It is highly recommendable to select a name indicator of samples and type analysis \\(_e.g._, _MCR-ALS.mat_, indicating that the .mat file contains information of the MCR-ALS analysis.\r\n\n\n**89|** Type \u00b4clear all\u00b4at the MATLAB Command Window prompt to clear the MATLAB workspace and memory from all variables.\r\n\n\n**\\!** **CAUTION** Unsaved data cannot be recovered after this step.\r\n\n\n**90|** Type \u00b4clc\u00b4 at the MATLAB Command Window prompt to clear the Command Window."
        },
        {
            "header": "Timing",
            "content": "The timing required for the distinct steps of LC-MS data analysis described in the **PROCEDURE** section is variable but is usually between 2 and 4 min per sample for data compression and import, about 2 min for data compression following a ROI search and between 5 and 10 min per sample for the MCR-ALS analysis."
        },
        {
            "header": "Troubleshooting",
            "content": "Troubleshooting advice can be found in **Table** **1**."
        },
        {
            "header": "Anticipated Results",
            "content": "Although the data used as example in the present protocol was also used in a previous study by the authors<sup>6</sup>, the results hereby presented were not included in the original publication and are specifically selected now in order to demonstrate the key features of the present protocol. These results include data compression through ROI search of individual data matrices \\(see \"Supplementary Results 1\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=806edb3f3ace424a596e773bcdd5c734), data matrix augmentation through ROI search among data matrices \\(see \"Supplementary Results 2\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=806edb3f3ace424a596e773bcdd5c734) and MCR-ALS analysis of the obtained MSroi augmented matrix \\(see \"Supplementary Results 3\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=806edb3f3ace424a596e773bcdd5c734). \r\n\n\nThe utilized data to obtain all these results are provided as \"Supplementary Data\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=d5e1de55b1d9b83b1668fc81e151e2ea and the functions used are supplied as \"Supplementary MATLAB functions\":http://cidtransfer.cid.csic.es/descarga.php?enlace1=3adcd456c13cef5c017b66269651912c."
        },
        {
            "header": "References",
            "content": "**1**. Tautenhahn, R., B\u00f6ttcher, C., Neumann, S. Highly sensitive feature detection for high resolution LC-MS. _BMC_ _Bioinf_. 9, 504 \\(2008).\r\n\n\n**2**. Stolt, R., Torgrip, R., Lindberg, J, Csenki, L., Kolmert, J., Schuppe-Koistinen I., Jacobsson, S. Second-Order Peak Detection for Multicomponent High-Resolution LC-MS Data. _Anal_. _Chem_. 78: 975-983 \\(2006). \r\n\n\n**3**. Tikunov, Y., Lommen, A., Vos, Cd., Verhoeven, H., Bino, R., Hall, R., Bovy, A. A novel approach for nontargeted data analysis for metabolomics. Large-scale profiling of tomato fruit volatiles. _Plant_. _Physiol_. 139\\(3): 1125-37 \\(2005).\r\n\n\n**4**. Smith, C., Want, E., O\u2019Maille, G., Abagyan, R., Siuzdak, G. XCMS: Processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching and identification. _Anal_. _Chem_. 78: 779-787 \\(2006). \r\n\n\n**5**. Katajamaa, M., Oresic, M. Processing methods for differential analysis of LC-MS profile data. _BMC_ _Bioinf_. 6: 179 \\(2005). \r\n\n\n**6**. Gorrochategui, E., Casas, J., Porte, C., Lacorte, S., Tauler, R. Chemometric strategy for untarget lipidomics: biomarker detection and identification in stressed human placental cells. _Anal_. _Chim_. _Acta_. 854: 20-33 \\(2015). \r\n\n\n**7**. Farr\u00e9s, M., Pi\u00f1a, B., Tauler, R. Chemometric evaluation of Saccharomyces cerevisiae metabolic profiles using LC-MS. _Metabolomics_ 11: 210-224 \\(2015).\r\n\n\n**8**. Tauler, R. Multivariate curve resolution applied to second order data. _Chemom_. _Intell_. _Lab_. _Syst_. 30: 133-146 \\(1995).\r\n\n\n**9**. Jaumot, J., De Juan, A., Tauler, R. MCR-ALS GUI 2.0: New features and applications. _Chemometr_._ Intell_._ Lab_. _Syst_. 140: 1-12 \\(2015).\r\n\n\n**10**.  Maeder, M. Evolving factor analysis for the resolution of overlapping chromatographic peaks. _Anal_. _Chem_. 59: 527-530 \\(1987).\r\n\n\n**11**.  Bu, D., Brown, C.W. Self-modeling mixture analysis by interactive principal component analysis. _Appl_. _Spectrosc_. 54:1214\u20131221 \\(2000)."
        },
        {
            "header": "Acknowledgements",
            "content": "The research leading to these results has received funding from the **European** **Research** **Council** under the European Union's Seventh Framework Programme \\(FP/2007-2013) / **ERC** **Grant** **Agreement** **n**. **320737**. First author acknowledges the Spanish Government \\(Ministerio de Educaci\u00f3n, Cultura y Deporte) for a predoctoral FPU scholarship."
        }
    ],
    "attributes": {
        "acceptedTermsAndConditions": true,
        "allowDirectSubmit": true,
        "archivedVersions": [],
        "articleType": "Method Article",
        "associatedPublications": [
            {
                "doi": "10.1016/j.aca.2014.11.010",
                "date": "2015-10-16 09:49:40",
                "title": "Chemometric strategy for untargeted lipidomics: Biomarker detection and identification in stressed human placental cells",
                "authors": [
                    "Eva Gorrochategui",
                    "Josefina Casas",
                    "Cinta Porte",
                    "S\u00edlvia Lacorte",
                    "and Rom\u00e0 Tauler"
                ],
                "journal": "Analytica Chimica Acta ",
                "logo": ""
            },
            {
                "doi": "10.1007/s00216-015-9042-2",
                "date": "2015-10-16 09:53:26",
                "title": "Evaluation of changes induced in rice metabolome by Cd and Cu exposure using LC-MS with XCMS and MCR-ALS data analysis strategies",
                "authors": [
                    "Meritxell Navarro-Reig",
                    "Joaquim Jaumot",
                    "Alejandro Garc\u00eda-Reiriz",
                    "and Rom\u00e0 Tauler"
                ],
                "journal": "Analytical And Bioanalytical Chemistry",
                "logo": ""
            },
            {
                "doi": "10.1007/s11306-014-0689-z",
                "date": "2015-10-16 09:55:12",
                "title": "Chemometric evaluation of Saccharomyces cerevisiae metabolic profiles using LC\u2013MS",
                "authors": [
                    "Mireia Farr\u00e9s",
                    "Benjam\u00ed Pi\u00f1a",
                    "and Rom\u00e0 Tauler"
                ],
                "journal": "Metabolomics",
                "logo": ""
            },
            {
                "doi": "10.1016/0169-7439(95)00047-X",
                "date": "2015-10-16 09:56:03",
                "title": "Multivariate curve resolution applied to second order data",
                "authors": [
                    "Roma Tauler"
                ],
                "journal": "",
                "logo": ""
            },
            {
                "doi": "10.1016/j.chemolab.2014.10.003",
                "date": "2015-10-16 09:56:37",
                "title": "MCR-ALS GUI 2.0: New features and applications",
                "authors": [
                    "Joaquim Jaumot",
                    "Anna de Juan",
                    "and Rom\u00e0 Tauler"
                ],
                "journal": "",
                "logo": ""
            }
        ],
        "authors": [
            {
                "id": 13602,
                "identity": "a07b89e7-516f-11e9-9e20-12b504df345a",
                "order_by": 0,
                "name": "Rom\u00e0 Tauler",
                "email": "Roma.Tauler@idaea.csic.es",
                "orcid": "",
                "institution": "CHEMAGEB -Chemometrics and Omics Group-, IDAEA-CSIC",
                "correspondingAuthor": true,
                "prefix": "",
                "firstName": "Rom\u00e0",
                "middleName": "",
                "lastName": "Tauler",
                "suffix": ""
            },
            {
                "id": 13600,
                "identity": "a07b8564-516f-11e9-9e20-12b504df345a",
                "order_by": 1,
                "name": "Eva Gorrochategui",
                "email": "",
                "orcid": "",
                "institution": "CHEMAGEB -Chemometrics and Omics Group-, IDAEA-CSIC",
                "correspondingAuthor": false,
                "prefix": "",
                "firstName": "Eva",
                "middleName": "",
                "lastName": "Gorrochategui",
                "suffix": ""
            },
            {
                "id": 13601,
                "identity": "a07b8840-516f-11e9-9e20-12b504df345a",
                "order_by": 1,
                "name": "Joaquim Jaumot",
                "email": "",
                "orcid": "",
                "institution": "CHEMAGEB -Chemometrics and Omics Group-, IDAEA-CSIC",
                "correspondingAuthor": false,
                "prefix": "",
                "firstName": "Joaquim",
                "middleName": "",
                "lastName": "Jaumot",
                "suffix": ""
            }
        ],
        "badges": [],
        "createdAt": "2015-10-16 14:22:49",
        "currentVersionCode": 1,
        "declarations": "",
        "doi": "10.1038/protex.2015.102",
        "doiUrl": "https://doi.org/10.1038/protex.2015.102",
        "draftVersion": [],
        "editorialEvents": [],
        "editorialNote": "",
        "failedWorkflow": [],
        "files": [
            {
                "id": 2609273,
                "identity": "5634a025-ecde-4900-9993-bca30042601b",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:48",
                "extension": "jpg",
                "order_by": 1,
                "title": "Figure 1",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 87311,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *1*   *Data* *conversion* *interface* *of* _*ProteoWizard*_ *software*: *MSConvert*.    The input fields or icons of the software are numbered according to their corresponding *PROCEDURE* steps. First, files to be converted should be selected (*3* and *4*). Then, output folder (*5*) and options related to the conversion process such as the output format or the binary encoding should be selected (*6*) previous to the beginning of the conversion (*7*).\r\n\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/3983/original/Figure_3.jpg?1444987686\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/3983/thumbnail/Figure_3.png?1444987686\" > </a> ",
                "description": "",
                "filename": "figure1.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_1.jpg"
            },
            {
                "id": 2609274,
                "identity": "d94e6a6d-162f-46d5-9df4-a59f6659fee3",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:48",
                "extension": "jpg",
                "order_by": 2,
                "title": "Figure 2",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 105069,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *2*   *Data* *conversion* *interface* *of* *Waters* *vendor*: *Databridge* *tool* *from* *MassLynx* *software*.    The input fields or icons of the software are numbered according to their corresponding *PROCEDURE* steps. First, source files should be selected (*2*) and options related to the conversion process predefined (*3*): source data type (usually _MassLynx_.raw) and target output type (_netCDF_ is recommended for further work). Target folder and filenames (*4*) should be indicated prior to conversion.\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/3985/original/Figure_1.jpg?1444987689\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/3985/thumbnail/Figure_1.png?1444987689\" > </a> ",
                "description": "",
                "filename": "figure2.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_2.jpg"
            },
            {
                "id": 2609275,
                "identity": "a8e163be-e7f6-49aa-ad24-f2db593220e0",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 3,
                "title": "Figure 3",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 158460,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *3*   *Data* *conversion* *interface* *of* *Thermo* *Fischer* *vendor*: *File* *converter* *tool* *from* *Xcalibur* *software*.    The input fields or icons of the software are numbered according to their corresponding *PROCEDURE* steps. First, source files should be selected from the available formats (usually, .raw) (*2*). Files selected are added to the job queue by clicking the \u201cAdd Job(s)\u201d button (*5*). Format and folder of output converted files should be also indicated (*6*), and it is recommended to select the ANDI (.cdf) data type.\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/3987/original/Figure_2.jpg?1444987692\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/3987/thumbnail/Figure_2.png?1444987692\" > </a> ",
                "description": "",
                "filename": "figure3.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_3.jpg"
            },
            {
                "id": 2609276,
                "identity": "bc9d6cab-e163-4c39-b4ee-c941e303f9a4",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 4,
                "title": "Figure 4",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 284192,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *7*   *MCR-ALS* *GUI* *2.0* *main* *window* (*mcr_main*) *and* *other* *subwindows* *corresponding* *to* *SVD* *calculations* *and* *pure* *variable* *Initial* *ALS* *estimations*   Main window: Data Selection (*48*), Estimation of the number of components (*49*) by using an SVD algorithm (*50*). When clicking a new window appears showing eigenvalues (list and top plot) and eigenvectors (bottom plot). Next, initial estimates (*53*) are required. It is recommended to use the pure variable detection approach (*54*) that also opens a new screen. Critical parameters in the pure variable calculation (*55*) are the direction of variable selection (rows/concentration or columns/spectra) and noise allowed. These steps provide all the needed information for the ALS optimization (*58*).\r\n\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/3989/original/Figure_7.jpg?1444924731\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/3989/thumbnail/Figure_7.png?1444924731\" > </a> ",
                "description": "",
                "filename": "figure4.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_4.jpg"
            },
            {
                "id": 2609280,
                "identity": "b73c7ecd-f63e-4697-b558-c7ebb78fef3b",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 5,
                "title": "Figure 5",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 154990,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *8*   *Data* *set* *selection*. *MCR-ALS* *GUI* *window*.    MCR-ALS window plots representing row (top right) and column (top left) profiles of the experimental data matrix *D*; plots showing *S*^T^ spectra initial estimates (middle left), and *C* concentration profiles (middle right) estimated by least-squares; and PCA scores (bottom left) and loadings (bottom right) plots of the experimental data matrix *D* using the selected number of components. A critical issue in this screen is the selection of the correct number of experiments analyzed simultaneously in the edit box (*59*). In this example, six matrices are analyzed at the same time.\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/3991/original/Figure_8.jpg?1444924809\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/3991/thumbnail/Figure_8.png?1444924809\" > </a> ",
                "description": "",
                "filename": "figure5.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_5.jpg"
            },
            {
                "id": 2609277,
                "identity": "a8b8a8e4-eb1d-4653-a797-d95ac6d06a98",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 6,
                "title": "Figure 6",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 79150,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *9*   *Selection* *of* *the* *type* (*column*- *or* *row-wise*) *of* *augmented* *data* *matrix* *MCR-ALS* *window*.   MCR-ALS window of the definition of the data set in the case of considering simultaneously more than one matrix. In the omic case, column-wise augmented data set should be selected (*61*) as several experiments monitored with the same technique (usually, MS) are considered. If all the considered experiments have the same number of rows, it is recommended to click the checkbox \u201cAll matrices have the same Nr. of rows?\u201d that facilitate the input of the information related to the number of rows of each considered matrix.\r\n\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/3993/original/Figure_9.jpg?1444924922\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/3993/thumbnail/Figure_9.png?1444924922\" > </a> ",
                "description": "",
                "filename": "figure6.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_6.jpg"
            },
            {
                "id": 2609281,
                "identity": "ff7d115b-148b-4dc1-8709-b8f47ae64ab4",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 7,
                "title": "Figure 7",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 315834,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *10*   *MCR-ALS* *constraints* *selection* *windows*.   Selected constraints (*a*) for *C* matrix (concentration/rows profiles), and (*b*) for *S*^T^ matrix (spectra/columns profiles). In the case of the omic studies, only non-negativity constraints should be applied to both *C* and *S*^T^ profiles enforcing that the resolved chromatographic elution and MS spectra are positive (*64* and *66*). If multiple matrices are analyzed simultaneously, it is possible to apply the same constraints to all the experiment by clicking the appropriate checkbox (*63*). If it is not checked, then each matrix could have different constraints. \r\n\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/3995/original/Figure_10.jpg?1444925322\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/3995/thumbnail/Figure_10.png?1444925322\" > </a>",
                "description": "",
                "filename": "figure7.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_7.jpg"
            },
            {
                "id": 2609278,
                "identity": "6ac5f4e4-0bf6-49a7-b33e-df069dde6352",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 8,
                "title": "Figure 8",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 67486,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *11*   *MCR-ALS* *optimization* *parameters* *and* *outputs* *window*.   MCR-ALS window showing general parameters for ALS optimization (default parameters are 50 iterations and a convergence criterion of 0.1% of percentage of change of the standard deviation of residuals between consecutive iterations, however in the presented example the latter value has been changed to 1% to allow a faster iteration) and output variable names for MCR-ALS results (*68*).\r\n\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/3997/original/Figure_11.jpg?1444925374\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/3997/thumbnail/Figure_11.png?1444925374\" > </a>",
                "description": "",
                "filename": "figure8.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_8.jpg"
            },
            {
                "id": 2609282,
                "identity": "eba24f5b-965f-4c5b-9d3f-3f83a416058e",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 9,
                "title": "Figure 9",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 166318,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *12*   *MCR-ALS* *optimization* *results* *and* *other* *related* *information* *window*.   MCR-ALS window showing the results of ALS optimization (*70*). Final screen with information about the optimation process: number of iterations, convergence/or divergence, standard deviation of residuals respect experimental data, fitting error of the model considering both experimental and PCA reproduced data, and the percent of variance explained (R^2^) Additional information related to the optimization process can also be obtained such as the evolution of the logarithm of the sum of squares or the lack of fit of the model (*71*).\r\n\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/3999/original/Figure_12.jpg?1444925470\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/3999/thumbnail/Figure_12.png?1444925470\" > </a>",
                "description": "",
                "filename": "figure9.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_9.jpg"
            },
            {
                "id": 2609285,
                "identity": "11e29da4-81a6-49d4-94f5-46d063de47b6",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 10,
                "title": "Figure 10",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 3303131,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *13*   *Results* *of* *the* *statistical* *evaluation* *performed* *on* *MCR-ALS* *components* *to* *determine* *whether* *they* *present* *significant* *differences* *among* *controls* *and* *stressed* *samples*   (*a*) elution and pure spectra profiles of component 1, (*b*) profile areas and max height of component 1 among the six samples, (*c*) results derived from the statistical evaluation of component 1 and (*d*) results derived from the statistical evaluation of all the components. \r\n\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/4001/original/Figure_13.jpg?1444925637\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/4001/thumbnail/Figure_13.png?1444925637\" > </a>",
                "description": "",
                "filename": "figure10.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_10.jpg"
            },
            {
                "id": 2609284,
                "identity": "87c3cd3f-5c56-46f5-aed2-bd80d73ff7ac",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 11,
                "title": "Figure 11",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 655276,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *4*   *Graphical* *outputs* *obtained* *after* *a* *ROI* *search* *using* *ROIpeaks* *function* *in* *sample* *Control* *1*    (*I*) plot of _MSroi_ respect to time (new compressed chromatogram) and (*II*) bar plot of the sum of _MSroi_ intensities respect to _mzroi_ values (new MS spectra).\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/4003/original/Figure_4.jpg?1444993474\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/4003/thumbnail/Figure_4.png?1444993474\" > </a> ",
                "description": "",
                "filename": "figure11.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_11.jpg"
            },
            {
                "id": 2609283,
                "identity": "adfe9315-2473-4726-9122-10b30befbe68",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 12,
                "title": "Figure 12",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 1172996,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *5*   *Representation* *of* *a* *chromatographic* *elution* *profile* *and* *the* *corresponding* *mass* *trace* *of* *a* *particular* *ROI*   In the mass trace representation, the continuous blue line represents the mean value of _mzroi_, green dotted-lines represent the mass deviation intervals and red dotted-lines two times the mass deviation interval. \r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/4005/original/Figure_5.jpg?1444993556\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/4005/thumbnail/Figure_5.png?1444993556\"> </a> ",
                "description": "",
                "filename": "figure12.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_12.jpg"
            },
            {
                "id": 2609288,
                "identity": "634e2ff8-23af-49b2-a573-67bbdcb86ec2",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 13,
                "title": "Figure 13",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 1233308,
                "visible": true,
                "origin": "",
                "legend": "*Table* *1*   *Troubleshooting* *table*.   <a href=\"http://www.nature.com/protocolexchange/system/uploads/4007/original/Table_1.jpg?1444993674\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/4007/thumbnail/Table_1.png?1444993674\"> </a> ",
                "description": "",
                "filename": "figure13.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_13.jpg"
            },
            {
                "id": 2609286,
                "identity": "e37b6c1d-3216-4deb-a797-eee0ffb908c1",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:50:49",
                "extension": "jpg",
                "order_by": 14,
                "title": "Figure 14",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 170656,
                "visible": true,
                "origin": "",
                "legend": "*Figure* *6*   *Results* *of* *a* *ROI* *search* *among* *matrices* *when* *using* *MSroiaug* *function*   (*a*) ROI search among _Control1_ (_C1_), _Control2_ (_C2_) and _Control3_ (_C3_) and (*b*) ROI search among the six samples. *Note*: The results presented in this figure were obtained for a ROI search among samples fixing a threshold value of 750 a.u. and an mzerror of 0.05 Da/e. In addition the index _m_ is used to represent the number of scans of one sample.\r\n\r\n<a href=\"http://www.nature.com/protocolexchange/system/uploads/4009/original/Figure_6.jpg?1444998369\" > <img src=\"http://www.nature.com/protocolexchange/system/uploads/4009/thumbnail/Figure_6.png?1444998369\" > </a> ",
                "description": "",
                "filename": "figure14.jpg",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/figure_14.jpg"
            },
            {
                "id": 13465016,
                "identity": "fc6c3860-f92f-4cb9-838d-7b79cc91302f",
                "added_by": "auto",
                "created_at": "2021-09-16 20:45:17",
                "extension": "pdf",
                "order_by": 0,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "manuscript-pdf",
                "size": 1715533,
                "visible": true,
                "origin": "",
                "legend": "",
                "description": "",
                "filename": "manuscript.pdf",
                "url": "https://assets.researchsquare.com/files/nprot-4347/v1/1079230a-b4fb-4e45-9781-e3bbc616025e.pdf"
            }
        ],
        "financialInterests": "The authors declare no competing financial interests.",
        "fulltextSource": "",
        "fullText": "",
        "funders": [],
        "hasOptedInToPreprint": true,
        "hasPassedJournalQc": "",
        "hideJournal": true,
        "highlight": "",
        "institution": "",
        "isAuthorSuppliedPdf": false,
        "isDeskRejected": "",
        "isHiddenFromSearch": false,
        "isInQc": false,
        "isInWorkflow": false,
        "journal": {
            "display": true,
            "email": "protocol.exchange@nature.com",
            "identity": "protocol-exchange",
            "isNatureJournal": false,
            "hasQc": false,
            "allowDirectSubmit": true,
            "externalIdentity": "",
            "sideBox": "",
            "submissionUrl": "https://protocolexchange.researchsquare.com/submission",
            "title": "Protocol Exchange",
            "twitterHandle": ""
        },
        "keywords": "metabolomics, LC-MS, data processing, ROI, chemometrics, MCR-ALS",
        "license": {
            "name": "CC BY-NC 3.0",
            "url": "https://creativecommons.org/licenses/by-nc/3.0/"
        },
        "manuscriptAbstract": "Liquid chromatography- mass spectrometry \\(LC-MS) is a powerful methodology for metabolomics. However, **LC-MS** **data** **processing** comes out as the \u201cbottleneck\u201d of omic sciences due to its complexity. The present protocol, easy to execute in MATLAB environment, covers all data analysis steps \\(conversion and import, compression and processing) of LC-MS data sets and it is specifically designed for users with limited background in **chemometric** **and** **data** **analysis** **tools**. Data conversion and import are described for most important LC-MS manufacturers \\(_i.e._, _Waters_, _Thermo_ _Fischer_, _Agilent_, _AB_ _Sciex_ and _Bruker_), data compression consists on the search of \u201cregions of interest\u201d \\(**ROI**) and data processing is based on the use of Multivariate Curve Resolution-Alternating Least Squares \\(**MCR-ALS**), a powerful chemometric tool that allows chromatographic resolution. Results are rapidly achieved \\(usually \u02c2 15 min per sample), and they are easy to interpret and evaluate both in terms of chemistry and biology.",
        "manuscriptTitle": "A protocol for LC-MS metabolomic data processing using chemometric tools",
        "msid": "",
        "msnumber": "",
        "nonDraftVersions": [
            {
                "code": 1,
                "date": "2015-11-30 18:26:54",
                "doi": "10.1038/protex.2015.102",
                "editorialEvents": [
                    {
                        "type": "communityComments",
                        "content": 0
                    }
                ],
                "status": "published",
                "journal": {
                    "display": true,
                    "email": "info@researchsquare.com",
                    "identity": "researchsquare",
                    "isNatureJournal": false,
                    "hasQc": true,
                    "allowDirectSubmit": true,
                    "externalIdentity": "",
                    "sideBox": "",
                    "submissionUrl": "/submission",
                    "title": "Research Square",
                    "twitterHandle": "researchsquare"
                }
            }
        ],
        "origin": "",
        "ownerIdentity": "a07b073a-516f-11e9-9e20-12b504df345a",
        "owner": [],
        "postedDate": "November 30th, 2015",
        "published": true,
        "revision": "",
        "status": "posted",
        "subjectAreas": [
            {
                "id": 3457,
                "name": "Computational biology and bioinformatics"
            },
            {
                "id": 3459,
                "name": "Biochemistry"
            }
        ],
        "tags": [],
        "versionOfRecord": [],
        "versionCreatedAt": "2015-11-30 18:26:54",
        "video": "",
        "vorDoi": "",
        "vorDoiUrl": "",
        "workflowStages": []
    }
}