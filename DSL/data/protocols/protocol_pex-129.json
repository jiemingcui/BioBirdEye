{
    "identity": "pex-129",
    "title": "Easy-DHPSF 2.0: open-source software for three-dimensional localization and two-color registration of single molecules with nanoscale accuracy",
    "content": [
        {
            "header": "Introduction",
            "content": "<p>Three-dimensional localization of single emitters for super-resolution imaging and single-particle tracking continues to be a vibrant field of study<sup>1</sup>. The double-helix microscope<sup>2</sup> provides 3D information from 2D images using PSF engineering to generate images of single emitters which have two lobes, where the z-position information is contained in the angle between the two lobes. The Easy-DHPSF software provides an easy-to-use set of MATLAB programs for analysis of the \u201cDouble-Helix PSF\u201d data generated from this kind of microscope, and with minor changes, can be adapted to other PSFs which use lobe arrangement to encode position<sup>3</sup>.</p><p><br></p><p><u>Overview of version 2.0 update</u></p><p>Easy-DHPSF version 2.0 utilizes the same algorithm for identification of SMs in a DH microscope image as version 1.0: template matching in each region of interest via phase correlation, then double-Gaussian fitting of the DHPSF<sup>4</sup> (here called DH for brevity) images through non-linear least squares minimization (<strong>Figure 1</strong>). This algorithm represents a good compromise between fitting accuracy and computational complexity. For a more detailed description of this algorithm, the reader should consult the documentation for Easy-DHPSF v1.0<sup>5</sup> as the basic details will not be repeated here. Version 2.0 introduces functions for two-color registration and for defining the calibration curves from many points, such as in a regularly-spaced nanohole array (NHA)<sup>6</sup>.</p><p><br></p><p><u>Registration of two color channels with a locally-weighted quadratic transform</u></p><p>One key aspect in most two-color wide-field imaging experiments is the procedure used to quantitatively map one channel onto the other to provide one consistent coordinate system. Simple implementations have used affine transforms or other global mapping approaches. Although global mapping functions have the advantage that they can be estimated from only a few corresponding control point pairs, they may not be flexible enough to accurately register high-resolution SM localization data. An accurate mapping function defined over the entire 3D field of view is essential for wide-field high-resolution microscopy.</p><p>The mapping function implemented in Easy-DHPSF v2.0 is a 3D locally-weighted quadratic transformation. The mapping function <strong>t </strong>transforms points from one coordinate system into another<sup>7</sup>, <strong>t(x)=x\u2019</strong>. For coordinate transformations in 3D, <strong>t(x)</strong> has 3 components, <em>t</em><sub><em>x\u2019</em></sub>, <em>t</em><sub><em>y\u2019</em></sub>, and <em>t</em><sub><em>z\u2019</em></sub>, that separately generate the three transformed coordinates <em>x\u2019</em>, <em>y\u2019</em>, and <em>z\u2019</em>  (see <strong>Figure 15</strong>). The component functions <em>t</em><sub><strong>x</strong><em>\u2019</em></sub> are given as the weighted mean of polynomial transformations <em>L</em><sub><em>i,</em><strong>x</strong><em>\u2019</em></sub> using the local weights <em>W</em><sub><em>i </em>&nbsp;</sub>associated with control point <em>i</em> with coordinates <strong>x</strong><sub><em>i</em></sub> (see <strong>Figure 16</strong>), where the sum is over the full set of <em>N</em> control points in the image domain. </p><p>The polynomial transformation functions <em>L</em><sub><em>i,</em>x\u2019</sub> are defined exactly for each pair of control points: i.e., <em>L</em><sub><em>i,</em><strong>x</strong>\u2019 </sub>(<strong>x</strong><sub><em>i</em></sub>) = <strong>x</strong><sub><em>i</em></sub>\u2019 without error. The <em>x\u2019</em> component of a 3D quadratic transformation is given by the equation below, and <em>y\u2019</em> and <em>z\u2019</em> components are similarly defined (see<strong> Figure 17</strong>).</p><p>The functions <em>L</em><sub><em>i,</em><strong>x</strong>\u2019</sub> are sufficient to define the map between the control points, i.e. the points <strong>x</strong><sub><em>i</em></sub> and <strong>x</strong><sub><em>i</em></sub>\u2019, while the weighting coefficients <em>W</em><sub><em>i</em></sub> are used to interpolate between these points. The weight associated with control point <em>i</em> is given as a 3D Gaussian sphere centered at <strong>x</strong><sub><em>i</em></sub>. The width of the Gaussian sphere is defined by a global width parameter <em>s</em>, and a local width parameter <em>\u03c3</em><sub><em>i</em></sub> that varies from point to point to accommodate the local density of control points (see <strong>Figure 18</strong>).</p><p>For the automated computation of the complete transformation function, the user needs to specify three parameters: the number of neighboring control points <em>n</em> used to calculate the coefficients of the polynomial transformation by least squares estimation, the global width parameter <em>s</em>, and the generating function used to define <em>\u03c3</em><sub><em>i</em></sub>. These three parameters are systematically determined by the optimization program for each set of control point pairs to produce the lowest overall registration errors as described below in Step 8. The design of the registration algorithm is discussed further in Ref. 7.</p><p>Below, we demonstrate the use of open-source Easy-DHPSF v2.0 by analyzing an SM dataset of microtubules immunolabeled with blinking Alexa647 (Life Technologies) and CF568 (Biotium) in BSC-1 cells. This code has been validated in several different imaging conditions (Refs. 6, 8, 9) and is provided free-of-charge under the 3-clause New BSD License at <a href=\"https://opensource.org/licenses/BSD-3-Clause\" target=\"_blank\"><u>https://opensource.org/licenses/BSD-3-Clause</u></a><em>.</em> Specifically, this code is provided \u201cas is\u201d without guarantees of any kind.</p>"
        },
        {
            "header": "Reagents",
            "content": "<p><u>\ufeff</u></p>"
        },
        {
            "header": "Equipment",
            "content": "<p><u>Calibration and control points \u2013 beads vs. NHA</u></p><p>Calibration and control-point scans can be performed with either fluorescent beads immobilized on a coverslip <sup>8</sup> or with a metal nanohole array (NHA) filled with a solution containing the fluorophore labels of interest<sup>6</sup>. Whereas use of beads on a coverslip allows for faster fitting and generation of the transformation function, the NHA provides finer sampling of the field of view. This allows both the DH calibration and two-color registration function to account for field-dependent errors arising from aberrations in the imaging system. Moreover, by scanning the NHA laterally, we can sample the field of view in a finer and more controllable way than with beads randomly dispersed onto a coverslip.</p><p>Below, to generate the set of control points used to calculate the registration function, we imaged bright fluorescent beads (200 nm Tetraspeck, Invitrogen) dispersed on a coverslip with emission simultaneously visible in both detection channels. We repeatedly scanned the positions of beads throughout a 3D field of view to assemble a large set of control point pairs to finely calibrate the spatial differences in DH response at many locations in the two color channels. A similar procedure of axial and lateral scanning of a fluorophore-filled NHA can also be performed.&nbsp;</p><p><br></p><p><u>Software</u></p><p>The Easy-DHPSF package consists of MATLAB functions and subroutines and requires the image processing, optimization, statistics, and wavelet toolboxes. Easy-DHPSF has been tested on workstations running MATLAB 2017b. There are no known issues with earlier versions of MATLAB, but some built-in functions (e.g. fft2, imread) may have reduced performance in earlier versions.</p><p><br></p><p><u>Data file considerations </u></p><p>Easy-DHPSF v2.0 requires several .tif stacks to run.</p><p>The first image stacks are the raw data file(s) of the two color channels with SMs to be localized. If desired, the field of view may contain one or more fiducials to correct for sample drift, ideally located near the edge of the field of view and not overlapping with the region containing single molecules to be localized. The two-color imaging may be performed on a standard two-color SM microscope with each color channel imaged on separate cameras, or the two color channels may be imaged onto different regions of the same camera.</p><p>The second image stack is a calibration scan. This should comprise a series of frames at different <em>z</em>-positions of either beads on a coverslip or a NHA that are detected in both color channels simultaneously. As an example: The calibration scan is taken by translating the piezoelectric <em>z</em> stage in 50 nm steps from -1 micron to +1 micron relative to the focus (with ~20 acquired frames at each step to improve precision of the measurement), ensuring that there are enough frames between each step to allow for relaxation of the stage or oil and the sample. A sequence log file should be generated with the sequence of steps used to generate this calibration scan. An example sequence log file for this calibration step is provided (sequenceLog_calibrationScan.dat).</p><p>The third image stack is a control point scan. The control point scan is taken by translating the <em>z</em> stage in known step sizes across the range of the DHPSF, i.e., 200 nm steps from -1 micron to +1 micron, with multiple frames (~20) at each step to improve precision. After each complete axial scan, the stage is then translated laterally and the axial scan is repeated to ensure fine sampling of the field of view. The user should ensure that the relative brightness of the DHPSFs are similar in both color channels. The user should also ensure that this scan is taken with the same filters as those used for SM data. A sequence log file should be generated with the sequence of steps used to generate this calibration scan. An example sequence log for this control point scan step is provided (sequenceLog_controlPointScan.dat).</p><p>The last image stacks are \u2018dark offsets\u2019 for the calibration and the data files. The frames in the dark offset .tif stacks are averaged and subtracted before data processing to account for the offset and dark counts from the EMCCD. Acquire a series of a few hundred frames with the camera shutters closed, and use the same acquisition parameters (e.g. integration time, EM gain, shift speed) as those used for the calibration and data acquisition. If these parameters are the same between the calibration and raw data images, only one dark offset file is necessary.</p>"
        },
        {
            "header": "Procedure",
            "content": "Step 0. Image acquisition and program setup\nAcquire the raw data, calibration scan, control point scan, and dark offset images described in Equipment. Ensure that you have saved a sequence log file for the calibration and control point scans.\nStep 1. Two-color DHPSF calibrations\nThis section will outline the steps to perform two-color calibrations of the DHPSF either with beads or with a NHA.\n1.1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Open an instance of the Easy-DHPSF GUI by entering \u2018easy_dhpsf\u2019 in the MATLAB command line.\n1.2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Before running any of the modules, set the conversion gain and pixel size of the detector using the fields under \u2018Setup.\u2019 Note that changing these parameters after processing the data does not retroactively change the calculated results (\nFigure 2\n).\n1.3\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Under Setup > Channel, select a channel \u2018G\u2019 for green or \u2018R\u2019 for red.\n1.4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Under \u2018Calibrate DHPSF\u2019, click \u2018Run.\u2019\n1.5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Follow the prompts if you would like to automatically save the partly processed dataset after this module.\n1.6\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Open the calibration images file, the dark offset image file matching the calibration, and the sequence log file (either .mat or .dat) for the calibration. The program will prompt you for these files via dialog boxes.\n1.7\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Set the EM gain used during the acquisition of the calibration images, whether you would like use wavelet subtraction, NHA holes if using NHA and whether the holes are at 45 degrees, whether the DHPSF\u2019s two lobes are horizontal when in focus, and the box radius for fitting.\n1.8\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Select a region of interest to analyze. Follow 1.8.1 if using beads on a coverslip, or 1.8.2 if using an NHA.\n1.8.1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Select a region of interest (ROI) containing at least one bright fluorescent object by adjusting the box and double-clicking inside it. Even though the calibration bead may be isolated, it is helpful to select an entire wide-field excitation region so that the background fluorescence can be estimated accurately. Select fluorescent objects by clicking the center of each DHPSF (\nFigure 3\n).\n1.8.2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Select an ROI by adjusting the box and double-clicking inside it. Select 4 holes that form a large square, then select fiducials to outline the edge of your field of view (\nFigure 4\n). Make sure to try to click the center of each DHPSF, halfway between the two lobes. Hit enter when finished DHPSFs.\n1.9\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Each frame of raw data, as well as the accompanying double Gaussian fit, is displayed as it is processed.\n1.10\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0After processing, an output of calibration information will be generated in the \u2018calibration [DateAndTime]\u2019 folder. Inspect this for each bead to ensure that the angle vs.\nz\nposition curve is roughly linear, and that the variation of angle measurements in each step is not unreasonably high (error bars in upper-left plot) (see\nFigure 5\nbelow). Additional information from the calibration, such as the observed shift in\nx\nand\ny\nposition with axial position or wobble, may be useful when aligning the DH phase mask.\n1.11\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Select the most reliable calibration bead in the Easy-DHPSF main window using the drop-down menu. The calibration information and templates generated from this bead will be used in all later processing steps.\n1.12\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Go back to step 1.2 and repeat the calibration process for the other color channel. When done, click the save icon (located on the top left of the window) to save your calibrations. You can open this calibration file for use in the subsequent steps.\nStep 2. Single-molecule detection calibration for SMACM data\nIn this module, the templates generated from the calibration subroutine are used to generate a large array of matches to the raw SMACM image data. This step serves to assess what value of phase correlation is typical for a good match to an SM image. After this step, the user will define a threshold for each template such that only DHPSF images of reasonable quality will be analyzed with the double-Gaussian fitting algorithm.\n2.1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Under Setup > Channel, select a channel \u2018G\u2019 for green or \u2018R\u2019 for red.\n2.2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Click the \u2018Run\u2019 button in the \u2018Calibrate SM identification\u2019 panel.\n2.3\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Follow the prompts if you would like to automatically save the GUI after this module.\n2.4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Set the EM gain used, load in the SM data .tif file(s), select what frames to perform the SM detection calibration on, and select the templates to be used. By default, templates are chosen by the program such that the angle of the line connecting the two lobes is given by {-60\u00b0, -30\u00b0, 0\u00b0, 30\u00b0, 60\u00b0, 90\u00b0}, and this selection should generally be appropriate (\nFigure 6\n).\n2.5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Load in the dark offset .tif file with the same parameters as the SM data.\n2.6\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0The program will then prompt the user to choose a background processing algorithm such as median filtering, wavelet filtering, no background subtraction, or select if the data is an NHA,\nFigure 7\n. Median filtering parameters should be filled in if choosing this option.\n2.7\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Select a region containing the SMs of interest. This exact ROI will be used for the single-molecule fitting module and ideally should not contain fluorescent objects that are much (\u226510x) brighter than the SMs you wish to analyze. Template matches are indicated as circles drawn over the raw data. Stronger matches are drawn as larger circles, and each color corresponds to a different template match.\n2.8\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0After the template-matching module is complete, open the \u2019threshold [DateAndTime]\u2019 folder. This contains a selection of .png files that represent potential template matches. The filenames describe which template matched the data and the value of the phase correlation for the match (e.g. \u2018template 3 threshold 272.png\u2019).\n2.9\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Select appropriate thresholds for each template, and enter these into the \u2018threshold\u2019 field in the GUI. These thresholds should be chosen such that the two lobes of the DHPSF are faintly visible and that there is a low rate of false matches for higher correlation values. You should not be concerned if there are a few incorrect matches, say to one lobe of the DHPSF from a very bright molecule, because these will be rejected by the subsequent double-Gaussian fit module.\nStep 3. Fiducial tracking (optional)\nThis module tracks the movement of one or more fluorescent beads or other stationary markers. Stage drift during a SM experiment can be thus be removed by subtracting the movement of the fiducial marker from the SM localizations.\n3.1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Click the \u2018Run\u2019 button in the \u2018Track fiduciaries\u2019 panel.\n3.2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Follow the prompts if you would like to automatically save the GUI after this module.\n3.3\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Select a region of interest containing at least one bright fiducial by adjusting the box and double-clicking inside it.\n3.4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Select one or more fiducials by clicking in the center of each DHPSF.\nStep 4. Single-molecule localization for SMACM data\nUsing the results of the previous processing steps, this module identifies single molecules that score above the template matching threshold identified in step 2.9, then fits them using nonlinear least squares minimization to a double-Gaussian function.\n4.1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Click the \u2018Run\u2019 button in the \u2018Localize DHPSF SMs\u2019 panel.\n4.2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Follow the prompts if you would like to automatically save the GUI after this module.\n4.3\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Choose the frames from the raw data to process, as well as whether you would like to estimate the laser profile and find true lobe widths (sigmas). By default, the entire image stack is processed.\n4.4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Whenever starting analysis of a new experiment, monitor this process as it proceeds to ensure that the threshold used includes the single molecules visible in the raw data, and to ensure that the fits are performed successfully. Only matches that score above the thresholds are fit, and good fits are plotted in the frame-by-frame reconstruction. Here the definition of a good double-Gaussian fit is a fit that meets several straightforward criteria, hard-coded into the module. The tests performed to define a good fit are listed below under Troubleshooting (Step 4).\n4.5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Save this Easy-DHPSF file using the save icon at the top of the GUI, ensuring that the Channel selected is the correct one.\n4.6\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Go back to Step 2, this time selecting the other color channel.\n4.7\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Ensure that you have two saved easy-dhpsf files, one for each color.\nStep 5. Single-molecule detection calibration for control points\n5.1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Load in the Easy-DHPSF GUI file from Step 1, saved after calibrating both the green and red channels.\n5.2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Under Setup > Channel, select a channel \u2018G\u2019 for green or \u2018R\u2019 for red.\n5.3\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Click \u2018Run\u2019 in the \u2018Calibrate SM identification\u2019 panel.\n5.4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Follow the prompts if you would like to automatically save the GUI after this module.\n5.5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Set the EM Gain used, load in the control point scan .tif file(s), select what frames to perform the control point detection calibration on, and select the templates to be used. A subset of the frames may be used, but ensure that the frames you selected are ones that include at least 1-2 full axial scans so that different\nz\npositions are included in the calibration.\n5.6\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Load in the sequence log file (.dat or .mat) with the sequence of steps used for the control point scan.\n5.7\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Load in dark offset .tif with the same parameters as the control point scan.\n5.8\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0The program will then prompt the user to choose background median filtering, wavelet filtering, no background subtraction, or select if the data is a NHA array. Median filtering parameters should be filled in if choosing this option. If an NHA is used, select NHA so that the program will fit localizations found in a grid \u2013 this will increase the number of PSFs detected. If NHA is selected, median background subtraction is performed.\n5.9\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0A frame of the scan will pop up, and the user will be prompted to select an ROI of the correct color channel using a square ROI. The user will then be able to select an ROI with a polygon.\n5.10\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0After the calibration, follow Steps 2.4-2.5 described above for selecting thresholds.\nStep 6. Single-molecule localization for control points\nThis will outline the steps to fit control points in the two channels.\n6.1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Click the \u2018Run\u2019 button in the \u2018Localize DHPSF SMs\u2019 panel.\n6.2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Choose the frames you would like to fit, as well as whether you would like to estimate the laser profile and find true lobe sigmas.\n6.3\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0As this step is for fitting the control points, enter how many stationary frames there are for each axial position and click \u2018OK.\u2019\n6.4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0If using an NHA, select 4 fiducials that form a box that outlines the field of view (\nFigure 8\n). The program will find the rest of the DHPSFs located on a grid for each axial scan. Otherwise, this step does not show up for bead fitting (\nFigure 9\n).\n6.5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Once the program is finished fitting, filter and export your results. Under \u2018Output DHPSF SM localization\u2019, click \u2018Filter Output.\u2019\n6.6\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0If using a NHA, choose \u2018Yes\u2019 when the program asks whether you would like to use spatially dependent calibrations. Doing this will reduce field-dependent aberrations by applying nearest-neighbor calibrations to your data with the NHA.\n6.7\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0A different calibration may be used during this step. The program will prompt the user with this option.\n6.8\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Filter your control points as prompted by the program (for instance, filter by frame,\nz\nposition, lobe distance, photons, localization precision, etc.).\n6.9\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Choose the region to be plotted in the scatter plot, inspect the localizations, then save your data when you are happy with the results. The filtered localizations will be in the file \u2018Output.mat\u2019, for use in the next step.\n6.10\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Repeat steps 5 and 6 for the other color channel. Take note of where you saved the filtered output files, as they will be needed for the next step.\nStep 7. Identification of control points\nThis module will identify candidate control points between two channels.\nKEY INPUTS: Output.mat file of GREEN and RED channels\nKEY OUTPUTS: Identify_ControlPoints_3D_output.mat\n7.1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Run the MATLAB function \u2018Identify_ControlPoints_3D_v1.m\u2019\n7.2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Open the \u2018Output.mat\u2019 data file with the molecule fits in reflected/GREEN channel. (If you are not using a single camera, ignore \u201creflected\u201d vs. \u201ctransmitted\u201d.)\n7.3\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Open the \u2018Output.mat\u2019 data file with the molecule fits in transmitted/RED channel.\n7.4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Open the .mat or .dat sequence log file for the control point scan.\n7.5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0If available, open a previous transform to use as an initial guess. Otherwise, click \u2018Cancel\u2019\n7.6\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Input parameters of how many stationary frames were taken at each\nz\nposition, how many frames to wait before starting the averaging, and if using an old transform, how closely the initial transform should match old transform points. The program will prompt you for these values.\n7.7\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0The program will first find control point (CP) candidates, merging localizations at given\nz\npositions.\n7.8\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0A figure will pop up with fitting statistics for the molecules fits you loaded. Enter filtering parameters for\n\u03c3\nx\n,\n\u03c3\ny\n,\n\u03c3\nz\n, and number of measurements.\n7.9\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Inspect averaged bead positions in both channels.\n7.10\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0If an initial transform was not given in step 3.5, the program will ask you to hand click control points. Aim to hand click at least ~15 control points. Follow the prompts in the figure (\nFigure 10\n,\nFigure 11\n). Both the color and size of each localization encodes the relative brightness (number of photons detected) of that molecule. If the program is still prompting you to select control points but you have already selected >15 and would like to stop, get a new frame then hit \u2018esc\u2019 to end.\n7.11\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0When finished hand clicking control points, the program will run and generate a preliminary transformation file that you will use for the next step. This file will be located in the same directory where your green channel \u2018Output.mat\u2019 is saved.\nStep 8. Generating and evaluating final 3D transform from control points\nThis module will evaluate the initial transform calculated in Step 7 above and generate a final transform you can use in the next step.\nKEY INPUTS: Identify_ControlPoints_3D_output.mat\nKEY OUTPUTS: 3D_Transform_lwquadratic.mat\n8.1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Run the MATLAB function \u2018EvaluateTransform_3D_v2.m\u2019\n8.2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Input transformation parameters (then proceed to Step 8.4) or click if you want to evaluate parameter ranges (proceed to Step 8.3).\n8.3\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Enter the range of parameters you would like to evaluate. The program will evaluate these parameter ranges then return the calculated target registration errors (TRE) and fiducial registration errors (FRE)\n9\n. An example result is in\nFigure 12\n. Inspect the results by clicking on the figure. Ideally, the user should aim for errors \u2264 10 nm.\n8.4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Select the value of nearest neighbors, sigma, and kth nearest neighbor, and input these parameters into the dialog box that appears. The program will then calculate a transformation using the parameters you provided. For the ~1000 control point pairs in the example here, the mapping function took ~1 hour to generate using an Intel Xeon E5-1620 processor.\n8.5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0The program will return a histogram of TREs and FREs, as well as the spatial distribution of these metrics. The final transformation is \u20183D_Transform_lwquadratic.mat\u2019 and will be located in the same folder as \u2018Identify_ControlPoints_3D_output.mat.\u2019\nStep 9. Transforming SMACM data\nThis module will smooth the fiducial tracks, perform the 3D two-color registration, correct for sample drift, apply an index mismatch correction, and calculate localization precision.\nKEY INPUTS: Easy-DHPSF files for each of the two color channels, transformation function (3D_Transform_lwquadratic.mat)\nKEY OUTPUTS: MATLAB structure called dataSets\n9.1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Run the MATLAB script \u2018TransformSMACMData_v6.m\u2019\n9.2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Indicate whether the green data or red data was acquired first, or if the two-color acquisition was interleaved.\n9.3\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Load in the green Easy-DHPSF file. The program will perform smoothing via wavelet filtering of the fiducial tracks and apply this correction to your data. Follow the prompts that appear.\n9.4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Load in the red Easy-DHPSF file, and follow prompts that appear to smooth fiducial track data.\n9.5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Load in the \u20183D_Transform_lwquadratic.mat\u2019 file generated in the previous step.\n9.6\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0The program will prompt whether or not you would like to crop each dataset before the transformation.\n9.7\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Select the location and enter a file name for where to save your registered dataset.\n9.8\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0The registered data is stored in the MATLAB structure \u2018dataSets,\u2019 with \u2018dataSets(1)\u2019 containing the green data and \u2018dataSets(2)\u2019 containing the red data. The fields xFid, yFid, and zFid_n contain the fiducial-corrected and index-corrected localizations. The rest of the fields are described in\nFigure 19\n.\n9.9\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Select whether you would like to export the localizations into a csv file. If yes, choose the location and file name of each color file."
        },
        {
            "header": "Troubleshooting",
            "content": ""
        },
        {
            "header": "Time Taken",
            "content": ""
        },
        {
            "header": "Anticipated Results",
            "content": "<p>Below is a 2D scatterplot of Alexa647- and CF568-immunolabeled tubulin in a BSC-1 cell as measured by SMACM blinking of the labels (<strong>Figure 13</strong>). Both colors are labeling the same structure which contains microtubules in a thin region of the cell. Note that this 2D scatterplot representation of 3D data is quick to render for inspection purposes but does not show depth (<em>z</em>) or density, overemphasizing sparse regions of the sample and often appearing noisier than a density plot. To avoid misinterpreting results, we strongly recommend exporting your two-color localizations to a different program for better visualization with a more reasonable reconstruction, such as that shown in <strong>Figure 14</strong>.</p>"
        },
        {
            "header": "References",
            "content": "<p>1. A. von Diezmann, Y. Shechtman and W. E. Moerner, <em>Chem. Rev</em>. 117, 7244 (2017). </p><p>2. M. A. Thompson, Matthew D. Lew, M. Badieirostami and W. E. Moerner, <em>Nano Lett</em>. 10, 211 (2010). </p><p>3. A. S. Backer, M. P. Backlund, A. R. von Diezmann, S. J. Sahl and W. E. Moerner, <em>Appl. Phys. Lett.</em> 104, 193701 (2014). </p><p>4. S. R. P. Pavani, M. A. Thompson, J. S. Biteen, S. J. Lord, N. Liu, R. J. Twieg, R. Piestun and W. E. Moerner, <em>Proc. Natl. Acad. Sci. U. S. A</em>. 106, 2995 (2009). </p><p>5. Matthew D. Lew, Alexander R. S. von Diezmann and W. E. Moerner, <em>Protocol Exchange</em> 026 (2013). </p><p>6. Alex von Diezmann, Maurice Y. Lee, Matthew D. Lew and WE Moerner, <em>Optica</em> 2, 985 (2015). </p><p>7. A. A. Goshtasby, <u>Image registration, </u>(Springer-Verlag, London, 2012), p. 441. </p><p>8. Andreas Gahlmann, Jerod Louis Ptacin, Ginni Grover, Sean Quirin, Alexander R. S. von Diezmann, Marissa K. Lee, Mikael Paul Backlund, Lucy Shapiro, Rafael Piestun and W. E. Moerner, <em>Nano Lett. </em>13, 987 (2013). </p><p>9. C. A. Bayas, J. Wang, M. K. Lee, J. M. Schrader, L. Shapiro and W. E. Moerner, <em>Proc. Natl. Acad. Sci. U. S. A.</em> 115, E3712 (2018). </p><p>10. L. Stirling Churchman and James A. Spudich,<em> Cold Spring Harbor Protocols </em>2, 141 (2012).</p>"
        },
        {
            "header": "Acknowledgements",
            "content": "<p>We thank Joshua Yoon for his contributions to the code, and Dr. Carl G. Ebeling, Worldwide Application Scientist for Bruker Fluorescence Microscopy, for his support and for the use of the Bruker SRX visualization and analysis software for rendering localization data. This work was supported in part by the U. S. National Institute of General Medical Sciences Grant No. R35GM118067.</p>"
        }
    ],
    "attributes": {
        "acceptedTermsAndConditions": true,
        "allowDirectSubmit": true,
        "archivedVersions": [],
        "articleType": "",
        "associatedPublications": [
            {
                "doi": "10.1021/nl304071h",
                "date": "2013-02-15 20:33:36",
                "title": "Quantitative Multicolor Subdiffraction Imaging of Bacterial Protein Ultrastructures in Three Dimensions",
                "authors": [
                    "Andreas Gahlmann",
                    "Jerod L. Ptacin",
                    "Ginni Grover",
                    "Sean Quirin",
                    "Alexander R. S. von Diezmann",
                    "Marissa K. Lee",
                    "Mikael P. Backlund",
                    "Lucy Shapiro",
                    "Rafael Piestun",
                    "W. E. Moerner"
                ],
                "journal": "Nano Letters",
                "logo": ""
            },
            {
                "doi": "10.1091/mbc.E14-06-1127",
                "date": "2014-10-16 03:13:23",
                "title": "Correlations of three-dimensional motion of chromosomal loci in yeast revealed by the double-helix point spread function microscope",
                "authors": [
                    "Mikael P. Backlund",
                    "Ryan Joyner",
                    "Karsten Weis",
                    "W. E. Moerner"
                ],
                "journal": "Molecular Biology of the Cell",
                "logo": ""
            },
            {
                "doi": "10.1364/OPTICA.2.000985",
                "date": "2015-11-19 14:05:03",
                "title": "Correcting field-dependent aberrations with nanoscale accuracy in three-dimensional single-molecule localization microscopy",
                "authors": [
                    "Alex von Diezmann",
                    "Maurice Y. Lee",
                    "Matthew D. Lew",
                    "W. E. Moerner"
                ],
                "journal": "Optica",
                "logo": ""
            },
            {
                "doi": "10.1073/pnas.1721648115",
                "date": "2018-04-02 20:42:37",
                "title": "Spatial organization and dynamics of RNase E and ribosomes inCaulobacter crescentus",
                "authors": [
                    "Camille A. Bayas",
                    "Jiarui Wang",
                    "Marissa K. Lee",
                    "Jared M. Schrader",
                    "Lucy Shapiro",
                    "W. E. Moerner"
                ],
                "journal": "Proceedings of the National Academy of Sciences",
                "logo": ""
            }
        ],
        "authors": [
            {
                "id": 84369,
                "identity": "b1019da5-eddc-4dbb-9c0f-c721c8d062b6",
                "order_by": 1,
                "name": "Camille Bayas",
                "email": "",
                "orcid": "",
                "institution": "Stanford University",
                "correspondingAuthor": false,
                "prefix": "",
                "firstName": "Camille",
                "middleName": "",
                "lastName": "Bayas",
                "suffix": ""
            },
            {
                "id": 84370,
                "identity": "ef1dff22-e280-4665-a856-058910969598",
                "order_by": 2,
                "name": "Alex von Diezmann",
                "email": "",
                "orcid": "",
                "institution": "Stanford University",
                "correspondingAuthor": false,
                "prefix": "",
                "firstName": "Alex",
                "middleName": "",
                "lastName": "von Diezmann",
                "suffix": ""
            },
            {
                "id": 84371,
                "identity": "b1695d88-d32c-4836-8400-78f069abbdd7",
                "order_by": 3,
                "name": "Anna-Karin Gustavsson",
                "email": "",
                "orcid": "",
                "institution": "Stanford University",
                "correspondingAuthor": false,
                "prefix": "",
                "firstName": "Anna-Karin",
                "middleName": "",
                "lastName": "Gustavsson",
                "suffix": ""
            },
            {
                "id": 84372,
                "identity": "a73057e9-6438-44f8-a9bc-0c5d16928240",
                "order_by": 4,
                "name": "W. E. Moerner",
                "email": "wmoerner@stanford.edu",
                "orcid": "https://orcid.org/0000-0002-2830-209X",
                "institution": "STANFORD UNIVERSITY",
                "correspondingAuthor": true,
                "prefix": "",
                "firstName": "W.",
                "middleName": "E.",
                "lastName": "Moerner",
                "suffix": ""
            }
        ],
        "badges": [],
        "createdAt": "2019-04-11 20:51:52",
        "currentVersionCode": 2,
        "declarations": "",
        "doi": "10.21203/rs.2.9151/v2",
        "doiUrl": "https://doi.org/10.21203/rs.2.9151/v2",
        "draftVersion": [],
        "editorialEvents": [],
        "editorialNote": "",
        "failedWorkflow": [],
        "files": [
            {
                "id": 2613659,
                "identity": "e55f8c39-d07e-440f-a089-6ff22ef6561f",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:53:44",
                "extension": "png",
                "order_by": 1,
                "title": "Figure 1",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 142679,
                "visible": true,
                "origin": "",
                "legend": "Schematic of Easy-DHPSF v2.0 workflow. Begin flowchart at gray boxes near the top of the image. Green boxes indicate steps for the green color channel, and red boxes indicate steps for the red color channel. Yellow boxes indicate steps that involve both color channels. Dashed outlines indicate that user input is needed during these modules. The final result is the red/green box, \u201cRegistered 2-color 3D data.\u201d",
                "description": "",
                "filename": "figure1.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_1.png"
            },
            {
                "id": 2611190,
                "identity": "17104fce-e13b-472a-8d7b-1270b41c64b0",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 2,
                "title": "Figure 2",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 20972,
                "visible": true,
                "origin": "",
                "legend": "The Easy-DHPSF GUI before any of the modules are run. The user can switch between colors using the dropdown menu under Setup > Channel.",
                "description": "",
                "filename": "figure2.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_2.png"
            },
            {
                "id": 2611189,
                "identity": "1838df65-5657-47dc-9071-aca9e15de21d",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 3,
                "title": "Figure 3",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 39561,
                "visible": true,
                "origin": "",
                "legend": "DHPSF calibration with beads. An example of the GUI that prompts user to select DHPSFs during the calibration step if beads are used for calibration. The program will prompt the user to select at least 1 bead.",
                "description": "",
                "filename": "figure3.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_3.png"
            },
            {
                "id": 2611194,
                "identity": "e32522aa-b468-4563-b9de-6e160697c74a",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 4,
                "title": "Figure 4",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 179794,
                "visible": true,
                "origin": "",
                "legend": "DHPSF calibration with NHA. An example of the GUI that prompts user to select DHPSF during the calibration step if an NHA is used for calibration. The program will prompt the user to select four fiducials that form a square (DHPSFs 1-4 in the image above), then to select fiducials that out the edge of the field of view.",
                "description": "",
                "filename": "figure4.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_4.png"
            },
            {
                "id": 2611196,
                "identity": "42fc079a-9c15-4e4b-bffb-518659ad6b0f",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 5,
                "title": "Figure 5",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 110649,
                "visible": true,
                "origin": "",
                "legend": "DHPSF calibration statistics. For a good calibration standard, the calibration curve (upper-left) should be roughly linear, the xy apparent motions (upper-right) should deviate less than \u00b150 nm, and the localization precision (lower-left, lower-middle) in x, y, and z should be \u226415 nm over the course of the scan.",
                "description": "",
                "filename": "figure5.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_5.png"
            },
            {
                "id": 2611192,
                "identity": "89b8b49f-ae1b-4177-92ba-f2a6ef3caa62",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 6,
                "title": "Figure 6",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 23607,
                "visible": true,
                "origin": "",
                "legend": "Typical DHPSF templates. Each template is chosen from the aforementioned calibration scan, where the rotation of the double helix between templates is evenly spaced at ~30\u00b0.",
                "description": "",
                "filename": "figure6.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_6.png"
            },
            {
                "id": 2611195,
                "identity": "12470689-66b3-4c2f-afba-6a7d20980cf7",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 7,
                "title": "Figure 7",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 10665,
                "visible": true,
                "origin": "",
                "legend": "Input filtering options for SM calibration.",
                "description": "",
                "filename": "figure7.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_7.png"
            },
            {
                "id": 2611200,
                "identity": "3555b296-96b5-47b0-afb3-9aed7a914a41",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 8,
                "title": "Figure 8",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 253833,
                "visible": true,
                "origin": "",
                "legend": "Example still image of a NHA during a control point scan. The green channel is on the upper left corner, and the red channel is on the lower right corner.",
                "description": "",
                "filename": "figure8.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_8.png"
            },
            {
                "id": 2611197,
                "identity": "a7e59acd-5f51-480a-877f-a0b1700d62ee",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 9,
                "title": "Figure 9",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 78942,
                "visible": true,
                "origin": "",
                "legend": "Example still image of beads on a coverslip during a control point scan. Still image of a field of view of fluorescent beads in the green (left) and red (right) channels during a control point scan.",
                "description": "",
                "filename": "figure9.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_9.png"
            },
            {
                "id": 2611199,
                "identity": "dfa2a87f-43a8-47a0-92ca-1d3c6e875b35",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 10,
                "title": "Figure 10",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 40217,
                "visible": true,
                "origin": "",
                "legend": "Example of the GUI that prompts user to select control point pairs when beads are used. There is a reflection between the reflected (green) and transmitted (red) channels in this example due to the optics needed to place both colors on the same camera. The light blue y = x line is added as an additional visual reference.",
                "description": "",
                "filename": "figure10.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_10.png"
            },
            {
                "id": 2611198,
                "identity": "8c4822d8-6697-4c7c-81fc-4e7e420965f8",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 11,
                "title": "Figure 11",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 68946,
                "visible": true,
                "origin": "",
                "legend": "Example of the GUI that prompts user to select control point pairs when an NHA is used. There is a reflection between the reflected (green) and transmitted (red) channels in this example.",
                "description": "",
                "filename": "figure11.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_11.png"
            },
            {
                "id": 2611201,
                "identity": "8ca0ddf2-dec4-487c-9f42-758f618678bf",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 12,
                "title": "Figure 12",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 51938,
                "visible": true,
                "origin": "",
                "legend": "Example output from evaluating parameter ranges for transformation.",
                "description": "",
                "filename": "figure12.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_12.png"
            },
            {
                "id": 2611204,
                "identity": "79401f35-f654-4b6a-a565-f4786d49d599",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 13,
                "title": "Figure 13",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 168003,
                "visible": true,
                "origin": "",
                "legend": "2D scatterplot of two-color tubulin localizations in a fixed BSC-1 cell.",
                "description": "",
                "filename": "figure13.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_13.png"
            },
            {
                "id": 2611209,
                "identity": "de01931d-8102-4c81-bc9e-76a5d1298dee",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 14,
                "title": "Figure 14",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 10419835,
                "visible": true,
                "origin": "",
                "legend": "Two-color SR imaging of double-labeled microtubules, rendered using the program Vutara SRX. \nA, 2D projection of 3D microtubule localizations in a fixed BSC-1 cell. Green indicates CF568 localizations and magenta indicates AF647 localizations. White indicates colocalization. Each localization is plotted as a 3D Gaussian with 50 nm width. B, 2D projection of blue region in A (top), and 3D perspective view of blue region (bottom). C, xy and xz projections of orange region in A (left), and a projection down the axis of this same tubule in (right)",
                "description": "",
                "filename": "figure14.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_14.png"
            },
            {
                "id": 2611202,
                "identity": "8517d343-6d37-4a06-981c-307f6109d3ff",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "gif",
                "order_by": 15,
                "title": "Figure 15",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 2126,
                "visible": true,
                "origin": "",
                "legend": "Equation",
                "description": "",
                "filename": "figure15.gif",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_15.gif"
            },
            {
                "id": 2611203,
                "identity": "7b97e469-73a6-4983-ba4f-b3c147d0fa45",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "gif",
                "order_by": 16,
                "title": "Figure 16",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 2065,
                "visible": true,
                "origin": "",
                "legend": "Equation",
                "description": "",
                "filename": "figure16.gif",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_16.gif"
            },
            {
                "id": 2611205,
                "identity": "4fde91ca-fe02-4dea-a63f-2ebb98c882b7",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "gif",
                "order_by": 17,
                "title": "Figure 17",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 5426,
                "visible": true,
                "origin": "",
                "legend": "Equation",
                "description": "",
                "filename": "figure17.gif",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_17.gif"
            },
            {
                "id": 2611206,
                "identity": "26996d17-5491-4a37-971d-077338e0286f",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "gif",
                "order_by": 18,
                "title": "Figure 18",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 2303,
                "visible": true,
                "origin": "",
                "legend": "Equation",
                "description": "",
                "filename": "figure18.gif",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_18.gif"
            },
            {
                "id": 2611207,
                "identity": "c0607b5c-133c-4db8-ac88-6afd8de55696",
                "added_by": "f81b6edc-e193-491c-93ac-1c5b53171f13",
                "created_at": "2020-09-25 20:52:07",
                "extension": "png",
                "order_by": 19,
                "title": "Figure 19",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 116115,
                "visible": true,
                "origin": "",
                "legend": "Table of  fields in output",
                "description": "",
                "filename": "figure19.png",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/figure_19.png"
            },
            {
                "id": 13467165,
                "identity": "93524d28-4f60-40ca-873b-3509ab86b764",
                "added_by": "auto",
                "created_at": "2021-09-16 20:54:14",
                "extension": "pdf",
                "order_by": 0,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "manuscript-pdf",
                "size": 2842026,
                "visible": true,
                "origin": "",
                "legend": "",
                "description": "",
                "filename": "manuscript.pdf",
                "url": "https://assets.researchsquare.com/files/pex-129/v2/1fa088dd-8233-4cff-8ebd-8eab9e281245.pdf"
            }
        ],
        "financialInterests": "The authors declare no competing financial interests.",
        "fulltextSource": "",
        "fullText": "",
        "funders": [],
        "hasOptedInToPreprint": true,
        "hasPassedJournalQc": "",
        "hideJournal": true,
        "highlight": "",
        "institution": "",
        "isAuthorSuppliedPdf": false,
        "isDeskRejected": "",
        "isHiddenFromSearch": false,
        "isInQc": false,
        "isInWorkflow": false,
        "journal": {
            "display": true,
            "email": "protocol.exchange@nature.com",
            "identity": "protocol-exchange",
            "isNatureJournal": false,
            "hasQc": false,
            "allowDirectSubmit": true,
            "externalIdentity": "",
            "sideBox": "",
            "submissionUrl": "https://protocolexchange.researchsquare.com/submission",
            "title": "Protocol Exchange",
            "twitterHandle": ""
        },
        "keywords": "Super-resolution, superresolution, localization microscopy, single molecule, fluorescence, PALM, STORM, fPALM, SMACM, double helix, DHPSF, easy-dhpsf, three-dimensional imaging, 3D, template matching, image correlation, nonlinear least-squares, wavelet, local transformation, MATLAB, graphical user interface, GUI, open source",
        "license": {
            "name": "CC BY 4.0",
            "url": "https://creativecommons.org/licenses/by/4.0/"
        },
        "manuscriptAbstract": "<p>Automated processing of double-helix (DH) microscope images of fluorescent single molecules (SMs) streamlines the protocol required to obtain super-resolved three-dimensional (3D) reconstructions of ultrastructures in biological samples by single-molecule active control microscopy (SMACM). Here, we present a suite of MATLAB subroutines, bundled with an easy-to-use graphical user interface (GUI), that facilitates 3D localization of single emitters (e.g. SMs, fluorescent beads, or quantum dots) with typical precisions of tens of nanometers in multi-frame movies acquired using a wide-field DH epifluorescence microscope. The algorithmic approach is based upon template matching for SM recognition and least\u2011squares fitting for 3D position measurement, both of which are computationally expedient and precise. Overlapping images of SMs are ignored, and the precision of least-squares fitting is not as high as maximum likelihood-based methods. Version 2.0 of Easy-DHPSF augments the approach of Version 1.0 by incorporating code that facilitates combining localization data from two spectral channels using a locally-weighted quadratic 3D registration function.&nbsp;</p>",
        "manuscriptTitle": "Easy-DHPSF 2.0: open-source software for three-dimensional localization and two-color registration of single molecules with nanoscale accuracy",
        "msid": "",
        "msnumber": "",
        "nonDraftVersions": [
            {
                "code": 1,
                "date": "2019-04-24 19:16:45",
                "doi": "10.21203/rs.2.9151/v1",
                "editorialEvents": [
                    {
                        "type": "communityComments",
                        "content": 0
                    }
                ],
                "status": "published",
                "journal": {
                    "display": true,
                    "email": "info@researchsquare.com",
                    "identity": "researchsquare",
                    "isNatureJournal": false,
                    "hasQc": true,
                    "allowDirectSubmit": true,
                    "externalIdentity": "",
                    "sideBox": "",
                    "submissionUrl": "/submission",
                    "title": "Research Square",
                    "twitterHandle": "researchsquare"
                }
            },
            {
                "code": 2,
                "date": "2019-06-10 16:16:35",
                "doi": "10.21203/rs.2.9151/v2",
                "editorialEvents": [
                    {
                        "type": "communityComments",
                        "content": 1
                    }
                ],
                "status": "published",
                "journal": {
                    "display": true,
                    "email": "info@researchsquare.com",
                    "identity": "researchsquare",
                    "isNatureJournal": false,
                    "hasQc": true,
                    "allowDirectSubmit": true,
                    "externalIdentity": "",
                    "sideBox": "",
                    "submissionUrl": "/submission",
                    "title": "Research Square",
                    "twitterHandle": "researchsquare"
                }
            }
        ],
        "origin": "",
        "ownerIdentity": "f81b6edc-e193-491c-93ac-1c5b53171f13",
        "owner": [],
        "postedDate": "June 10th, 2019",
        "published": true,
        "revision": "",
        "status": "posted",
        "subjectAreas": [
            {
                "id": 11659,
                "name": "Cell biology"
            },
            {
                "id": 11661,
                "name": "Nanoscience and technology"
            },
            {
                "id": 11662,
                "name": "Biological techniques"
            },
            {
                "id": 11663,
                "name": "Optics and photonics"
            }
        ],
        "tags": [],
        "versionOfRecord": [],
        "versionCreatedAt": "2019-06-10 16:16:35",
        "video": "",
        "vorDoi": "",
        "vorDoiUrl": "",
        "workflowStages": []
    }
}