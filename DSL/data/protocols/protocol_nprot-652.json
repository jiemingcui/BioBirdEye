{
    "identity": "nprot-652",
    "title": "A computational protocol and software implementation \\(as a MATLAB application) for biomarker identification in infrared spectroscopy datasets",
    "content": [
        {
            "header": "Introduction",
            "content": "One attractive possibility of infrared \\(IR) spectroscopy is that it may be applied to investigate class \\(_i.e._, treatment, tissue type, etc)-specific alterations in the absorption signature. Such alterations can act as biomarkers of mechanism associated with pathways or effects. One may be interested in investigating such alterations from different standpoints including: \\(1) intensity; \\(2) statistical significance; and, \\(3) composite \\(multi-spectral-region) alterations. These three view-concepts were implemented computationally and named BM1, BM2 and BM3. They can be easily applied to datasets of classed IR spectra through a user-friendly MATLAB interface.\r\n\n\n\r\n\n\n**BM1.** Most intuitive of the methods. The mean spectrum from a given class is subtracted from the mean spectrum from a reference class \\(_e.g._, \u201cvehicle control\u201d) thus obtaining a \u201cdifference-between-means curve\u201d.\r\n\n\n\r\n\n\n**BM2.** Each variable \\(wavenumber) is taken at a time as input to a univariate linear classifier thus obtaining a per-wavenumber \u201cclassification rate curve\u201d<sup>1</sup>. Cross-validation is used to determine classification rates. This method is close to the t-test criterion<sup>2</sup>, but more precise.\r\n\n\n\r\n\n\n**BM3.** When multiple variables are assessed together, the joint-best variables for classification may differ substantially from the rank of the individual best variables. This method generates a histogram that represents how many times each wavenumber appeared within the _TopVars_ \\(method parameter: number of \u201cbest variables\u201d) \u201cbest variable set\u201d achieved through feature selection, which is repeated many times according to _NoBootstraps_ \\(method parameter: number of validation bootstraps).\r\n\n\n\r\n\n\nThe aim of this protocol is identify and visualize class-related biomarkers in IR spectral datasets by means of a simple sequence of steps to be executed under a user-friendly interface \\(**Figure 1**). Two visual representations are provided where all BM results are presented concurrently allowing for comparison of results generated by each method."
        },
        {
            "header": "Equipment",
            "content": "**Running this protocol will require:**\r\n\n\n- MATLAB r2008a \\(www.mathworks.com) \\(version 7.6) or above. The toolkit is however probably compatible with older versions of MATLAB 7 \\(but not 6);\r\n\n\n- Our biospectroscopy toolkit, available for download at http://lec.lancs.ac.uk/biospectool;\r\n\n\n- A classed spectroscopy dataset \\(a sample data file is provided together with the toolkit).\r\n\n\n\r\n\n\n**Preparing data files**\r\n\n\nBMTool can read text files in CSV format \\(http://tools.ietf.org/html/rfc4180). A sample file is provided \\(\u201ctxt/vc_mnng.txt\u201d), which can also be opened by Excel \\(www.microsoft.com), OpenOffice \\(www.openoffice.org) or a similar program. BMTool expects CSV files to be internally organized in the following way:\r\n\n\n- The whole file contains a matrix where each row represents one IR spectrum;\r\n\n\n- All columns, except for the last one, are real numbers representing absorption intensity values;\r\n\n\n- The last column is a positive integer specifying the class the spectrum belongs to. Class numbering can start with \u201c0\u201d or \u201c1\u201d.\r\n\n\n\r\n\n\nIR spectra represented in the file need to be pre-processed. Commonly-employed pre-processing sequences are: baseline correction followed by normalization to the Amide I peak<sup>3,4</sup> \\(or Amide II peak <sup>5</sup>) or second differentiation followed by vector normalization<sup>6</sup>.\r\n\n\n\r\n\n\nAlternatively, data can be imported from a spectroscopy database, a resource that is intended to be made publicly available in the future."
        },
        {
            "header": "Procedure",
            "content": "1. Toolkit installation:\r\n  1.1. Download and extract the \u201cbmtool.zip\u201d file to a folder of choice. This will create five folders: \u201cdoc\u201d, \u201clib\u201d, \u201cmat\u201d, \u201ctxt\u201d and \u201cwork\u201d;\r\n\n\n1.2. Start MATLAB;\r\n\n\n1.3. Add the \u201clib\u201d folder to your MATLAB path \\(File->Set path...->...).\r\n\n\n\r\n\n\n2. Starting BMTool:\r\n  2.1. Start MATLAB and change the current directory to the \u201cwork\u201d folder created upon installation;\r\n\n\n2.2. At the MATLAB command prompt, type \u201cbmtool\u201d. This will open the BMTool graphical user interface \\(GUI) \\(**Figure 2**).\r\n\n\n\r\n\n\n3. Using bmtool - the GUI contains a set of panels that are numbered to facilitate the following operation steps. These steps go from loading a dataset to visualizing analysis results:\r\n  3.1. Load dataset:\r\n\n\n3.1.1. In the \u201c\\(\\(1)) Select input dataset\u201d panel, click on the \u201cLoad\u2026\u201d button;\r\n\n\n3.1.2. Locate the desired file \\(for the sample file, by clicking \u201cList files below\u201d straight away this should show the sample data file \u201cvc_mnng.txt\u201d in the list box).\r\n\n\n\r\n\n\n3.2. Mount datasets for analysis:\r\n\n\n3.2.1. In the \u201c\\(\\(2)) Mount datasets for analysis\u201d panel, make sure the \u201cAgent vs. vehicle control \\(VC)\u201d radio button is selected \\(it should be noted that Agent and VC are arbitrary labels);\r\n\n\n3.2.2. Inform the index of the class that corresponds to the reference class \\(VC) in your dataset \\(1 for 1\nst\n, 2 for 2\nnd\netc);\r\n\n\n3.2.3. Click on \u201cMount datasets\\!\u201d This will generate 2-class datasets where the VC data is combined with each of the remaining classes at a time. Consequently, the number of mounted datasets will be the number of classes existing in your dataset minus one.\r\n\n\n\r\n\n\n3.3. Select datasets to be analysed: In the \u201c\\(\\(3)) Select mounted datasets\u201d panel, select the desired datasets, or press the \u201cSelect all\u201d button.\r\n\n\n\r\n\n\n3.4. Generate results:\r\n\n\n3.4.1. In the \u201c\\(\\(4)) Run session\u201d panel, tick the \u201cBM1 \u2026\u201d, \u201cBM2 \u2026\u201d and \u201cBM3 \u2026\u201d checkboxes.\r\n\n\n  **Tip:** recommended values:\r\n\n\n  - for BM2: \u201cNumber of variables\u201d: 1; \u201ck for k-fold cross-validation\u201d: 10;\r\n\n\n  - for BM3: \u201cTop number of variables\u201d: 3; \u201cNumber of bootstraps\u201d: 500.\r\n\n\n3.4.2. Press the \u201cRun\\!\u201d button.\r\n\n\n**Caution:** BM3 is much more time-consuming than the other methods and can be left out in a preliminary analysis that shows only results from BM1 and BM2. You can also run BM3 alone with a small number of bootstraps \\(_e.g._, 20). This will give you an idea of the time taken to run the final result.\r\n\n\n\r\n\n\n3.5. Visualize results:\r\n\n\n3.5.1. In the \u201c\\(\\(5)) Manipulate results\u201d panel, select which results you want to visualize or press the \u201cSelect all\u201d button;\r\n\n\n3.5.2. Select the type of visualization that you want to generate. Please note the availability of certain visualization types is conditioned to which results were generated:\r\n\n\n  - To visualize the curves generated by each method, select \u201cMixed: BM curves\u201d from the visualization options and click on \u201cVisualize\\!\u201d \\(see example in **Figure 3a**);\r\n\n\n  - To visualize only the biomarker locations \\(without the curves), select \u201cMixed: Biomarker-localization plots\u201d from the visualization options and click on \u201cVisualize\\!\u201d \\(see example in **Figure 3b**);\r\n\n\n  - To visualize the biomarkers in form of a report in MATLAB command window, select \u201cBiomarker-localization report\u201d and click on \u201cVisualize\\!\u201d."
        },
        {
            "header": "Timing",
            "content": "Time is dependent on the computer setup, number of spectra, number of variables \\(_i.e._, wavenumbers) in the dataset, and choice of method parameters. Times reported below result from the following settings: Intel Core i5-750 processor and a dataset conta"
        },
        {
            "header": "Troubleshooting",
            "content": "**If BMTool does not run:** verify that the \u201clib\u201d folder was added to your MATLAB path.\r\n\n\n**If you cannot load the sample dataset:** verify that your current working directory is the \u201cwork\u201d folder."
        },
        {
            "header": "Anticipated Results",
            "content": "Results from the sample data file are presented. The sample data file contains two treatment regimens \\(VC and _N_-nitroso-_N_-methylnitroguanidine \\(MNNG)) in Syrian hamster embryo \\(SHE) cells. The application of the BMs to this dataset allows one to investigate the effects of MNNG compared to corresponding control in SHE cells.\r\n\n\n\r\n\n\n**Figure 3a** shows BM1, BM2 and BM3 curves with their respective five most important peaks marked. Peaks that are present in two different BM curves within a distance of 25cm<sup>-1</sup> are connected by a dashed line that signifies confirmation of the importance of the respective IR region.\r\n\n\n\r\n\n\n**Figure 3b** shows a compact version of the previous in a plot named _biomarker-localization_ \\(BL) plot, where only the markers from Figure 3a are retained and symbol size is proportional to peak intensity.\r\n\n\n\r\n\n\nIn addition, a BL plot containing seven comparisons of different treatment conditions vs. VC in a SHE study is shown in **Figure 3c**. The BL plot allows for quick visualization of biomarker weighting and comparison between classes in a class-rich dataset."
        },
        {
            "header": "References",
            "content": "1. Martin, F.L. _et al_. Identifying variables responsible for clustering in discriminant analysis of data from infrared microspectroscopy of a biological sample. _J. Comput. Biol._, **14** \\(9), 1176\u201384 \\(2007).\r\n  \r\n\n\n2. Guyon, I. & Elisseeff, A. An introduction to variable and feature selection. _Journal of Machine Learning Research_, **3**, 1157\u20131182 \\(2003).\r\n  \r\n\n\n3. Walsh, M.J. _et al_. Fourier transform infrared microspectroscopy identifies symmetric PO2- modifications as a marker of the putative stem cell region of human intestinal crypts. _Stem Cells_, **26** \\(1), 108-18 \\(2008).\r\n  \r\n\n\n4. Kelly, J.G. _et al_. Derivation of a subtype-specific biochemical signature of endometrial carcinoma using synchrotron-based Fourier-transform infrared microspectroscopy. _Cancer Lett._, **274** \\(2), 208-17 \\(2009).\r\n  \r\n\n\n5. German, M.J. _et al_. Infrared spectroscopy with multivariate analysis potentially facilitates the segregation of different types of prostate cell. _Biophys. J._, **90** \\(10), 3783-95 \\(2006).\r\n  \r\n\n\n6. Matth\u00e4us, C. et. al. Infrared and Raman microscopy in cell biology. _Methods cell Biol._, **89**, 275-308 \\(2009)."
        },
        {
            "header": "Acknowledgements",
            "content": "This work was funded by Unilever as \u201cpart of Unilever's ongoing effort to develop novel ways of delivering consumer safety\u201d."
        }
    ],
    "attributes": {
        "acceptedTermsAndConditions": true,
        "allowDirectSubmit": true,
        "archivedVersions": [],
        "articleType": "Method Article",
        "associatedPublications": [],
        "authors": [
            {
                "id": 11411,
                "identity": "9f7849e3-516f-11e9-9e20-12b504df345a",
                "order_by": 1,
                "name": "Julio Trevisan",
                "email": "",
                "orcid": "",
                "institution": "Department of Communication Systems, Lancaster University, Lancaster LA1 4WA, UK; Centre for Biophotonics, Lancaster Environment Centre, Lancaster University, Lancaster LA1 4YQ, UK",
                "correspondingAuthor": "",
                "prefix": "",
                "firstName": "Julio",
                "middleName": "",
                "lastName": "Trevisan",
                "suffix": ""
            },
            {
                "id": 11412,
                "identity": "9f784d0d-516f-11e9-9e20-12b504df345a",
                "order_by": 1,
                "name": "Plamen P. Angelov",
                "email": "",
                "orcid": "",
                "institution": "Department of Communication Systems, Lancaster University, Lancaster LA1 4WA, UK; Centre for Biophotonics, Lancaster Environment Centre, Lancaster University, Lancaster LA1 4YQ, UK",
                "correspondingAuthor": "",
                "prefix": "",
                "firstName": "Plamen",
                "middleName": "P.",
                "lastName": "Angelov",
                "suffix": ""
            },
            {
                "id": 11413,
                "identity": "9f784f9d-516f-11e9-9e20-12b504df345a",
                "order_by": 1,
                "name": "Francis L. Martin",
                "email": "",
                "orcid": "",
                "institution": "Centre for Biophotonics, Lancaster Environment Centre, Lancaster University, Lancaster LA1 4YQ, UK",
                "correspondingAuthor": "",
                "prefix": "",
                "firstName": "Francis",
                "middleName": "L.",
                "lastName": "Martin",
                "suffix": ""
            }
        ],
        "badges": [],
        "createdAt": "2010-07-29 16:29:40",
        "currentVersionCode": 1,
        "declarations": "",
        "doi": "10.1038/nprot.2010.97",
        "doiUrl": "https://doi.org/10.1038/nprot.2010.97",
        "draftVersion": [],
        "editorialEvents": [],
        "editorialNote": "",
        "failedWorkflow": [],
        "files": [
            {
                "id": 2608091,
                "identity": "f87ace30-c9d6-4b21-8b2f-87b9698ed0ea",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:49:57",
                "extension": "png",
                "order_by": 1,
                "title": "Figure 1",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 6556,
                "visible": true,
                "origin": "",
                "legend": "Schematic of the biomarker identification protocol implemented in the toolkit.   Infrared spectra, pre-processed and classed (_i.e._, each spectrum is assigned a class, _e.g._, \u201cvehicle control\u201d, \u201ctreatment 1\u201d, \u201ctreatment 2\u201d etc), are inputted into three different biomarker identification methods (BM1, BM2 and BM3). Each method individually generates a result curve (see text). Results are combined by means of visualization strategies.",
                "description": "",
                "filename": "figure1.png",
                "url": "https://assets.researchsquare.com/files/nprot-652/v1/figure_1.png"
            },
            {
                "id": 2608095,
                "identity": "3a45ba73-5e8a-47ac-9494-15885acb33d2",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:49:57",
                "extension": "png",
                "order_by": 2,
                "title": "Figure 2",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 73503,
                "visible": true,
                "origin": "",
                "legend": "Screenshot of the main window of BMTool.   This graphical user interface contains numbered panels organized in the most probable operating sequence.",
                "description": "",
                "filename": "figure2.png",
                "url": "https://assets.researchsquare.com/files/nprot-652/v1/figure_2.png"
            },
            {
                "id": 2608096,
                "identity": "b0491d47-0358-49fa-807f-76e8db33ab8a",
                "added_by": "29b0f50f-991e-4cf6-96fc-2c41c75f34f2",
                "created_at": "2020-09-25 20:49:57",
                "extension": "png",
                "order_by": 3,
                "title": "Figure 3",
                "display": "",
                "copyAsset": false,
                "role": "figure",
                "size": 113682,
                "visible": true,
                "origin": "",
                "legend": "Anticipated results.   _(a)_ BM1, BM2 and BM3 curves with their respective five most important peaks marked. Peaks that are present in two different BM curves within a distance of 25cm^-1^ are connected by a dashed line that signifies confirmation of the importance of the respective infrared region. _(b)_ Compact version of the previous in a plot named _biomarker-localization_ (BL) plot, where only the markers from Figure 3a are retained. _(c)_ Another BL plot containing all seven comparisons between treatment condition and VC of an eight-treatment-regimen Syrian hamster embryo (SHE) study; allows for quick visualization and comparison between classes in a class-rich dataset.",
                "description": "",
                "filename": "figure3.png",
                "url": "https://assets.researchsquare.com/files/nprot-652/v1/figure_3.png"
            },
            {
                "id": 13464552,
                "identity": "4d8dd588-c35d-4dde-b1e9-372b19bfc361",
                "added_by": "auto",
                "created_at": "2021-09-16 20:43:46",
                "extension": "pdf",
                "order_by": 0,
                "title": "",
                "display": "",
                "copyAsset": false,
                "role": "manuscript-pdf",
                "size": 314594,
                "visible": true,
                "origin": "",
                "legend": "",
                "description": "",
                "filename": "manuscript.pdf",
                "url": "https://assets.researchsquare.com/files/nprot-652/v1/b441eb48-55c3-4a82-9a37-719fe5b1a400.pdf"
            }
        ],
        "financialInterests": "",
        "fulltextSource": "",
        "fullText": "",
        "funders": [],
        "hasOptedInToPreprint": true,
        "hasPassedJournalQc": "",
        "hideJournal": true,
        "highlight": "",
        "institution": "",
        "isAuthorSuppliedPdf": false,
        "isDeskRejected": "",
        "isHiddenFromSearch": false,
        "isInQc": false,
        "isInWorkflow": false,
        "journal": {
            "display": true,
            "email": "protocol.exchange@nature.com",
            "identity": "protocol-exchange",
            "isNatureJournal": false,
            "hasQc": false,
            "allowDirectSubmit": true,
            "externalIdentity": "",
            "sideBox": "",
            "submissionUrl": "https://protocolexchange.researchsquare.com/submission",
            "title": "Protocol Exchange",
            "twitterHandle": ""
        },
        "keywords": "infrared, spectroscopy, biomarkers, feature selection, wavenumbers, exploratory analysis, pathways, mechanisms, computational framework, pattern classification, statistical significance, software, graphical user interface, visual representation, peak detection, differences between means, classification rates, importance histograms, bmtool, toolbox, toolkit, opensource, free software",
        "license": {
            "name": "CC BY-NC 3.0",
            "url": "https://creativecommons.org/licenses/by-nc/3.0/"
        },
        "manuscriptAbstract": "",
        "manuscriptTitle": "A computational protocol and software implementation (as a MATLAB application) for biomarker identification in infrared spectroscopy datasets",
        "msid": "",
        "msnumber": "",
        "nonDraftVersions": [
            {
                "code": 1,
                "date": "2010-05-04 09:04:46",
                "doi": "10.1038/nprot.2010.97",
                "editorialEvents": [
                    {
                        "type": "communityComments",
                        "content": 0
                    }
                ],
                "status": "published",
                "journal": {
                    "display": true,
                    "email": "info@researchsquare.com",
                    "identity": "researchsquare",
                    "isNatureJournal": false,
                    "hasQc": true,
                    "allowDirectSubmit": true,
                    "externalIdentity": "",
                    "sideBox": "",
                    "submissionUrl": "/submission",
                    "title": "Research Square",
                    "twitterHandle": "researchsquare"
                }
            }
        ],
        "origin": "",
        "ownerIdentity": "9f77fd85-516f-11e9-9e20-12b504df345a",
        "owner": [],
        "postedDate": "May 4th, 2010",
        "published": true,
        "revision": "",
        "status": "posted",
        "subjectAreas": [
            {
                "id": 2401,
                "name": "Biochemistry"
            },
            {
                "id": 2403,
                "name": "Computational biology and bioinformatics"
            },
            {
                "id": 2404,
                "name": "Chemical biology"
            },
            {
                "id": 2405,
                "name": "Drug discovery"
            },
            {
                "id": 2406,
                "name": "Biological techniques"
            },
            {
                "id": 2407,
                "name": "Structural biology"
            }
        ],
        "tags": [],
        "versionOfRecord": [],
        "versionCreatedAt": "2010-05-04 09:04:46",
        "video": "",
        "vorDoi": "",
        "vorDoiUrl": "",
        "workflowStages": []
    }
}